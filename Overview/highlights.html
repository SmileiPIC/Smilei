<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Highlights &#8212; Smilei 5.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/smilei_theme.css?v=3908db80" />
    <script src="../_static/documentation_options.js?v=4af8989d"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="icon" href="../_static/smileiIcon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Releases" href="releases.html" />
    <link rel="prev" title="Synopsis" href="synopsis.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": {
      scale: 95,
      availableFonts: ["TeX"]
    }
  });
  </script>
   
  </head><body>

<div id="smallScreenMenu" class="off">

    
    <div class="toctree-smilei">
        <ul>
            <li class="outer">
                <a href="synopsis.html">Synopsis</a>
            </li>
        </ul>
                <ul>
<li><a class="reference internal" href="#">Highlights</a><ul>
<li><a class="reference internal" href="#improved-performance-using-gpu-offloading">Improved performance using GPU offloading</a></li>
<li><a class="reference internal" href="#mitigation-of-numerical-artifacts-with-relativistic-particles">Mitigation of numerical artifacts with relativistic particles</a></li>
<li><a class="reference internal" href="#laser-envelope-model-and-averaged-tunnel-ionization">Laser Envelope model and averaged tunnel ionization</a></li>
<li><a class="reference internal" href="#field-initialization-of-a-relativistic-particle-beam">Field initialization of a relativistic particle beam</a></li>
<li><a class="reference internal" href="#azimuthal-fourier-decomposition">Azimuthal Fourier decomposition</a></li>
<li><a class="reference internal" href="#improved-performance-using-vectorization">Improved performance using vectorization</a></li>
<li><a class="reference internal" href="#scalability-in-a-wakefield-acceleration-simulation">Scalability in a wakefield acceleration simulation</a></li>
<li><a class="reference internal" href="#high-harmonic-generation">High-harmonic generation</a></li>
<li><a class="reference internal" href="#brillouin-amplification">Brillouin amplification</a></li>
<li><a class="reference internal" href="#magnetic-reconnection-at-the-earth-magnetopause">Magnetic reconnection at the Earth magnetopause</a></li>
<li><a class="reference internal" href="#collisionless-shock-in-pair-plasmas">Collisionless shock in pair plasmas</a></li>
</ul>
</li>
</ul>

        <ul id="smallScreenMenuAfterTOC">
            <li class="outer">
                <a href="releases.html">Releases</a>
            </li>
            <li class="outer">
                <a href="licence.html">Licence</a>
            </li>
            <li class="outer">
                <a href="material.html">Publications</a>
            </li>
            <li class="outer">
                <a href="partners.html">Partners</a>
            </li>
        </ul>
        <hr />
        <ul>
            <li class="outer">
                <a href="../Understand/units.html">Units</a>
            </li>
            <li class="outer">
                <a href="../Understand/algorithms.html">PIC algorithms</a>
            </li>
            <li class="outer">
                <a href="../Understand/performances.html">Parallelization & optimization</a>
            </li>
            <li class="outer">
                <a href="../Understand/physics_modules.html">Physics modules</a>
            </li>
            <li class="outer">
                <a href="../Understand/numerical_techniques.html">Advanced numerical techniques</a>
            </li>
            <li class="outer">
                <a href="../Understand/PML.html">Perfectly Matched Layers</a>
            </li>
        </ul>
        <hr />
        <ul>
            <li class="outer">
                <a href="../Use/installation.html">Install</a>
            </li>
            <li class="outer">
                <a href="https://smileipic.github.io/tutorials">Smilei tutorials</a>
            </li>
            <li class="outer">
                <a href="../Use/namelist.html">Write a namelist</a>
            </li>
            <li class="outer">
                <a href="../Use/run.html">Run</a>
            </li>
            <li class="outer">
                <a href="../Use/post-processing.html">Post-process</a>
            </li>
            <li class="outer">
                <a href="../Use/contribute.html">Contribute</a>
            </li>
            <li class="outer">
                <a href="../Use/troubleshoot.html">Troubleshoot</a>
            </li>
            <li class="outer">
                <a href="../Use/GPU_version.html">GPU version</a>
            </li>
        </ul>
        <hr />
    </div>

</div>
<div id="hcontainer">
    <div id="nav_positioner">
        <div id="nav">
            <div id="nav_button" onclick="toggleNav()">
                Sections
            </div>
            <div id="nav_list" class="toctree-smilei">
                <div id="nav_title"><a href="#">Highlights</a></div>
                <ul>
<li><a class="reference internal" href="#">Highlights</a><ul>
<li><a class="reference internal" href="#improved-performance-using-gpu-offloading">Improved performance using GPU offloading</a></li>
<li><a class="reference internal" href="#mitigation-of-numerical-artifacts-with-relativistic-particles">Mitigation of numerical artifacts with relativistic particles</a></li>
<li><a class="reference internal" href="#laser-envelope-model-and-averaged-tunnel-ionization">Laser Envelope model and averaged tunnel ionization</a></li>
<li><a class="reference internal" href="#field-initialization-of-a-relativistic-particle-beam">Field initialization of a relativistic particle beam</a></li>
<li><a class="reference internal" href="#azimuthal-fourier-decomposition">Azimuthal Fourier decomposition</a></li>
<li><a class="reference internal" href="#improved-performance-using-vectorization">Improved performance using vectorization</a></li>
<li><a class="reference internal" href="#scalability-in-a-wakefield-acceleration-simulation">Scalability in a wakefield acceleration simulation</a></li>
<li><a class="reference internal" href="#high-harmonic-generation">High-harmonic generation</a></li>
<li><a class="reference internal" href="#brillouin-amplification">Brillouin amplification</a></li>
<li><a class="reference internal" href="#magnetic-reconnection-at-the-earth-magnetopause">Magnetic reconnection at the Earth magnetopause</a></li>
<li><a class="reference internal" href="#collisionless-shock-in-pair-plasmas">Collisionless shock in pair plasmas</a></li>
</ul>
</li>
</ul>

            </div>
        </div>
    </div>
    
    <div class="headercolor">
    </div>
    <div class="hpositioner">
        <div class="header">
        <div class="logo">
            <a href="../index.html">
                <img class="logo" src="../_static/smileiLogo.svg" alt="Logo" />
            </a>
            <!--
            <div style="height:7mm; position: absolute; top:2mm; left:-32mm; padding: 1mm 2mm 0 2mm; border-radius: 2mm; background-color:#C5DCEA; background-color:var(--header_text);">
                <a href="https://indico.math.cnrs.fr/e/smilei5">
                    <img src="../_static/workshopLogo.svg" alt="workshop"
                        style="height:5mm;padding-top: 1mm;" />
                </a>
            </div>
            -->
        </div>
        <div class="menu"
            id="menu_Overview"
            style="font-weight:bold"
        >
            <div id="menuButton_Overview" class="menuButton"
                 onmouseenter="prepareMenu('menu_Overview')"
                 onmousedown="event.preventDefault()"
            >
                <a href="../overview.html">
                    <span>Overview</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_Overview',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="synopsis.html">Synopsis</a>
                        </li>
                        <li >
                            <a href="#">Highlights</a>
                        </li>
                        <li class="outer">
                            <a href="releases.html">Releases</a>
                        </li>
                        <li class="outer">
                            <a href="licence.html">Licence</a>
                        </li>
                        <li class="outer">
                            <a href="material.html">Publications</a>
                        </li>
                        <li class="outer">
                            <a href="partners.html">Partners</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        <div class="menu"
            id="menu_Understand"
            
        >
            <div id="menuButton_Understand" class="menuButton"
                 onmouseenter="prepareMenu('menu_Understand')"
                 onmousedown="event.preventDefault()"
            >
                <a href="../understand.html">
                    <span>Understand</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_Understand',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="../Understand/units.html">Units</a>
                        </li>
                        <li class="outer">
                            <a href="../Understand/algorithms.html">PIC algorithms</a>
                        </li>
                        <li class="outer">
                            <a href="../Understand/performances.html">Parallelization & optimization</a>
                        </li>
                        <li class="outer">
                            <a href="../Understand/physics_modules.html">Physics modules</a>
                        </li>
                        <li class="outer">
                            <a href="../Understand/numerical_techniques.html">Advanced numerical techniques</a>
                        </li>
                        <li class="outer">
                            <a href="../Understand/PML.html">Perfectly Matched Layers</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        <div class="last menu"
            id="menu_Use"
            
        >
            <div id="menuButton_Use" class="menuButton"
                 onmouseenter="prepareMenu('menu_Use')"
                 onmousedown="event.preventDefault()"
            >
                <a href="../use.html">
                    <span>Use</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_Use',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="../Use/installation.html">Install</a>
                        </li>
                        <li class="outer">
                            <a href="https://smileipic.github.io/tutorials">Smilei tutorials</a>
                        </li>
                        <li class="outer">
                            <a href="../Use/namelist.html">Write a namelist</a>
                        </li>
                        <li class="outer">
                            <a href="../Use/run.html">Run</a>
                        </li>
                        <li class="outer">
                            <a href="../Use/post-processing.html">Post-process</a>
                        </li>
                        <li class="outer">
                            <a href="../Use/contribute.html">Contribute</a>
                        </li>
                        <li class="outer">
                            <a href="../Use/troubleshoot.html">Troubleshoot</a>
                        </li>
                        <li class="outer">
                            <a href="../Use/GPU_version.html">GPU version</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        
        <script type="text/javascript">
            var es=document.getElementsByClassName("menuButton"), i=0;
            var evt = "ontouchend" in document ? "touchend" : "click";
            for( var i=0; i<es.length; i+=1 ) {
                es[i].addEventListener(evt, function(a){ return function(){toggleMenu(a)};}(es[i].parentNode.id));
            }
        </script>
        
        <div id="searchbox" role="search" style="display:none">
            <form class="search" action="../search.html" method="get">
              <input type="text" name="q" placeholder="Search" id="searchinput" />
              <input type="hidden" name="check_keywords" value="yes" />
              <input type="hidden" name="area" value="default" />
            </form>
        </div>
        
        <div id="searchicon" onclick="openSearch()" style="display:block">
            <svg
               xmlns="http://www.w3.org/2000/svg"
               viewBox="0 0 80 120">
              <g transform="translate(0,-932.36216)" >
                <circle
                   r="25" cy="977.51044" cx="38.078663"
                   style="opacity:1;fill:none;stroke:#ffffff;stroke:var(--header_text);stroke-width:10;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
                <rect
                   transform="matrix(0.36717877,0.93015039,-0.93427297,0.35655858,0,0)"
                   rx="4.9996676" ry="7.4995141" x="947.6142" y="316.16959"
                   height="14.117695" width="46.476151"
                   style="opacity:1;fill:#ffffff;fill:var(--header_text);fill-opacity:1;stroke:none;" />
                <path
                   d="m 41.383282,962.25996 a 15,15 0 0 1 11.660107,11.6355"
                   style="opacity:1;fill:none;stroke:#ffffff;stroke:var(--header_text);stroke-width:3;stroke-linecap:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
              </g>
            </svg>
        </div>
        <div id="closesearchicon" onclick="closeSearch()" style="display:none">
            <svg
               xmlns="http://www.w3.org/2000/svg"
               viewBox="0 0 80 120">
              <g
                 transform="translate(0,-932.36216)"
                 style="fill:none;stroke:#ffffff;stroke:var(--header_text);stroke-width:10;stroke-linecap:round;stroke-linejoin:miter;stroke-opacity:1;stroke-miterlimit:4;stroke-dasharray:none">
                <path d="m 10,962.36216 60,60.00004" />
                <path d="M 70,962.36216 10,1022.3622" />
              </g>
            </svg>
        </div>
        
        <div id="smallScreenMenuButton" onclick="event.preventDefault(); toggleSmallScreenMenu(event)">
            <svg xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg"
               viewBox="-20 -20 140 140">
              <g  style="fill:#ffffff; fill:var(--header_text);stroke:none;">
                <circle cx="15" cy="20" r="5" />
                <circle cx="35" cy="20" r="5" />
                <circle cx="85" cy="20" r="5" />
                <rect width="50" height="10" x="35" y="15" rx="0" ry="0" />
                <circle cx="15" cy="40" r="5" />
                <circle cx="35" cy="40" r="5" />
                <circle cx="85" cy="40" r="5" />
                <rect width="50" height="10" x="35" y="35" rx="0" ry="0" />
                <circle cx="15" cy="60" r="5" />
                <circle cx="35" cy="60" r="5" />
                <circle cx="85" cy="60" r="5" />
                <rect width="50" height="10" x="35" y="55" rx="0" ry="0" />
                <circle cx="15" cy="80" r="5" />
                <circle cx="35" cy="80" r="5" />
                <circle cx="85" cy="80" r="5" />
                <rect width="50" height="10" x="35" y="75" rx="0" ry="0" />
              </g>
            </svg>
        </div>
        
    </div>
    
</div>
</div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="highlights">
<h1>Highlights<a class="headerlink" href="#highlights" title="Link to this heading">¶</a></h1>
<section id="improved-performance-using-gpu-offloading">
<span id="gpuhighlights"></span><h2>Improved performance using GPU offloading<a class="headerlink" href="#improved-performance-using-gpu-offloading" title="Link to this heading">¶</a></h2>
<p><strong class="program">Smilei</strong> computational performance has been recently enhanced
with <a class="reference internal" href="../Understand/GPU_offloading.html"><span class="doc">GPU offloading support</span></a>.
In particular, current projection has been accelerated with a CUDA kernel while other features
have been accelerated with the use of either OpenAcc or OpenMP pragmas.</p>
<p><strong class="program">Smilei</strong> can be tested on recent supercomputers
such as Adastra where it shows great weak scaling efficiency
even while using diagnostics as shown in figure below:</p>
<a class="reference internal image-reference" href="../_images/weak_scaling_efficiency.png"><img alt="../_images/weak_scaling_efficiency.png" class="align-center" src="../_images/weak_scaling_efficiency.png" style="width: 12cm;" /></a>
</section>
<hr class="docutils" />
<section id="mitigation-of-numerical-artifacts-with-relativistic-particles">
<h2>Mitigation of numerical artifacts with relativistic particles<a class="headerlink" href="#mitigation-of-numerical-artifacts-with-relativistic-particles" title="Link to this heading">¶</a></h2>
<p>The staggering in space and time of the electromagnetic fields and the numerical dispersion of electromagnetic solvers
using finite differences in the time domain, typically used in electromagnetic Particle in Cell codes, create
numerical artifacts that become increasingly detrimental in presence of relativisitc macro-particles.</p>
<p>A typical example of simulation where the effects of these artifacts can become relevant and alter the numerical results
is Laser Wakefield Acceleration. In this kind of simulation, a numerical artifact called Numerical Cherenkov Radiation is
generated by the spurious interaction between relativistic macro-particles and electromagnetic fields that are numerically
slower due to the dispersion of the Finite Difference Time Domain solver for Maxwell’s equations.
This artifact can significantly alter the dynamics of relativistic electron beams accelerated in plasma waves, quickly increasing
their divergence along their propagation in the plasma.</p>
<p>Recently an interpolation scheme called B-TIS3 has been implemented in the code CALDER and published in <a class="reference external" href="https://doi.org/10.1017/S0022377823000223">P.-L. Bourgeois, X. Davoine (2023)</a>
This scheme can significantly reduce the effects of Numerical Cherenkov Radiation and of the staggering of the electromagnetic fields,
as shown in this Figure:</p>
<a class="reference internal image-reference" href="../_images/BTIS3_effect.png"><img alt="../_images/BTIS3_effect.png" class="align-center" src="../_images/BTIS3_effect.png" style="width: 18cm;" /></a>
<p>Both panels show a field proportional to the <cite>y</cite> component of the Lorentz force acting on the electron macro-particles in a Smilei simulation of Laser Wakefield Acceleration.
Top panel: simulation not using the B-TIS3 interpolation.
Bottom panel: simulation using the B-TIS3 interpolation.
The high frequency modulations, due to the Numerical Cherenkov Radiation are evident in the top panel, while they are
considerably reduced in the bottom panel.
These two simulations were obtained using the <cite>AMcylindrical</cite> geometry (1 azimuthal mode) and the Laser Envelope model.</p>
</section>
<hr class="docutils" />
<section id="laser-envelope-model-and-averaged-tunnel-ionization">
<h2>Laser Envelope model and averaged tunnel ionization<a class="headerlink" href="#laser-envelope-model-and-averaged-tunnel-ionization" title="Link to this heading">¶</a></h2>
<p>Laser-plasma interaction in underdense plasmas can be accurately simulated under certain conditions through a
laser envelope model, where the high frequency oscillations of the laser pulse do not need to be resolved.
In this model the laser effect on the plasma is described through the ponderomotive force and the effect of the precence of the
plasma on the laser pulse is described through the plasma susceptibility. These terms in the laser plasma interaction
can be expressed only as function of the laser complex envelope.</p>
<p>This technique relaxes the constraint on the minimum spatial and temporal scales to be resolved and can yield
speed-ups of some orders of magnitude, expecially if coupled with a purely cylindrical geometry
(where only one azimuthal mode is taken into account).</p>
<p>The envelope model is particularly used for Laser Wakefield Acceleration, where often the laser pulse envelope is at least ten
times longer than the laser carrier wavelength. Recently an new averaged tunnel ionization model has been developed for the envelope model,
allowing the simulation of Laser Wakefield Acceleration with ionization injection with this efficient technique.</p>
<p>Following is the comparison of the electron density from two LWFA simulations, one using the laser envelope model and the averaged
tunnel ionization module (a) and one without the envelope model (b).</p>
<a class="reference internal image-reference" href="../_images/Rho_2D_IonizationEnvelope_PRE.jpg"><img alt="../_images/Rho_2D_IonizationEnvelope_PRE.jpg" class="align-center" src="../_images/Rho_2D_IonizationEnvelope_PRE.jpg" style="width: 14cm;" /></a>
<p>In these simulations an intense laser pulse is propagating in a plasma composed of helium and partially ionized nitrogen.
The laser field near the pulse’s center is intense enough to further ionize the nitrogen ions, releasing electrons that can be trapped and
accelerated in the relativistic plasma wave behind the laser pulse.</p>
<p>Previous averaged tunnel ionization models did not allow to accurately describe this LWFA scheme at relativistic regimes.
In this new model also the longitudinal momentum of the electrons obtained through ionization is initialized following analytical derivations.
Including this longitudinal momentum initialization allows to accurately describe the dynamics of these electrons.</p>
<p>Following is a comparison of the accelerated electron spectra at the end of these simulations.</p>
<a class="reference internal image-reference" href="../_images/Energy_spectrum_laser_vs_envelope.png"><img alt="../_images/Energy_spectrum_laser_vs_envelope.png" class="align-center" src="../_images/Energy_spectrum_laser_vs_envelope.png" style="width: 14cm;" /></a>
<p>In the green line it is shown the result of the previously known averaged ionization model. Without the longitudinal
momentum initialization, few electrons obtained through ionization are trapped and accelerated in the plasma wave.
The red line shows the result with the new averaged ionization model implemented in <strong class="program">Smilei</strong>, which accurately reproduces
the spectrum obtained with the <em>standard laser</em> simulation without an envelope model.</p>
<p>The envelope simulation required an amount of computing resources orders of magnitude smaller than those required by the simulation without a
laser envelope model.</p>
<p>More details on the envelope model and the averaged tunnel ionization model in <strong class="program">Smilei</strong> can be found <a class="reference external" href="https://journals.aps.org/pre/abstract/10.1103/PhysRevE.102.033204">here</a></p>
</section>
<hr class="docutils" />
<section id="field-initialization-of-a-relativistic-particle-beam">
<h2>Field initialization of a relativistic particle beam<a class="headerlink" href="#field-initialization-of-a-relativistic-particle-beam" title="Link to this heading">¶</a></h2>
<p>In Plasma Wakefield Acceleration (PWFA) a plasma wave is generated behind a relativistic particle
beam propagating in a plasma.</p>
<p>To simulate this phenomenon, it is necessary to self-consistently initialize the electromagnetic fields
of a relativistic particle beam in vacuum, before its entrance into the plasma.</p>
<p>Following is the image of a PWFA simulation which used this technique at its start.</p>
<a class="reference internal image-reference" href="../_images/PWFA.jpg"><img alt="../_images/PWFA.jpg" class="align-center" src="../_images/PWFA.jpg" style="width: 14cm;" /></a>
<p>The “driver” relativistic electron beam (in yellow) propagates through a plasma and drives a nonlinear Langmuir wave (in blue) that
propagates at a velocity close to that of light in its wake. A “witness” relativistic electron bunch injected in this wave
can be accelerated with electric fields orders of magnitude higher than those sustainable by metallic radio-frequency
accelerating cavities.</p>
</section>
<hr class="docutils" />
<section id="azimuthal-fourier-decomposition">
<h2>Azimuthal Fourier decomposition<a class="headerlink" href="#azimuthal-fourier-decomposition" title="Link to this heading">¶</a></h2>
<p>In Laser Wakefield Acceleration (LWFA) a plasma wave is generated behind an intense laser pulse
propagating in an underdense plasma.
The physics in this phenomenon cannot be accurately simulated through 2D Cartesian
simulations. Nonetheless, 3D Cartesian simulations can be computationally demanding,
hence preliminary studies for LWFA experiments, typically consisting of many PIC simulations,
cannot be realissically be carried with 3D Cartesian simulations.</p>
<p>The azimuthal Fourier decomposition addresses this issue by using a cylindrical grid, hence
a 2D grid, decomposing the fields in azimuthal harmonics to take into account a third dimension in space
and treating macro-particles in the 6D phase space.</p>
<p>This technique can yield thus simulations with a computational cost comparable to that of 2D simulations, but
at the same time with an accuracy comparable to that of a full 3D Cartesian simulation.</p>
<p>Following is the image of a LWFA simulation using azimuthal Fourier decomposition, which has made it
feasible in a medium-scale laboratory cluster. An equivalent 3D Cartesian simulation would have required
an amount of resources greater by at least an order of magnitude.</p>
<a class="reference internal image-reference" href="../_images/LWFA_Plas&#64;Par.jpg"><img alt="../_images/LWFA_Plas%40Par.jpg" class="align-center" src="../_images/LWFA_Plas%40Par.jpg" style="width: 13cm;" /></a>
<p>The laser (in red) propagates through a low density plasma and drives a nonlinear Langmuir wave (in blue) that
propagates at a velocity close to that of light in its wake. In this simulation, a moving window is used
so we can follow the laser as it propagates through the plasma. We see electrons being self-injected
in this wakefield where they see a strong electric field that accelerates them up to ultra-relativistic (GeV) energy level.</p>
<p>An animation generated from the simulation data can be found <a class="reference external" href="https://www.youtube.com/watch?v=-LX_yT29nAU">here</a></p>
</section>
<hr class="docutils" />
<section id="improved-performance-using-vectorization">
<h2>Improved performance using vectorization<a class="headerlink" href="#improved-performance-using-vectorization" title="Link to this heading">¶</a></h2>
<p><strong class="program">Smilei</strong> computational performance has been recently enhanced with
<a class="reference internal" href="../Understand/vectorization.html"><span class="doc">vectorized operations</span></a>,
in particular the projection of currents and the interpolation of fields.
Typically, the new algorithms are more efficient than the old ones above
10 particles per cell, up to 3 times faster. An <em>adaptive</em> switching technique
ensures that the best version is used, dynamically and locally.</p>
<p>This has been validated on large-scale simulations.
An example of a mildly-relativistic collisionless shock simulation is provided
in <a class="reference internal" href="#weibel-3d-ne-vecto-it510-fig1"><span class="std std-numref">Fig. 1</span></a> (watch the <a class="reference external" href="https://youtu.be/-ENUekyE_A4">video</a>).</p>
<figure class="align-center" id="weibel-3d-ne-vecto-it510">
<span id="weibel-3d-ne-vecto-it510-fig1"></span><a class="reference internal image-reference" href="../_images/Weibel_3d_ne_vecto_it510.jpg"><img alt="../_images/Weibel_3d_ne_vecto_it510.jpg" src="../_images/Weibel_3d_ne_vecto_it510.jpg" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">Mildly-relativistic collisionless shock simulation, with two drifting
plasmas colliding in the middle of the box.
Top panel: electron density.
Bottom panel: regions switched to vectorized operators are highlighted.</span><a class="headerlink" href="#weibel-3d-ne-vecto-it510" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>High-density regions are switched to vectorized operators while low-density
regions remain scalar (they have only 8 particles per cell).
In this particular case, the treatment of particles can be sped-up by 2.</p>
<p>For more details, checkout the <a class="reference internal" href="../Understand/vectorization.html"><span class="doc">doc</span></a> and this
<a class="reference external" href="https://arxiv.org/abs/1810.03949">ArXiV paper</a>.</p>
</section>
<hr class="docutils" />
<section id="scalability-in-a-wakefield-acceleration-simulation">
<h2>Scalability in a wakefield acceleration simulation<a class="headerlink" href="#scalability-in-a-wakefield-acceleration-simulation" title="Link to this heading">¶</a></h2>
<p>Wakefield-acceleration of electrons in an underdense plasma creates a
hotspot of electrons, which makes the simulation strongly imbalanced.
This spot represent a large part of the total calculations, so that
more computing power should be allocated on it.</p>
<p>Please refer to the doc <a class="reference internal" href="../Understand/parallelization.html"><span class="doc">Parallelization basics</span></a> to learn the basics of the
parallelization techniques employed in this section.</p>
<p class="rubric">1. OpenMP</p>
<p>In a local area around this hotspot, OpenMP is able to manage the computing
resources to make the overall simulation faster. The following figure shows
the evolution of the time to calculate 100 iterations, as a function of time.
Each line corresponds to a different partition of the box in terms of
MPI processes and OpenMP threads: <span class="math notranslate nohighlight">\(N\times M\)</span>, where <span class="math notranslate nohighlight">\(N\)</span> is
the total number of MPI processes, and <span class="math notranslate nohighlight">\(M\)</span> is the number of threads
in each MPI process.</p>
<a class="reference internal image-reference" href="../_images/openMP_balancing.png"><img alt="../_images/openMP_balancing.png" class="align-center" src="../_images/openMP_balancing.png" style="width: 500px;" /></a>
<p>Using more OpenMP threads per MPI process (while keeping the total number
of threads constant) clearly reduces the simulation time, because the
computing power is balanced within each MPI patch collection.</p>
<p class="rubric">2. Dynamic load balancing between MPI processes</p>
<p>At the global simulation scale, OpenMP cannot be used to smoothen the balance.
Instead, a dynamic load balancing (DLB) algorithm periodically exchanges pieces of
the simulation box (<em>patches</em>) between MPI processes, so that each MPI
process owns a fair amount of the simulation load. The following figure
shows how this balancing reduces the time of the simulation.</p>
<a class="reference internal image-reference" href="../_images/DLB_balancing.png"><img alt="../_images/DLB_balancing.png" class="align-center" src="../_images/DLB_balancing.png" style="width: 500px;" /></a>
<p>The red curve is the best situation obtained in the previous section, while
the curves with dynamic load balancing are indicated as <em>DLB</em>.</p>
<p>The portion of the box belonging to each MPI process varies when the load balancing
occurs. The following figure shows how each of these portions evolve with time.</p>
<img alt="../_images/Patch_loadcomparision.jpg" src="../_images/Patch_loadcomparision.jpg" />
<p>The four panels correspond to four timesteps during the simulation.
The colorscale represents the log-scaled load of each patch.
The lines show the borders of each MPI process’ portion of the box.
The MPI processes that are close to the hotspot tend to handle a smaller portion
of the box.</p>
</section>
<hr class="docutils" />
<section id="high-harmonic-generation">
<h2>High-harmonic generation<a class="headerlink" href="#high-harmonic-generation" title="Link to this heading">¶</a></h2>
<p>The interaction between an ultra-intense (<span class="math notranslate nohighlight">\(I&gt;10^{18}~{\rm W/cm^2}\)</span>) femtosecond laser pulse
with a solid target generates a dense “plasma mirror” at its surface that reflects the laser
in a strongly non-linear manner. The temporal distortion of the reflected wave creates
a train of ultra-short attosecond pulses, associated, in the frequency domain,
to a comb of high-order harmonics.</p>
<p>We present a 2-dimensional <strong class="program">Smilei</strong> simulation of laser-solid interaction
with wavelength <span class="math notranslate nohighlight">\(\lambda_0 = 0.8\)</span> µm, peak intensity
<span class="math notranslate nohighlight">\(2\times10^{19}~{\rm W/cm^2}\)</span>, at 45° incidence with p-polarization on an overdense plasma slab
of constant electron density <span class="math notranslate nohighlight">\(n_0=200\,n_c\)</span> (<span class="math notranslate nohighlight">\(n_c\)</span> being the critical density),
<span class="math notranslate nohighlight">\(5\lambda_0\)</span>-thick, with an exponential pre-plasma of gradient length <span class="math notranslate nohighlight">\(0.1\,\lambda_0\)</span>
down to a cut-off density <span class="math notranslate nohighlight">\(0.05\,n_c\)</span>. The full box size is
<span class="math notranslate nohighlight">\(80\,\lambda_0 \times 60\lambda_0\)</span> and the simulation time <span class="math notranslate nohighlight">\(150\,\lambda_0/c\)</span>
with a total of <span class="math notranslate nohighlight">\(\sim 1.4\)</span> billion quasi-particles in the box.</p>
<p>The following figure (top panel) shows half of the simulation box in the
y-direction, and the laser field is reported at three different times.
The reflected laser pulse (at time <span class="math notranslate nohighlight">\(t_2\)</span>) shows a different spectral content than
the incident pulse (at time <span class="math notranslate nohighlight">\(t_0\)</span>).
A close-up view of the interaction region is given in the bottom panel, illustrating
the electron bunches being pulled out from the plasma surface.</p>
<a class="reference internal image-reference" href="../_images/hhg1.jpg"><img alt="../_images/hhg1.jpg" class="align-center" src="../_images/hhg1.jpg" style="width: 13cm;" /></a>
<p>Fourier analysis of the reflected laser field, in space and time, provides the
angular distribution of the frequency spectrum of the reflected light, shown in the
following figure (top panel). High harmonics appear up to order 16.</p>
<a class="reference internal image-reference" href="../_images/hhg2.jpg"><img alt="../_images/hhg2.jpg" class="align-center" src="../_images/hhg2.jpg" style="width: 13cm;" /></a>
<p>The bottom panel shows trajectories of accelerated electrons ejected from the target.
The angular histogram shows that the momenta of the escaping energetic electrons
(1 to 10 MeV) are mostly directed along two directions which are close to the reflected
laser direction.</p>
<p>This simulation was run on the CINES/Occigen (Bullx) machine using 256 MPI x 14 OpenMP
threads for about 10700 CPU-hours. The characteristic computing time per particle
(average PIC iteration divided by the number of particles) is of the order of
0.7 µs, including 25% for diagnostics.</p>
</section>
<hr class="docutils" />
<section id="brillouin-amplification">
<h2>Brillouin amplification<a class="headerlink" href="#brillouin-amplification" title="Link to this heading">¶</a></h2>
<p>Coupling, in a plasma, a long energetic “pump” pulse of moderate intensity to
a short counter-propagating “seed” pulse of initially low intensity can transfer energy
from the pump to the seed thanks to the excitation of a plasma or ion-acoustic wave.</p>
<p>Here, we look specifically at
the <a class="reference external" href="http://aip.scitation.org/doi/abs/10.1063/1.861248">stimulated Brillouin scattering</a>
(SBS) amplification, where the excited waves are ion-acoustic waves.</p>
<p>A pump with intensity <span class="math notranslate nohighlight">\(10^{15}\)</span> W/cm² (wavelength 1 µm)
correspond to the “strong-coupling” regime, particularly robust with respect to
plasma inhomogeneities and seed frequency <a class="reference internal" href="material.html#chiaramello2016" id="id2"><span>[Chiaramello2016]</span></a>.</p>
<p>A 2-dimensional simulation, in conditions close to actual experiments, ran
on a box size of 1024 µm x 512 µm for  10 ps
with 25 billion quasi-particles. The following figure shows the evolution
of the pump and seed intensities in the head-on collision at three different times.
Surfaces corresponding to the laser intensity are overlaid on top of surfaces
corresponding to the plasma density.</p>
<img alt="../_images/pump_seed.jpg" class="align-center" src="../_images/pump_seed.jpg" />
<p>The final seed intensity is nearly 5 times its initial intensity
while the spot size and phase front are well conserved,
suggesting that such a beam could be further focused using plasma mirrors.</p>
<p>This simulation used the IDRIS/Turing (BlueGene/Q) super-computer using 1.8 million
CPU-hours on 32768 MPI processes, and 4 OpenMP threads per core.
The average time to push a particle was 1.9 µs, including 5%
for diagnostics. On the CINES/Occigen (Bullx) machine, we obtained an average time
of 0.43 µs to push one particle (without diagnostics).</p>
</section>
<hr class="docutils" />
<section id="magnetic-reconnection-at-the-earth-magnetopause">
<h2>Magnetic reconnection at the Earth magnetopause<a class="headerlink" href="#magnetic-reconnection-at-the-earth-magnetopause" title="Link to this heading">¶</a></h2>
<p>Magnetic reconnection at the Earth magnetopause regulates the transport of matter,
momentum and energy from the solar wind to the internal magnetosphere.
The solar wind plasma temperature is typically one tenth that of the magnetospheric plasma,
but its density is about ten times larger, and its magnetic field 2-3 times smaller.
This asymmetry makes the reconnection dynamics vastly more complex than in symmetric
environments, and has only been studied for a decade
via <a class="reference external" href="http://dx.doi.org/10.1063/1.4811467">numerical simulations</a>
and spacecraft observations.</p>
<p>Studying the impact of a plasmaspheric plume on magnetopause reconnection
via kinetic numerical simulation is difficult. The simulation first needs
to reach a quasi-steady state reconnection with a typical magnetopause asymmetry,
see the arrival of the plume and then last longer for a quasi-steady state plume
reconnection regime to settle. Due to the large particle density of plumes,
the transition and last phases have substantially longer time scales than the early phase,
which makes the simulation heavy. The domain must be long enough in the downstream direction
for the plasma, expelled during the early and transition phases, to be evacuated from
the reconnection region. Otherwise, upstream plasma would not inflow,
thereby stopping reconnection.</p>
<p>Three ion populations are present.
The solar wind and magnetospheric populations have densities equal to <span class="math notranslate nohighlight">\(n_0\)</span> and <span class="math notranslate nohighlight">\(n_0/10\)</span>,
respectively, on their side of the current sheet, and fall to zero on the other side.
The plume population increases from 0 to <span class="math notranslate nohighlight">\(2\,n_0\)</span> at <span class="math notranslate nohighlight">\(20\,c/\omega_{pi}\)</span> from the initial
current sheet on the magnetospheric side. The magnetic field amplitude goes from <span class="math notranslate nohighlight">\(2\,B_0\)</span>
in the magnetosphere to <span class="math notranslate nohighlight">\(B_0=m_e\omega_{pe}/e\)</span> in the solar wind and is totally in the
simulation plane. The temperature is initially isotropic and its profile is calculated
to balance the total pressure.</p>
<p>The domain size is 1280 <span class="math notranslate nohighlight">\(c/\omega_{pi} \times\)</span> 256 <span class="math notranslate nohighlight">\(c/\omega_{pi}\)</span>.
The total simulation time is <span class="math notranslate nohighlight">\(800\times\)</span> the ion gyration time.
We used a reduced ion to electron mass ratio <span class="math notranslate nohighlight">\(m_i/m_e = 25\)</span>, and a ratio
50 of the speed of light by the Alfvén velocity.
There are initially 8.6 billion quasi-protons for the three populations, and 13 billion electrons.</p>
<a class="reference internal image-reference" href="../_images/reconnection.jpg"><img alt="../_images/reconnection.jpg" class="align-center" src="../_images/reconnection.jpg" style="width: 15cm;" /></a>
<p>This figure presents some of the simulation results:
the electron density at three different times.
In the top panel, reconnection is in steady state between the solar wind plasma of
density <span class="math notranslate nohighlight">\(\simeq n_0\)</span> and the magnetosphere plasma of density <span class="math notranslate nohighlight">\(\simeq 0.1~n_0\)</span>.
At this time, the exhaust is filled with mixed solar wind/hot magnetospheric plasma as
the plume (of density <span class="math notranslate nohighlight">\(\simeq 2~n_0\)</span>) is still located at <span class="math notranslate nohighlight">\(\simeq 10~c/\omega_{pi}\)</span>
from the magnetospheric separatrix. The reconnection rate during this period has a
typical value around <span class="math notranslate nohighlight">\(0.1~\Omega_{ci}^{-1}\)</span>, with important fluctuations caused
by plasmoid formation. The plume, originally at <span class="math notranslate nohighlight">\(20~c/\omega_{pi}\)</span> from the magnetopause,
is slowly advected towards the magnetosphere separatrix and finally touches the
reconnection site at about <span class="math notranslate nohighlight">\(t=300~\Omega_{ci}^{-1}\)</span>. The second panel at
<span class="math notranslate nohighlight">\(t=370~\Omega_{ci}^{-1}\)</span> shows the plume starting to fill the exhaust after
reaching the reconnection site and mixing with solar wind plasma.
At this time, the reconnection rate collapses to about half its previous value.
The transition phase lasts for about <span class="math notranslate nohighlight">\(100~\Omega_{ci}^{-1}\)</span> before a plume
reconnection regime reaches a quasi-steady state.
The third panel shows the electron density at the end of the simulation,
where the exhaust is filled with plume and solar wind plasma.</p>
<p>This large-scale simulation has run for a total of 14 million CPU-hours on 16384 cores
of the CINES/Occigen (Bullx) supercomputer within a GENCI-CINES special call.
Overall, the characteristic (full) push-time for a single particle was of the order
of 1.6 µs (including 31% for diagnostics).
No dynamic load balancing was used for this simulation.</p>
</section>
<hr class="docutils" />
<section id="collisionless-shock-in-pair-plasmas">
<h2>Collisionless shock in pair plasmas<a class="headerlink" href="#collisionless-shock-in-pair-plasmas" title="Link to this heading">¶</a></h2>
<p>Relativistic collisionless shocks play a fundamental role in various astrophysical scenarios
(active galactic nuclei, micro-quasars, pulsar wind nebulae and gamma-ray bursts)
where they cause high-energy radiation and particle acceleration related to the
cosmic-ray spectrum. In the absence of particle collisions, the shock is mediated
by collective plasma processes, produced by electromagnetic plasma instabilities
at the shock front.</p>
<p>Specifically, the Weibel (or current filamentation) instability
is observed in most of the astrophysical relativistic outflows interacting with
the interstellar medium. It can be excited by counter-streaming unmagnetized relativistic
flows, and dominates the instability spectrum for a wide range of parameters.
The resulting strong magnetic turbulence can isotropize the incoming flow,
hence stopping it and leading to compression of the downstream (shocked plasma) and shock formation.</p>
<p>We present a 2-dimensional PIC simulation of such shock,
driven in an initially unmagnetized electron-positron plasma.
The simulation relies on the “piston” method that consists in initializing the
simulation with a single cold electron-positron plasma drifting
at a relativistic velocity <span class="math notranslate nohighlight">\(v_0 \simeq 0.995\,c\)</span>.
Reflecting boundary conditions at the right border creates a counter-penetrating flow.</p>
<p>The simulation box size is 2048 <span class="math notranslate nohighlight">\(\delta_e \times\)</span> 128 <span class="math notranslate nohighlight">\(\delta_e\)</span>
(<span class="math notranslate nohighlight">\(\delta_e = c/\omega_p\)</span> being the electron skin-depth of the initial flow),
with a total of 2.15 billion quasi-particles.
The following figure show an unstable overlapping region of incoming and
reflected flows, resulting in the creation, before the shock
of filamentary structures in both the magnetic field (panel a) and
the total plasma density (panel b).</p>
<a class="reference internal image-reference" href="../_images/shock1.jpg"><img alt="../_images/shock1.jpg" class="align-center" src="../_images/shock1.jpg" style="width: 15cm;" /></a>
<p>The magnetic field at the shock front becomes turbulent and it is strong
enough to stop the incoming particles leading to a pile-up of the plasma
density (panel c).</p>
<p>The following figure demonstrates the build-up, at late times, of a supra-thermal tail
in the downstream particle energy distribution.
It is characteristic of first-order Fermi acceleration at the shock front,
and appears to follow a <span class="math notranslate nohighlight">\(\gamma^{-2.5}\)</span> power law.</p>
<a class="reference internal image-reference" href="../_images/shock3.jpg"><img alt="../_images/shock3.jpg" class="align-center" src="../_images/shock3.jpg" style="width: 11cm;" /></a>
<p>This simulation run on the TGCC/Curie machine using 128 MPI x 8 OpenMP threads
for a total of 18800 CPU-hours for 49780 timesteps.
The average push time for one quasi-particle was of 0.63 µs (including 20% for diagnostics).</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      <div>
        <input type="button" id="themebutton"  value="" onclick="switchTheme('')" />
      </div>
      <div>
      <a href="site.html">Site index</a>
      </div>
      <div>
        Last updated on May 26, 2025
      </div>
      
      <div>
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      </div>
      
    </div>
    
    <script type="text/javascript">
        
        var nav = document.getElementById("nav");
        var nav_list = document.getElementById("nav_list");
        var nav_button = document.getElementById("nav_button");
        var smallScreenMenu = document.getElementById("smallScreenMenu");
        var smallScreenMenuButton = document.getElementById("smallScreenMenuButton");
        var searchicon = document.getElementById("searchicon");
        var searchbox  = document.getElementById("searchbox");
        var searchinput= document.getElementById("searchinput");
        var menus = document.getElementsByClassName("menu");
        for( var i=0; i<menus.length; i++ )
            menus[i].active = false;
        
        // Manage theme
        var theme="light";
        function switchTheme(type) {
            if( type == "dark" || ( ! type && theme == "light" ) ) {
                theme = "dark";
                document.documentElement.setAttribute('theme', 'dark');
                window.name = "dark_theme"
                localStorage.setItem("_theme","dark")
            } else {
                theme = "light";
                document.documentElement.setAttribute('theme', 'light');
                window.name = "light_theme"
                localStorage.setItem("_theme","light")
            }
        }
        if( window.name && window.name == "light_theme" ) {
            switchTheme("light");
        } else if ( window.name && window.name == "dark_theme" ) {
            switchTheme("dark");
        } else if( stored_theme = localStorage.getItem("_theme") ) {
            switchTheme(stored_theme);
        } else if( window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches) {
            switchTheme("dark");
        }
        
        var ul = nav_list.getElementsByTagName("ul")[0], li;
        var keep_nav = false;
        if( ul ) {
            li = ul.firstElementChild;
            if( li ) {
                if( li.getElementsByTagName("ul").length > 0 ) keep_nav = true;
            }
        }
        if( keep_nav ) {
            li.removeChild( li.firstElementChild );
        } else {
            document.getElementById("nav_positioner").removeChild( document.getElementById("nav") );
        }
        
        function navOff() {
            nav_list.style.display = "none";
            nav_button.className = "";
            nav.style.overflowY = "visible";
        }
        
        function toggleNav() {
            for( var i=0; i<menus.length; i++ )
                menuOff( menus[i] );
            if( nav_list.style.display != "inline-block" ) {
                nav_list.style.display = "inline-block";
                nav_button.className = "pushed";
                nav.style.overflowY = "auto";
            } else {
                navOff();
            }
        }
        
        function toggleSmallScreenMenu(e) {
            if( smallScreenMenu.className != "on" ) {
                smallScreenMenu.className = "on";
                smallScreenMenuButton.className = "pushed";
                document.documentElement.style.overflow = "hidden";
            } else {
                smallScreenMenu.className = "off";
                smallScreenMenuButton.className = "";
                document.documentElement.style.overflow = "";
            }
        }
        
        if (smallScreenMenuAfterTOC = document.getElementById("smallScreenMenuAfterTOC")) {
            var smallScreenMenuTOC = smallScreenMenuAfterTOC.previousElementSibling
                .getElementsByTagName("li")[0].getElementsByTagName("ul")[0].getElementsByTagName("li");
            for (var i = 0; i < smallScreenMenuTOC.length; i++) {
                if (smallScreenMenuTOC[i].tagName = "a") {
                    smallScreenMenuTOC[i].addEventListener("click", function(event){ toggleSmallScreenMenu(event); } );
                }
            }
        }
        
        function prepareMenu(menu_id) {
            var menu = document.getElementById(menu_id);
            menu.timer1 = setTimeout(function(a){ return function(){thisMenuOnly(a)};}(menu_id), 100);
            menu.addEventListener("mouseleave", function(a){ return function(){clearTimeout(a.timer1)};}(menu) );
        }
        
        function leaveMenu(menu_id, source) {
            var menu = document.getElementById(menu_id);
            menu.timer2 = setTimeout(function(a){ return function(){menuOff(a)};}(menu), 1000);
            source.addEventListener("mouseenter", function(a){ return function(){clearTimeout(a.timer2)};}(menu) );
        }
        
        function menuOn( menu ) {
            var divs = menu.getElementsByTagName("div");
            if(nav_list) navOff();
            divs[1].className = "on";
            divs[0].className = "menuButton pushed";
            menu.active = true;
        }
        function menuOff( menu ) {
            var divs = menu.getElementsByTagName("div");
            divs[1].className = "off";
            divs[0].className = "menuButton";
            menu.active = false;
        }
        
        function thisMenuOnly(menu_id) {
            var menu = document.getElementById(menu_id);
            for( var i=0; i<menus.length; i++ )
                if( i!=menu_id )
                    menuOff( menus[i] );
            menuOn( menu );
        }
        
        function toggleMenu(menu_id) {
            var menu = document.getElementById(menu_id);
            if( menu.active ) {
                menuOff( menu );
            } else {
                for( var i=0; i<menus.length; i++ )
                    if( i!=menu_id )
                        menuOff( menus[i] );
                menuOn( menu );
            }
        }
        
        function openSearch() {
            for( var i=0; i<menus.length; i++ ) {
                menuOff( menus[i] );
                menus[i].style.zIndex = "-1";
            }
            searchicon.style.display = "none";
            closesearchicon.style.display = "block";
            searchbox.style.display = "block";
            searchinput.focus();
        }
        
        function closeSearch() {
            searchicon.style.display = "block";
            closesearchicon.style.display = "none";
            searchbox .style.display = "none";
            for( var i=0; i<menus.length; i++ )
                menus[i].style.zIndex = "0";
        }
        
        
        var documentDiv = document.getElementsByClassName("document")[0];
        documentDiv.addEventListener('click', function (event) {
            if(nav_list) navOff();
            for( var i=0; i<menus.length; i++ )
                menuOff( menus[i] );
        });
    </script>
  </body>
</html>