<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Troubleshoot &#8212; Smilei 5.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/smilei_theme.css?v=3908db80" />
    <script src="../_static/documentation_options.js?v=4af8989d"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="icon" href="../_static/smileiIcon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="GPU version" href="GPU_version.html" />
    <link rel="prev" title="Contribute" href="contribute.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": {
      scale: 95,
      availableFonts: ["TeX"]
    }
  });
  </script>
   
  </head><body>

<div id="smallScreenMenu" class="off">

    
    <div class="toctree-smilei">
        <ul>
            <li class="outer">
                <a href="../Overview/synopsis.html">Synopsis</a>
            </li>
            <li class="outer">
                <a href="../Overview/highlights.html">Highlights</a>
            </li>
            <li class="outer">
                <a href="../Overview/releases.html">Releases</a>
            </li>
            <li class="outer">
                <a href="../Overview/licence.html">Licence</a>
            </li>
            <li class="outer">
                <a href="../Overview/material.html">Publications</a>
            </li>
            <li class="outer">
                <a href="../Overview/partners.html">Partners</a>
            </li>
        </ul>
        <hr />
        <ul>
            <li class="outer">
                <a href="../Understand/units.html">Units</a>
            </li>
            <li class="outer">
                <a href="../Understand/algorithms.html">PIC algorithms</a>
            </li>
            <li class="outer">
                <a href="../Understand/performances.html">Parallelization & optimization</a>
            </li>
            <li class="outer">
                <a href="../Understand/physics_modules.html">Physics modules</a>
            </li>
            <li class="outer">
                <a href="../Understand/numerical_techniques.html">Advanced numerical techniques</a>
            </li>
            <li class="outer">
                <a href="../Understand/PML.html">Perfectly Matched Layers</a>
            </li>
        </ul>
        <hr />
        <ul>
            <li class="outer">
                <a href="installation.html">Install</a>
            </li>
            <li class="outer">
                <a href="https://smileipic.github.io/tutorials">Smilei tutorials</a>
            </li>
            <li class="outer">
                <a href="namelist.html">Write a namelist</a>
            </li>
            <li class="outer">
                <a href="run.html">Run</a>
            </li>
            <li class="outer">
                <a href="post-processing.html">Post-process</a>
            </li>
            <li class="outer">
                <a href="contribute.html">Contribute</a>
            </li>
        </ul>
                <ul>
<li><a class="reference internal" href="#">Troubleshoot</a><ul>
<li><a class="reference internal" href="#simulation-not-starting-error-running-a-simulation">Simulation not starting / Error running a simulation</a></li>
<li><a class="reference internal" href="#new-simulation-does-not-run">New simulation does not run</a></li>
<li><a class="reference internal" href="#postprocessing-error">Postprocessing error</a></li>
<li><a class="reference internal" href="#physical-error-in-the-results">Physical error in the results.</a></li>
<li><a class="reference internal" href="#performances-issues">Performances issues</a></li>
</ul>
</li>
</ul>

        <ul id="smallScreenMenuAfterTOC">
            <li class="outer">
                <a href="GPU_version.html">GPU version</a>
            </li>
        </ul>
        <hr />
    </div>

</div>
<div id="hcontainer">
    <div id="nav_positioner">
        <div id="nav">
            <div id="nav_button" onclick="toggleNav()">
                Sections
            </div>
            <div id="nav_list" class="toctree-smilei">
                <div id="nav_title"><a href="#">Troubleshoot</a></div>
                <ul>
<li><a class="reference internal" href="#">Troubleshoot</a><ul>
<li><a class="reference internal" href="#simulation-not-starting-error-running-a-simulation">Simulation not starting / Error running a simulation</a></li>
<li><a class="reference internal" href="#new-simulation-does-not-run">New simulation does not run</a></li>
<li><a class="reference internal" href="#postprocessing-error">Postprocessing error</a></li>
<li><a class="reference internal" href="#physical-error-in-the-results">Physical error in the results.</a></li>
<li><a class="reference internal" href="#performances-issues">Performances issues</a></li>
</ul>
</li>
</ul>

            </div>
        </div>
    </div>
    
    <div class="headercolor">
    </div>
    <div class="hpositioner">
        <div class="header">
        <div class="logo">
            <a href="../index.html">
                <img class="logo" src="../_static/smileiLogo.svg" alt="Logo" />
            </a>
            <!--
            <div style="height:7mm; position: absolute; top:2mm; left:-32mm; padding: 1mm 2mm 0 2mm; border-radius: 2mm; background-color:#C5DCEA; background-color:var(--header_text);">
                <a href="https://indico.math.cnrs.fr/e/smilei5">
                    <img src="../_static/workshopLogo.svg" alt="workshop"
                        style="height:5mm;padding-top: 1mm;" />
                </a>
            </div>
            -->
        </div>
        <div class="menu"
            id="menu_Overview"
            
        >
            <div id="menuButton_Overview" class="menuButton"
                 onmouseenter="prepareMenu('menu_Overview')"
                 onmousedown="event.preventDefault()"
            >
                <a href="../overview.html">
                    <span>Overview</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_Overview',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="../Overview/synopsis.html">Synopsis</a>
                        </li>
                        <li class="outer">
                            <a href="../Overview/highlights.html">Highlights</a>
                        </li>
                        <li class="outer">
                            <a href="../Overview/releases.html">Releases</a>
                        </li>
                        <li class="outer">
                            <a href="../Overview/licence.html">Licence</a>
                        </li>
                        <li class="outer">
                            <a href="../Overview/material.html">Publications</a>
                        </li>
                        <li class="outer">
                            <a href="../Overview/partners.html">Partners</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        <div class="menu"
            id="menu_Understand"
            
        >
            <div id="menuButton_Understand" class="menuButton"
                 onmouseenter="prepareMenu('menu_Understand')"
                 onmousedown="event.preventDefault()"
            >
                <a href="../understand.html">
                    <span>Understand</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_Understand',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="../Understand/units.html">Units</a>
                        </li>
                        <li class="outer">
                            <a href="../Understand/algorithms.html">PIC algorithms</a>
                        </li>
                        <li class="outer">
                            <a href="../Understand/performances.html">Parallelization & optimization</a>
                        </li>
                        <li class="outer">
                            <a href="../Understand/physics_modules.html">Physics modules</a>
                        </li>
                        <li class="outer">
                            <a href="../Understand/numerical_techniques.html">Advanced numerical techniques</a>
                        </li>
                        <li class="outer">
                            <a href="../Understand/PML.html">Perfectly Matched Layers</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        <div class="last menu"
            id="menu_Use"
            style="font-weight:bold"
        >
            <div id="menuButton_Use" class="menuButton"
                 onmouseenter="prepareMenu('menu_Use')"
                 onmousedown="event.preventDefault()"
            >
                <a href="../use.html">
                    <span>Use</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_Use',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="installation.html">Install</a>
                        </li>
                        <li class="outer">
                            <a href="https://smileipic.github.io/tutorials">Smilei tutorials</a>
                        </li>
                        <li class="outer">
                            <a href="namelist.html">Write a namelist</a>
                        </li>
                        <li class="outer">
                            <a href="run.html">Run</a>
                        </li>
                        <li class="outer">
                            <a href="post-processing.html">Post-process</a>
                        </li>
                        <li class="outer">
                            <a href="contribute.html">Contribute</a>
                        </li>
                        <li >
                            <a href="#">Troubleshoot</a>
                        </li>
                        <li class="outer">
                            <a href="GPU_version.html">GPU version</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        
        <script type="text/javascript">
            var es=document.getElementsByClassName("menuButton"), i=0;
            var evt = "ontouchend" in document ? "touchend" : "click";
            for( var i=0; i<es.length; i+=1 ) {
                es[i].addEventListener(evt, function(a){ return function(){toggleMenu(a)};}(es[i].parentNode.id));
            }
        </script>
        
        <div id="searchbox" role="search" style="display:none">
            <form class="search" action="../search.html" method="get">
              <input type="text" name="q" placeholder="Search" id="searchinput" />
              <input type="hidden" name="check_keywords" value="yes" />
              <input type="hidden" name="area" value="default" />
            </form>
        </div>
        
        <div id="searchicon" onclick="openSearch()" style="display:block">
            <svg
               xmlns="http://www.w3.org/2000/svg"
               viewBox="0 0 80 120">
              <g transform="translate(0,-932.36216)" >
                <circle
                   r="25" cy="977.51044" cx="38.078663"
                   style="opacity:1;fill:none;stroke:#ffffff;stroke:var(--header_text);stroke-width:10;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
                <rect
                   transform="matrix(0.36717877,0.93015039,-0.93427297,0.35655858,0,0)"
                   rx="4.9996676" ry="7.4995141" x="947.6142" y="316.16959"
                   height="14.117695" width="46.476151"
                   style="opacity:1;fill:#ffffff;fill:var(--header_text);fill-opacity:1;stroke:none;" />
                <path
                   d="m 41.383282,962.25996 a 15,15 0 0 1 11.660107,11.6355"
                   style="opacity:1;fill:none;stroke:#ffffff;stroke:var(--header_text);stroke-width:3;stroke-linecap:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
              </g>
            </svg>
        </div>
        <div id="closesearchicon" onclick="closeSearch()" style="display:none">
            <svg
               xmlns="http://www.w3.org/2000/svg"
               viewBox="0 0 80 120">
              <g
                 transform="translate(0,-932.36216)"
                 style="fill:none;stroke:#ffffff;stroke:var(--header_text);stroke-width:10;stroke-linecap:round;stroke-linejoin:miter;stroke-opacity:1;stroke-miterlimit:4;stroke-dasharray:none">
                <path d="m 10,962.36216 60,60.00004" />
                <path d="M 70,962.36216 10,1022.3622" />
              </g>
            </svg>
        </div>
        
        <div id="smallScreenMenuButton" onclick="event.preventDefault(); toggleSmallScreenMenu(event)">
            <svg xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg"
               viewBox="-20 -20 140 140">
              <g  style="fill:#ffffff; fill:var(--header_text);stroke:none;">
                <circle cx="15" cy="20" r="5" />
                <circle cx="35" cy="20" r="5" />
                <circle cx="85" cy="20" r="5" />
                <rect width="50" height="10" x="35" y="15" rx="0" ry="0" />
                <circle cx="15" cy="40" r="5" />
                <circle cx="35" cy="40" r="5" />
                <circle cx="85" cy="40" r="5" />
                <rect width="50" height="10" x="35" y="35" rx="0" ry="0" />
                <circle cx="15" cy="60" r="5" />
                <circle cx="35" cy="60" r="5" />
                <circle cx="85" cy="60" r="5" />
                <rect width="50" height="10" x="35" y="55" rx="0" ry="0" />
                <circle cx="15" cy="80" r="5" />
                <circle cx="35" cy="80" r="5" />
                <circle cx="85" cy="80" r="5" />
                <rect width="50" height="10" x="35" y="75" rx="0" ry="0" />
              </g>
            </svg>
        </div>
        
    </div>
    
</div>
</div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="troubleshoot">
<h1>Troubleshoot<a class="headerlink" href="#troubleshoot" title="Link to this heading">¶</a></h1>
<p>If you encounter issues running your simulation, you can ask for help in the chat room on Element or publish an <code class="docutils literal notranslate"><span class="pre">Issue</span></code> on <a class="reference external" href="https://github.com/SmileiPIC/Smilei/issues">GitHub</a>.
From previous users experience, the cause of most of the issues can be found performing some basic checks, listed in the following.
Also, performing these simple tests helps us while finding an answer to your <code class="docutils literal notranslate"><span class="pre">Issue</span></code>.</p>
<hr class="docutils" />
<section id="simulation-not-starting-error-running-a-simulation">
<h2>Simulation not starting / Error running a simulation<a class="headerlink" href="#simulation-not-starting-error-running-a-simulation" title="Link to this heading">¶</a></h2>
<p>Your simulation does not start or has an error while running.</p>
<ul class="simple">
<li><p>Check that the <code class="docutils literal notranslate"><span class="pre">smilei</span></code> executable is called correctly, e.g. it is present in the input namelist folder or correctly called from there. See also <a class="reference internal" href="run.html"><span class="doc">Run</span></a>.</p></li>
<li><p>Check that <code class="docutils literal notranslate"><span class="pre">smilei</span></code> runs correctly with at least one input namelist in the <code class="docutils literal notranslate"><span class="pre">benchmarks</span></code> folder.</p></li>
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">smilei_test</span></code> executable on your input namelist. Does it display error or warning messages?</p></li>
<li><p>Check your <a class="reference internal" href="profiles.html"><span class="doc">Profiles</span></a> in the input namelist, e.g. Avoid <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values if you read them from a file or generate them through a Python function.</p></li>
<li><p>Try <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span></code>, <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">clean</span></code> and compile again. Also, be sure that uou have already used <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">happi</span></code> for postprocessing. All these operations must be performed in the installation folder on your machine to run the simulations.</p></li>
<li><p>Change the numerical parameters in the input namelist e.g. resolution, timestep, particles per cell, number of patches. Does the error occur again? See the dedicated sections in <a class="reference internal" href="namelist.html"><span class="doc">Write a namelist</span></a>.</p></li>
<li><p>Change the number of MPI process, OpenMP threads. Do the simulations in the <code class="docutils literal notranslate"><span class="pre">benchmarks</span></code> folder run correctly with only one MPI process/OpenMP thread?</p></li>
<li><p>Check that your MPI and OpenMP configuration is correct through parallel Hello World tests or other basic parallel programs.</p></li>
<li><p>Try running a reduced simulation (less particles per cell, coarser resolution).</p></li>
<li><p>Try using the same input namelist, and/or a reduced version (less particles per cell, coarser resolution) on a different machine.</p></li>
<li><p>If the simulation stops after its start, does the error occur always at the same iteration? With <code class="docutils literal notranslate"><span class="pre">print_every</span></code> in the input namelist you can change the iteration print frequency in the log file.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="new-simulation-does-not-run">
<h2>New simulation does not run<a class="headerlink" href="#new-simulation-does-not-run" title="Link to this heading">¶</a></h2>
<p>You have already run successfully other similar simulations, but a new one gives an error at the start.</p>
<ul class="simple">
<li><p>Use the input namelist of the simulation that works correctly and then progressively change the input to arrive to the simulation you want to run. At each step check if something goes wrong and what is the change in the input namelist that caused the issue.</p></li>
<li><p>Try running the new simulation with the <code class="docutils literal notranslate"><span class="pre">smilei</span></code> executable used for the simulation that worked correctly, if different. Changing the code version creates the problem?</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="postprocessing-error">
<h2>Postprocessing error<a class="headerlink" href="#postprocessing-error" title="Link to this heading">¶</a></h2>
<p>You can run the simulation but you cannot open/read the results.</p>
<ul class="simple">
<li><p>Do <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span></code> and <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">happi</span></code> in your installation folder to have the postprocessing library <code class="docutils literal notranslate"><span class="pre">happi</span></code> ready for use. Afterwards, remember to close and reopen the Python interface you are using, e.g. IPython. See also <a class="reference internal" href="installation.html"><span class="doc">Install</span></a>.</p></li>
<li><p>Check if you can correctly open the results of a simulation using one input namelist in the <code class="docutils literal notranslate"><span class="pre">benchmarks</span></code> folder.</p></li>
<li><p>Carefully read the doc about the <a class="reference internal" href="post-processing.html"><span class="doc">Post-process</span></a> method you are trying to use.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="physical-error-in-the-results">
<h2>Physical error in the results.<a class="headerlink" href="#physical-error-in-the-results" title="Link to this heading">¶</a></h2>
<p>The physical results are not the ones you expect.</p>
<ul class="simple">
<li><p>Read the doc on the physical methods you are using (e.g. <a class="reference internal" href="../Understand/collisions.html"><span class="doc">Binary collisions &amp; reactions</span></a>,
<a class="reference internal" href="../Understand/ionization.html"><span class="doc">Ionization</span></a>, <a class="reference internal" href="../Understand/laser_envelope.html"><span class="doc">Laser envelope model</span></a>, …).
Are the underlying physical assumptions satisfied?</p></li>
<li><p>Check that the units given in the input namelist are properly normalized.
See also <a class="reference internal" href="../Understand/units.html"><span class="doc">Units</span></a>.</p></li>
<li><p>Some physical processes like <a class="reference internal" href="../Understand/collisions.html"><span class="doc">Binary collisions &amp; reactions</span></a>, <a class="reference internal" href="../Understand/ionization.html"><span class="doc">Ionization</span></a>
need a reference frequency in SI in the <code class="docutils literal notranslate"><span class="pre">Main</span></code> block of the input namelist. Did you provide it?
See also <a class="reference internal" href="namelist.html"><span class="doc">Write a namelist</span></a>.</p></li>
<li><p>Check the CFL condition in the input namelist. See <a class="reference internal" href="../Understand/algorithms.html"><span class="doc">PIC algorithms</span></a></p></li>
<li><p>See with the Scalar diagnostics (See <a class="reference internal" href="post-processing.html"><span class="doc">Post-process</span></a> ) if the kinetic energy <code class="docutils literal notranslate"><span class="pre">Ukin</span></code>
or electromagnetic energy <code class="docutils literal notranslate"><span class="pre">Uelm</span></code> display strange behaviours (e.g. exponential growths).</p></li>
<li><p>Verify the overall consistency of the physical set-up, e.g. only immobile or almost immobile
particles while using a Poisson solver.</p></li>
<li><p>Verify that the physical initialization is correct. Should you use a classical or
relativistic Poisson solver (See <a class="reference internal" href="../Understand/relativistic_fields_initialization.html"><span class="doc">Field initialization for relativistic species</span></a>)
for the initial fields. Is it necessary to use a Poisson solver?</p></li>
<li><p>Check the presence of numerical effects running the simulation with different numerical
parameters, e.g. changing the resolution, timestep, in the input namelist.</p></li>
<li><p>If using the <code class="docutils literal notranslate"><span class="pre">AMcylindrical</span></code> geometry, check that the origin of the axes you are using
in the input namelist is the one described in See <a class="reference internal" href="../Understand/azimuthal_modes_decomposition.html"><span class="doc">Azimuthal modes decomposition</span></a>.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="performances-issues">
<h2>Performances issues<a class="headerlink" href="#performances-issues" title="Link to this heading">¶</a></h2>
<p>The simulation is very slow / the performances are not as expected.</p>
<ul class="simple">
<li><p>Change the number of MPI process and OpenMP threads.</p></li>
<li><p>Change the number of patches and/or their distribution in each direction.
See also <a class="reference internal" href="../Understand/parallelization.html"><span class="doc">Parallelization basics</span></a>.</p></li>
<li><p>Check that <code class="docutils literal notranslate"><span class="pre">LoadBalancing</span></code> is activated in the <a class="reference internal" href="namelist.html"><span class="doc">Write a namelist</span></a>
(if the physical set-up is suitable for its use). See also <a class="reference internal" href="../Understand/parallelization.html"><span class="doc">Parallelization basics</span></a>.</p></li>
<li><p>If using <a class="reference internal" href="../Understand/vectorization.html"><span class="doc">Vectorization</span></a>, check that the compilation flags for vectorization
were correctly used. See also <a class="reference internal" href="installation.html"><span class="doc">Install</span></a>.</p></li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      <div>
        <input type="button" id="themebutton"  value="" onclick="switchTheme('')" />
      </div>
      <div>
      <a href="site.html">Site index</a>
      </div>
      <div>
        Last updated on May 26, 2025
      </div>
      
      <div>
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      </div>
      
    </div>
    
    <script type="text/javascript">
        
        var nav = document.getElementById("nav");
        var nav_list = document.getElementById("nav_list");
        var nav_button = document.getElementById("nav_button");
        var smallScreenMenu = document.getElementById("smallScreenMenu");
        var smallScreenMenuButton = document.getElementById("smallScreenMenuButton");
        var searchicon = document.getElementById("searchicon");
        var searchbox  = document.getElementById("searchbox");
        var searchinput= document.getElementById("searchinput");
        var menus = document.getElementsByClassName("menu");
        for( var i=0; i<menus.length; i++ )
            menus[i].active = false;
        
        // Manage theme
        var theme="light";
        function switchTheme(type) {
            if( type == "dark" || ( ! type && theme == "light" ) ) {
                theme = "dark";
                document.documentElement.setAttribute('theme', 'dark');
                window.name = "dark_theme"
                localStorage.setItem("_theme","dark")
            } else {
                theme = "light";
                document.documentElement.setAttribute('theme', 'light');
                window.name = "light_theme"
                localStorage.setItem("_theme","light")
            }
        }
        if( window.name && window.name == "light_theme" ) {
            switchTheme("light");
        } else if ( window.name && window.name == "dark_theme" ) {
            switchTheme("dark");
        } else if( stored_theme = localStorage.getItem("_theme") ) {
            switchTheme(stored_theme);
        } else if( window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches) {
            switchTheme("dark");
        }
        
        var ul = nav_list.getElementsByTagName("ul")[0], li;
        var keep_nav = false;
        if( ul ) {
            li = ul.firstElementChild;
            if( li ) {
                if( li.getElementsByTagName("ul").length > 0 ) keep_nav = true;
            }
        }
        if( keep_nav ) {
            li.removeChild( li.firstElementChild );
        } else {
            document.getElementById("nav_positioner").removeChild( document.getElementById("nav") );
        }
        
        function navOff() {
            nav_list.style.display = "none";
            nav_button.className = "";
            nav.style.overflowY = "visible";
        }
        
        function toggleNav() {
            for( var i=0; i<menus.length; i++ )
                menuOff( menus[i] );
            if( nav_list.style.display != "inline-block" ) {
                nav_list.style.display = "inline-block";
                nav_button.className = "pushed";
                nav.style.overflowY = "auto";
            } else {
                navOff();
            }
        }
        
        function toggleSmallScreenMenu(e) {
            if( smallScreenMenu.className != "on" ) {
                smallScreenMenu.className = "on";
                smallScreenMenuButton.className = "pushed";
                document.documentElement.style.overflow = "hidden";
            } else {
                smallScreenMenu.className = "off";
                smallScreenMenuButton.className = "";
                document.documentElement.style.overflow = "";
            }
        }
        
        if (smallScreenMenuAfterTOC = document.getElementById("smallScreenMenuAfterTOC")) {
            var smallScreenMenuTOC = smallScreenMenuAfterTOC.previousElementSibling
                .getElementsByTagName("li")[0].getElementsByTagName("ul")[0].getElementsByTagName("li");
            for (var i = 0; i < smallScreenMenuTOC.length; i++) {
                if (smallScreenMenuTOC[i].tagName = "a") {
                    smallScreenMenuTOC[i].addEventListener("click", function(event){ toggleSmallScreenMenu(event); } );
                }
            }
        }
        
        function prepareMenu(menu_id) {
            var menu = document.getElementById(menu_id);
            menu.timer1 = setTimeout(function(a){ return function(){thisMenuOnly(a)};}(menu_id), 100);
            menu.addEventListener("mouseleave", function(a){ return function(){clearTimeout(a.timer1)};}(menu) );
        }
        
        function leaveMenu(menu_id, source) {
            var menu = document.getElementById(menu_id);
            menu.timer2 = setTimeout(function(a){ return function(){menuOff(a)};}(menu), 1000);
            source.addEventListener("mouseenter", function(a){ return function(){clearTimeout(a.timer2)};}(menu) );
        }
        
        function menuOn( menu ) {
            var divs = menu.getElementsByTagName("div");
            if(nav_list) navOff();
            divs[1].className = "on";
            divs[0].className = "menuButton pushed";
            menu.active = true;
        }
        function menuOff( menu ) {
            var divs = menu.getElementsByTagName("div");
            divs[1].className = "off";
            divs[0].className = "menuButton";
            menu.active = false;
        }
        
        function thisMenuOnly(menu_id) {
            var menu = document.getElementById(menu_id);
            for( var i=0; i<menus.length; i++ )
                if( i!=menu_id )
                    menuOff( menus[i] );
            menuOn( menu );
        }
        
        function toggleMenu(menu_id) {
            var menu = document.getElementById(menu_id);
            if( menu.active ) {
                menuOff( menu );
            } else {
                for( var i=0; i<menus.length; i++ )
                    if( i!=menu_id )
                        menuOff( menus[i] );
                menuOn( menu );
            }
        }
        
        function openSearch() {
            for( var i=0; i<menus.length; i++ ) {
                menuOff( menus[i] );
                menus[i].style.zIndex = "-1";
            }
            searchicon.style.display = "none";
            closesearchicon.style.display = "block";
            searchbox.style.display = "block";
            searchinput.focus();
        }
        
        function closeSearch() {
            searchicon.style.display = "block";
            closesearchicon.style.display = "none";
            searchbox .style.display = "none";
            for( var i=0; i<menus.length; i++ )
                menus[i].style.zIndex = "0";
        }
        
        
        var documentDiv = document.getElementsByClassName("document")[0];
        documentDiv.addEventListener('click', function (event) {
            if(nav_list) navOff();
            for( var i=0; i<menus.length; i++ )
                menuOff( menus[i] );
        });
    </script>
  </body>
</html>