<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Write a namelist &#8212; Smilei 5.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/smilei_theme.css?v=3908db80" />
    <script src="../_static/documentation_options.js?v=4af8989d"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="icon" href="../_static/smileiIcon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Run" href="run.html" />
    <link rel="prev" title="Install" href="installation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": {
      scale: 95,
      availableFonts: ["TeX"]
    }
  });
  </script>
   
  </head><body>

<div id="smallScreenMenu" class="off">

    
    <div class="toctree-smilei">
        <ul>
            <li class="outer">
                <a href="../Overview/synopsis.html">Synopsis</a>
            </li>
            <li class="outer">
                <a href="../Overview/highlights.html">Highlights</a>
            </li>
            <li class="outer">
                <a href="../Overview/releases.html">Releases</a>
            </li>
            <li class="outer">
                <a href="../Overview/licence.html">Licence</a>
            </li>
            <li class="outer">
                <a href="../Overview/material.html">Publications</a>
            </li>
            <li class="outer">
                <a href="../Overview/partners.html">Partners</a>
            </li>
        </ul>
        <hr />
        <ul>
            <li class="outer">
                <a href="../Understand/units.html">Units</a>
            </li>
            <li class="outer">
                <a href="../Understand/algorithms.html">PIC algorithms</a>
            </li>
            <li class="outer">
                <a href="../Understand/performances.html">Parallelization & optimization</a>
            </li>
            <li class="outer">
                <a href="../Understand/physics_modules.html">Physics modules</a>
            </li>
            <li class="outer">
                <a href="../Understand/numerical_techniques.html">Advanced numerical techniques</a>
            </li>
            <li class="outer">
                <a href="../Understand/PML.html">Perfectly Matched Layers</a>
            </li>
        </ul>
        <hr />
        <ul>
            <li class="outer">
                <a href="installation.html">Install</a>
            </li>
            <li class="outer">
                <a href="https://smileipic.github.io/tutorials">Smilei tutorials</a>
            </li>
        </ul>
                <ul>
<li><a class="reference internal" href="#">Write a namelist</a><ul>
<li><a class="reference internal" href="#general-rules">General rules</a></li>
<li><a class="reference internal" href="#python-workflow">Python workflow</a></li>
<li><a class="reference internal" href="#main-variables">Main variables</a><ul>
<li><a class="reference internal" href="#geometry"><code class="docutils literal notranslate"><span class="pre">geometry</span></code></a></li>
<li><a class="reference internal" href="#interpolation_order"><code class="docutils literal notranslate"><span class="pre">interpolation_order</span></code></a></li>
<li><a class="reference internal" href="#interpolator"><code class="docutils literal notranslate"><span class="pre">interpolator</span></code></a></li>
<li><a class="reference internal" href="#grid_length"><code class="docutils literal notranslate"><span class="pre">grid_length</span></code></a></li>
<li><a class="reference internal" href="#number_of_cells"><code class="docutils literal notranslate"><span class="pre">number_of_cells</span></code></a></li>
<li><a class="reference internal" href="#cell_length"><code class="docutils literal notranslate"><span class="pre">cell_length</span></code></a></li>
<li><a class="reference internal" href="#simulation_time"><code class="docutils literal notranslate"><span class="pre">simulation_time</span></code></a></li>
<li><a class="reference internal" href="#number_of_timesteps"><code class="docutils literal notranslate"><span class="pre">number_of_timesteps</span></code></a></li>
<li><a class="reference internal" href="#timestep"><code class="docutils literal notranslate"><span class="pre">timestep</span></code></a></li>
<li><a class="reference internal" href="#timestep_over_CFL"><code class="docutils literal notranslate"><span class="pre">timestep_over_CFL</span></code></a></li>
<li><a class="reference internal" href="#gpu_computing"><code class="docutils literal notranslate"><span class="pre">gpu_computing</span></code></a></li>
<li><a class="reference internal" href="#number_of_patches"><code class="docutils literal notranslate"><span class="pre">number_of_patches</span></code></a></li>
<li><a class="reference internal" href="#patch_arrangement"><code class="docutils literal notranslate"><span class="pre">patch_arrangement</span></code></a></li>
<li><a class="reference internal" href="#cluster_width"><code class="docutils literal notranslate"><span class="pre">cluster_width</span></code></a></li>
<li><a class="reference internal" href="#maxwell_solver"><code class="docutils literal notranslate"><span class="pre">maxwell_solver</span></code></a></li>
<li><a class="reference internal" href="#solve_poisson"><code class="docutils literal notranslate"><span class="pre">solve_poisson</span></code></a></li>
<li><a class="reference internal" href="#poisson_max_iteration"><code class="docutils literal notranslate"><span class="pre">poisson_max_iteration</span></code></a></li>
<li><a class="reference internal" href="#poisson_max_error"><code class="docutils literal notranslate"><span class="pre">poisson_max_error</span></code></a></li>
<li><a class="reference internal" href="#solve_relativistic_poisson"><code class="docutils literal notranslate"><span class="pre">solve_relativistic_poisson</span></code></a></li>
<li><a class="reference internal" href="#relativistic_poisson_max_iteration"><code class="docutils literal notranslate"><span class="pre">relativistic_poisson_max_iteration</span></code></a></li>
<li><a class="reference internal" href="#relativistic_poisson_max_error"><code class="docutils literal notranslate"><span class="pre">relativistic_poisson_max_error</span></code></a></li>
<li><a class="reference internal" href="#EM_boundary_conditions"><code class="docutils literal notranslate"><span class="pre">EM_boundary_conditions</span></code></a></li>
<li><a class="reference internal" href="#EM_boundary_conditions_k"><code class="docutils literal notranslate"><span class="pre">EM_boundary_conditions_k</span></code></a></li>
<li><a class="reference internal" href="#number_of_pml_cells"><code class="docutils literal notranslate"><span class="pre">number_of_pml_cells</span></code></a></li>
<li><a class="reference internal" href="#pml_sigma"><code class="docutils literal notranslate"><span class="pre">pml_sigma</span></code></a></li>
<li><a class="reference internal" href="#pml_kappa"><code class="docutils literal notranslate"><span class="pre">pml_kappa</span></code></a></li>
<li><a class="reference internal" href="#time_fields_frozen"><code class="docutils literal notranslate"><span class="pre">time_fields_frozen</span></code></a></li>
<li><a class="reference internal" href="#reference_angular_frequency_SI"><code class="docutils literal notranslate"><span class="pre">reference_angular_frequency_SI</span></code></a></li>
<li><a class="reference internal" href="#print_every"><code class="docutils literal notranslate"><span class="pre">print_every</span></code></a></li>
<li><a class="reference internal" href="#print_expected_disk_usage"><code class="docutils literal notranslate"><span class="pre">print_expected_disk_usage</span></code></a></li>
<li><a class="reference internal" href="#random_seed"><code class="docutils literal notranslate"><span class="pre">random_seed</span></code></a></li>
<li><a class="reference internal" href="#number_of_AM"><code class="docutils literal notranslate"><span class="pre">number_of_AM</span></code></a></li>
<li><a class="reference internal" href="#number_of_AM_classical_Poisson_solver"><code class="docutils literal notranslate"><span class="pre">number_of_AM_classical_Poisson_solver</span></code></a></li>
<li><a class="reference internal" href="#number_of_AM_relativistic_field_initialization"><code class="docutils literal notranslate"><span class="pre">number_of_AM_relativistic_field_initialization</span></code></a></li>
<li><a class="reference internal" href="#use_BTIS3_interpolation"><code class="docutils literal notranslate"><span class="pre">use_BTIS3_interpolation</span></code></a></li>
<li><a class="reference internal" href="#custom_oversize"><code class="docutils literal notranslate"><span class="pre">custom_oversize</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#load-balancing">Load Balancing</a><ul>
<li><a class="reference internal" href="#initial_balance"><code class="docutils literal notranslate"><span class="pre">initial_balance</span></code></a></li>
<li><a class="reference internal" href="#every"><code class="docutils literal notranslate"><span class="pre">every</span></code></a></li>
<li><a class="reference internal" href="#cell_load"><code class="docutils literal notranslate"><span class="pre">cell_load</span></code></a></li>
<li><a class="reference internal" href="#frozen_particle_load"><code class="docutils literal notranslate"><span class="pre">frozen_particle_load</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#multiple-decomposition-of-the-domain">Multiple decomposition of the domain</a><ul>
<li><a class="reference internal" href="#region_ghost_cells"><code class="docutils literal notranslate"><span class="pre">region_ghost_cells</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#vectorization">Vectorization</a><ul>
<li><a class="reference internal" href="#mode"><code class="docutils literal notranslate"><span class="pre">mode</span></code></a></li>
<li><a class="reference internal" href="#reconfigure_every"><code class="docutils literal notranslate"><span class="pre">reconfigure_every</span></code></a></li>
<li><a class="reference internal" href="#initial_mode"><code class="docutils literal notranslate"><span class="pre">initial_mode</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#moving-window">Moving window</a><ul>
<li><a class="reference internal" href="#time_start"><code class="docutils literal notranslate"><span class="pre">time_start</span></code></a></li>
<li><a class="reference internal" href="#velocity_x"><code class="docutils literal notranslate"><span class="pre">velocity_x</span></code></a></li>
<li><a class="reference internal" href="#number_of_additional_shifts"><code class="docutils literal notranslate"><span class="pre">number_of_additional_shifts</span></code></a></li>
<li><a class="reference internal" href="#additional_shifts_time"><code class="docutils literal notranslate"><span class="pre">additional_shifts_time</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#current-filtering">Current filtering</a><ul>
<li><a class="reference internal" href="#model"><code class="docutils literal notranslate"><span class="pre">model</span></code></a></li>
<li><a class="reference internal" href="#passes"><code class="docutils literal notranslate"><span class="pre">passes</span></code></a></li>
<li><a class="reference internal" href="#kernelFIR"><code class="docutils literal notranslate"><span class="pre">kernelFIR</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#field-filtering">Field filtering</a><ul>
<li><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">model</span></code></a></li>
<li><a class="reference internal" href="#theta"><code class="docutils literal notranslate"><span class="pre">theta</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#species">Species</a><ul>
<li><a class="reference internal" href="#name"><code class="docutils literal notranslate"><span class="pre">name</span></code></a></li>
<li><a class="reference internal" href="#position_initialization"><code class="docutils literal notranslate"><span class="pre">position_initialization</span></code></a></li>
<li><a class="reference internal" href="#regular_number"><code class="docutils literal notranslate"><span class="pre">regular_number</span></code></a></li>
<li><a class="reference internal" href="#momentum_initialization"><code class="docutils literal notranslate"><span class="pre">momentum_initialization</span></code></a></li>
<li><a class="reference internal" href="#particles_per_cell"><code class="docutils literal notranslate"><span class="pre">particles_per_cell</span></code></a></li>
<li><a class="reference internal" href="#mass"><code class="docutils literal notranslate"><span class="pre">mass</span></code></a></li>
<li><a class="reference internal" href="#atomic_number"><code class="docutils literal notranslate"><span class="pre">atomic_number</span></code></a></li>
<li><a class="reference internal" href="#maximum_charge_state"><code class="docutils literal notranslate"><span class="pre">maximum_charge_state</span></code></a></li>
<li><a class="reference internal" href="#number_density"><code class="docutils literal notranslate"><span class="pre">number_density</span></code></a></li>
<li><a class="reference internal" href="#charge_density"><code class="docutils literal notranslate"><span class="pre">charge_density</span></code></a></li>
<li><a class="reference internal" href="#charge"><code class="docutils literal notranslate"><span class="pre">charge</span></code></a></li>
<li><a class="reference internal" href="#mean_velocity"><code class="docutils literal notranslate"><span class="pre">mean_velocity</span></code></a></li>
<li><a class="reference internal" href="#mean_velocity_AM"><code class="docutils literal notranslate"><span class="pre">mean_velocity_AM</span></code></a></li>
<li><a class="reference internal" href="#temperature"><code class="docutils literal notranslate"><span class="pre">temperature</span></code></a></li>
<li><a class="reference internal" href="#boundary_conditions"><code class="docutils literal notranslate"><span class="pre">boundary_conditions</span></code></a></li>
<li><a class="reference internal" href="#thermal_boundary_temperature"><code class="docutils literal notranslate"><span class="pre">thermal_boundary_temperature</span></code></a></li>
<li><a class="reference internal" href="#thermal_boundary_velocity"><code class="docutils literal notranslate"><span class="pre">thermal_boundary_velocity</span></code></a></li>
<li><a class="reference internal" href="#time_frozen"><code class="docutils literal notranslate"><span class="pre">time_frozen</span></code></a></li>
<li><a class="reference internal" href="#ionization_model"><code class="docutils literal notranslate"><span class="pre">ionization_model</span></code></a></li>
<li><a class="reference internal" href="#bsi_model"><code class="docutils literal notranslate"><span class="pre">bsi_model</span></code></a></li>
<li><a class="reference internal" href="#ionization_rate"><code class="docutils literal notranslate"><span class="pre">ionization_rate</span></code></a></li>
<li><a class="reference internal" href="#ionization_electrons"><code class="docutils literal notranslate"><span class="pre">ionization_electrons</span></code></a></li>
<li><a class="reference internal" href="#is_test"><code class="docutils literal notranslate"><span class="pre">is_test</span></code></a></li>
<li><a class="reference internal" href="#pusher"><code class="docutils literal notranslate"><span class="pre">pusher</span></code></a></li>
<li><a class="reference internal" href="#radiation_model"><code class="docutils literal notranslate"><span class="pre">radiation_model</span></code></a></li>
<li><a class="reference internal" href="#radiation_photon_species"><code class="docutils literal notranslate"><span class="pre">radiation_photon_species</span></code></a></li>
<li><a class="reference internal" href="#radiation_photon_sampling"><code class="docutils literal notranslate"><span class="pre">radiation_photon_sampling</span></code></a></li>
<li><a class="reference internal" href="#radiation_max_emissions"><code class="docutils literal notranslate"><span class="pre">radiation_max_emissions</span></code></a></li>
<li><a class="reference internal" href="#radiation_photon_gamma_threshold"><code class="docutils literal notranslate"><span class="pre">radiation_photon_gamma_threshold</span></code></a></li>
<li><a class="reference internal" href="#relativistic_field_initialization"><code class="docutils literal notranslate"><span class="pre">relativistic_field_initialization</span></code></a></li>
<li><a class="reference internal" href="#multiphoton_Breit_Wheeler"><code class="docutils literal notranslate"><span class="pre">multiphoton_Breit_Wheeler</span></code></a></li>
<li><a class="reference internal" href="#multiphoton_Breit_Wheeler_sampling"><code class="docutils literal notranslate"><span class="pre">multiphoton_Breit_Wheeler_sampling</span></code></a></li>
<li><a class="reference internal" href="#keep_interpolated_fields"><code class="docutils literal notranslate"><span class="pre">keep_interpolated_fields</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#particle-injector">Particle Injector</a><ul>
<li><a class="reference internal" href="#id9"><code class="docutils literal notranslate"><span class="pre">name</span></code></a></li>
<li><a class="reference internal" href="#id10"><code class="docutils literal notranslate"><span class="pre">species</span></code></a></li>
<li><a class="reference internal" href="#box_side"><code class="docutils literal notranslate"><span class="pre">box_side</span></code></a></li>
<li><a class="reference internal" href="#time_envelope"><code class="docutils literal notranslate"><span class="pre">time_envelope</span></code></a></li>
<li><a class="reference internal" href="#id11"><code class="docutils literal notranslate"><span class="pre">position_initialization</span></code></a></li>
<li><a class="reference internal" href="#id12"><code class="docutils literal notranslate"><span class="pre">momentum_initialization</span></code></a></li>
<li><a class="reference internal" href="#id13"><code class="docutils literal notranslate"><span class="pre">mean_velocity</span></code></a></li>
<li><a class="reference internal" href="#id14"><code class="docutils literal notranslate"><span class="pre">temperature</span></code></a></li>
<li><a class="reference internal" href="#id15"><code class="docutils literal notranslate"><span class="pre">particles_per_cell</span></code></a></li>
<li><a class="reference internal" href="#id16"><code class="docutils literal notranslate"><span class="pre">number_density</span></code></a></li>
<li><a class="reference internal" href="#id17"><code class="docutils literal notranslate"><span class="pre">charge_density</span></code></a></li>
<li><a class="reference internal" href="#id18"><code class="docutils literal notranslate"><span class="pre">regular_number</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#particle-merging">Particle Merging</a><ul>
<li><a class="reference internal" href="#merging_method"><code class="docutils literal notranslate"><span class="pre">merging_method</span></code></a></li>
<li><a class="reference internal" href="#merge_every"><code class="docutils literal notranslate"><span class="pre">merge_every</span></code></a></li>
<li><a class="reference internal" href="#min_particles_per_cell"><code class="docutils literal notranslate"><span class="pre">min_particles_per_cell</span></code></a></li>
<li><a class="reference internal" href="#merge_min_packet_size"><code class="docutils literal notranslate"><span class="pre">merge_min_packet_size</span></code></a></li>
<li><a class="reference internal" href="#merge_max_packet_size"><code class="docutils literal notranslate"><span class="pre">merge_max_packet_size</span></code></a></li>
<li><a class="reference internal" href="#merge_momentum_cell_size"><code class="docutils literal notranslate"><span class="pre">merge_momentum_cell_size</span></code></a></li>
<li><a class="reference internal" href="#merge_discretization_scale"><code class="docutils literal notranslate"><span class="pre">merge_discretization_scale</span></code></a></li>
<li><a class="reference internal" href="#merge_min_momentum"><code class="docutils literal notranslate"><span class="pre">merge_min_momentum</span></code></a></li>
<li><a class="reference internal" href="#merge_min_momentum_cell_length"><code class="docutils literal notranslate"><span class="pre">merge_min_momentum_cell_length</span></code></a></li>
<li><a class="reference internal" href="#merge_accumulation_correction"><code class="docutils literal notranslate"><span class="pre">merge_accumulation_correction</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#lasers">Lasers</a><ul>
<li><a class="reference internal" href="#id21"><code class="docutils literal notranslate"><span class="pre">box_side</span></code></a></li>
<li><a class="reference internal" href="#space_time_profile"><code class="docutils literal notranslate"><span class="pre">space_time_profile</span></code></a></li>
<li><a class="reference internal" href="#space_time_profile_AM"><code class="docutils literal notranslate"><span class="pre">space_time_profile_AM</span></code></a></li>
<li><a class="reference internal" href="#omega"><code class="docutils literal notranslate"><span class="pre">omega</span></code></a></li>
<li><a class="reference internal" href="#chirp_profile"><code class="docutils literal notranslate"><span class="pre">chirp_profile</span></code></a></li>
<li><a class="reference internal" href="#id22"><code class="docutils literal notranslate"><span class="pre">time_envelope</span></code></a></li>
<li><a class="reference internal" href="#space_envelope"><code class="docutils literal notranslate"><span class="pre">space_envelope</span></code></a></li>
<li><a class="reference internal" href="#phase"><code class="docutils literal notranslate"><span class="pre">phase</span></code></a></li>
<li><a class="reference internal" href="#delay_phase"><code class="docutils literal notranslate"><span class="pre">delay_phase</span></code></a></li>
<li><a class="reference internal" href="#a0"><code class="docutils literal notranslate"><span class="pre">a0</span></code></a></li>
<li><a class="reference internal" href="#polarization_phi"><code class="docutils literal notranslate"><span class="pre">polarization_phi</span></code></a></li>
<li><a class="reference internal" href="#ellipticity"><code class="docutils literal notranslate"><span class="pre">ellipticity</span></code></a></li>
<li><a class="reference internal" href="#phase_offset"><code class="docutils literal notranslate"><span class="pre">phase_offset</span></code></a></li>
<li><a class="reference internal" href="#focus"><code class="docutils literal notranslate"><span class="pre">focus</span></code></a></li>
<li><a class="reference internal" href="#waist"><code class="docutils literal notranslate"><span class="pre">waist</span></code></a></li>
<li><a class="reference internal" href="#incidence_angle"><code class="docutils literal notranslate"><span class="pre">incidence_angle</span></code></a></li>
<li><a class="reference internal" href="#id23"><code class="docutils literal notranslate"><span class="pre">space_time_profile</span></code></a></li>
<li><a class="reference internal" href="#offset"><code class="docutils literal notranslate"><span class="pre">offset</span></code></a></li>
<li><a class="reference internal" href="#extra_envelope"><code class="docutils literal notranslate"><span class="pre">extra_envelope</span></code></a></li>
<li><a class="reference internal" href="#keep_n_strongest_modes"><code class="docutils literal notranslate"><span class="pre">keep_n_strongest_modes</span></code></a></li>
<li><a class="reference internal" href="#angle"><code class="docutils literal notranslate"><span class="pre">angle</span></code></a></li>
<li><a class="reference internal" href="#fft_time_window"><code class="docutils literal notranslate"><span class="pre">fft_time_window</span></code></a></li>
<li><a class="reference internal" href="#fft_time_step"><code class="docutils literal notranslate"><span class="pre">fft_time_step</span></code></a></li>
<li><a class="reference internal" href="#number_of_processes"><code class="docutils literal notranslate"><span class="pre">number_of_processes</span></code></a></li>
<li><a class="reference internal" href="#file"><code class="docutils literal notranslate"><span class="pre">file</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#laser-envelope-model">Laser envelope model</a><ul>
<li><a class="reference internal" href="#id24"><code class="docutils literal notranslate"><span class="pre">omega</span></code></a></li>
<li><a class="reference internal" href="#envelope_profile"><code class="docutils literal notranslate"><span class="pre">envelope_profile</span></code></a></li>
<li><a class="reference internal" href="#envelope_solver"><code class="docutils literal notranslate"><span class="pre">envelope_solver</span></code></a></li>
<li><a class="reference internal" href="#Envelope_boundary_conditions"><code class="docutils literal notranslate"><span class="pre">Envelope_boundary_conditions</span></code></a></li>
<li><a class="reference internal" href="#id25"><code class="docutils literal notranslate"><span class="pre">polarization_phi</span></code></a></li>
<li><a class="reference internal" href="#id26"><code class="docutils literal notranslate"><span class="pre">ellipticity</span></code></a></li>
<li><a class="reference internal" href="#id27"><code class="docutils literal notranslate"><span class="pre">time_envelope</span></code></a></li>
<li><a class="reference internal" href="#id28"><code class="docutils literal notranslate"><span class="pre">waist</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#external-fields">External fields</a><ul>
<li><a class="reference internal" href="#field"><code class="docutils literal notranslate"><span class="pre">field</span></code></a></li>
<li><a class="reference internal" href="#profile"><code class="docutils literal notranslate"><span class="pre">profile</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#prescribed-fields">Prescribed fields</a><ul>
<li><a class="reference internal" href="#id29"><code class="docutils literal notranslate"><span class="pre">field</span></code></a></li>
<li><a class="reference internal" href="#id30"><code class="docutils literal notranslate"><span class="pre">profile</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#antennas">Antennas</a><ul>
<li><a class="reference internal" href="#id32"><code class="docutils literal notranslate"><span class="pre">field</span></code></a></li>
<li><a class="reference internal" href="#space_profile"><code class="docutils literal notranslate"><span class="pre">space_profile</span></code></a></li>
<li><a class="reference internal" href="#time_profile"><code class="docutils literal notranslate"><span class="pre">time_profile</span></code></a></li>
<li><a class="reference internal" href="#id33"><code class="docutils literal notranslate"><span class="pre">space_time_profile</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#walls">Walls</a><ul>
<li><a class="reference internal" href="#kind"><code class="docutils literal notranslate"><span class="pre">kind</span></code></a></li>
<li><a class="reference internal" href="#x"><code class="docutils literal notranslate"><span class="pre">x</span></code></a></li>
<li><a class="reference internal" href="#y"><code class="docutils literal notranslate"><span class="pre">y</span></code></a></li>
<li><a class="reference internal" href="#z"><code class="docutils literal notranslate"><span class="pre">z</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#collisions-reactions">Collisions &amp; reactions</a><ul>
<li><a class="reference internal" href="#species1"><code class="docutils literal notranslate"><span class="pre">species1</span></code></a></li>
<li><a class="reference internal" href="#species2"><code class="docutils literal notranslate"><span class="pre">species2</span></code></a></li>
<li><a class="reference internal" href="#id34"><code class="docutils literal notranslate"><span class="pre">every</span></code></a></li>
<li><a class="reference internal" href="#debug_every"><code class="docutils literal notranslate"><span class="pre">debug_every</span></code></a></li>
<li><a class="reference internal" href="#id35"><code class="docutils literal notranslate"><span class="pre">time_frozen</span></code></a></li>
<li><a class="reference internal" href="#coulomb_log"><code class="docutils literal notranslate"><span class="pre">coulomb_log</span></code></a></li>
<li><a class="reference internal" href="#coulomb_log_factor"><code class="docutils literal notranslate"><span class="pre">coulomb_log_factor</span></code></a></li>
<li><a class="reference internal" href="#ionizing"><code class="docutils literal notranslate"><span class="pre">ionizing</span></code></a></li>
<li><a class="reference internal" href="#nuclear_reaction"><code class="docutils literal notranslate"><span class="pre">nuclear_reaction</span></code></a></li>
<li><a class="reference internal" href="#nuclear_reaction_multiplier"><code class="docutils literal notranslate"><span class="pre">nuclear_reaction_multiplier</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#radiation-reaction">Radiation reaction</a><ul>
<li><a class="reference internal" href="#minimum_chi_continuous"><code class="docutils literal notranslate"><span class="pre">minimum_chi_continuous</span></code></a></li>
<li><a class="reference internal" href="#minimum_chi_discontinuous"><code class="docutils literal notranslate"><span class="pre">minimum_chi_discontinuous</span></code></a></li>
<li><a class="reference internal" href="#table_path"><code class="docutils literal notranslate"><span class="pre">table_path</span></code></a></li>
<li><a class="reference internal" href="#Niel_computation_method"><code class="docutils literal notranslate"><span class="pre">Niel_computation_method</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#multiphoton-breit-wheeler">Multiphoton Breit-Wheeler</a><ul>
<li><a class="reference internal" href="#id36"><code class="docutils literal notranslate"><span class="pre">table_path</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#scalar-diagnostics"><em>Scalar</em> diagnostics</a><ul>
<li><a class="reference internal" href="#id37"><code class="docutils literal notranslate"><span class="pre">every</span></code></a></li>
<li><a class="reference internal" href="#vars"><code class="docutils literal notranslate"><span class="pre">vars</span></code></a></li>
<li><a class="reference internal" href="#precision"><code class="docutils literal notranslate"><span class="pre">precision</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fields-diagnostics"><em>Fields</em> diagnostics</a><ul>
<li><a class="reference internal" href="#id38"><code class="docutils literal notranslate"><span class="pre">name</span></code></a></li>
<li><a class="reference internal" href="#id39"><code class="docutils literal notranslate"><span class="pre">every</span></code></a></li>
<li><a class="reference internal" href="#flush_every"><code class="docutils literal notranslate"><span class="pre">flush_every</span></code></a></li>
<li><a class="reference internal" href="#time_average"><code class="docutils literal notranslate"><span class="pre">time_average</span></code></a></li>
<li><a class="reference internal" href="#fields"><code class="docutils literal notranslate"><span class="pre">fields</span></code></a></li>
<li><a class="reference internal" href="#subgrid"><code class="docutils literal notranslate"><span class="pre">subgrid</span></code></a></li>
<li><a class="reference internal" href="#datatype"><code class="docutils literal notranslate"><span class="pre">datatype</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#probe-diagnostics"><em>Probe</em> diagnostics</a><ul>
<li><a class="reference internal" href="#id40"><code class="docutils literal notranslate"><span class="pre">name</span></code></a></li>
<li><a class="reference internal" href="#id41"><code class="docutils literal notranslate"><span class="pre">every</span></code></a></li>
<li><a class="reference internal" href="#id42"><code class="docutils literal notranslate"><span class="pre">flush_every</span></code></a></li>
<li><a class="reference internal" href="#origin"><code class="docutils literal notranslate"><span class="pre">origin</span></code></a></li>
<li><a class="reference internal" href="#corners"><code class="docutils literal notranslate"><span class="pre">corners</span></code></a></li>
<li><a class="reference internal" href="#vectors"><code class="docutils literal notranslate"><span class="pre">vectors</span></code></a></li>
<li><a class="reference internal" href="#number"><code class="docutils literal notranslate"><span class="pre">number</span></code></a></li>
<li><a class="reference internal" href="#id43"><code class="docutils literal notranslate"><span class="pre">fields</span></code></a></li>
<li><a class="reference internal" href="#time_integral"><code class="docutils literal notranslate"><span class="pre">time_integral</span></code></a></li>
<li><a class="reference internal" href="#id44"><code class="docutils literal notranslate"><span class="pre">datatype</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#particlebinning-diagnostics"><em>ParticleBinning</em> diagnostics</a><ul>
<li><a class="reference internal" href="#id45"><code class="docutils literal notranslate"><span class="pre">name</span></code></a></li>
<li><a class="reference internal" href="#deposited_quantity"><code class="docutils literal notranslate"><span class="pre">deposited_quantity</span></code></a></li>
<li><a class="reference internal" href="#id46"><code class="docutils literal notranslate"><span class="pre">every</span></code></a></li>
<li><a class="reference internal" href="#id47"><code class="docutils literal notranslate"><span class="pre">flush_every</span></code></a></li>
<li><a class="reference internal" href="#id48"><code class="docutils literal notranslate"><span class="pre">time_average</span></code></a></li>
<li><a class="reference internal" href="#id49"><code class="docutils literal notranslate"><span class="pre">species</span></code></a></li>
<li><a class="reference internal" href="#axes"><code class="docutils literal notranslate"><span class="pre">axes</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#screen-diagnostics"><em>Screen</em> diagnostics</a><ul>
<li><a class="reference internal" href="#id50"><code class="docutils literal notranslate"><span class="pre">name</span></code></a></li>
<li><a class="reference internal" href="#shape"><code class="docutils literal notranslate"><span class="pre">shape</span></code></a></li>
<li><a class="reference internal" href="#point"><code class="docutils literal notranslate"><span class="pre">point</span></code></a></li>
<li><a class="reference internal" href="#vector"><code class="docutils literal notranslate"><span class="pre">vector</span></code></a></li>
<li><a class="reference internal" href="#direction"><code class="docutils literal notranslate"><span class="pre">direction</span></code></a></li>
<li><a class="reference internal" href="#id51"><code class="docutils literal notranslate"><span class="pre">deposited_quantity</span></code></a></li>
<li><a class="reference internal" href="#id52"><code class="docutils literal notranslate"><span class="pre">every</span></code></a></li>
<li><a class="reference internal" href="#id53"><code class="docutils literal notranslate"><span class="pre">flush_every</span></code></a></li>
<li><a class="reference internal" href="#id54"><code class="docutils literal notranslate"><span class="pre">species</span></code></a></li>
<li><a class="reference internal" href="#id55"><code class="docutils literal notranslate"><span class="pre">axes</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#radiationspectrum-diagnostics"><em>RadiationSpectrum</em> diagnostics</a><ul>
<li><a class="reference internal" href="#id56"><code class="docutils literal notranslate"><span class="pre">name</span></code></a></li>
<li><a class="reference internal" href="#id57"><code class="docutils literal notranslate"><span class="pre">every</span></code></a></li>
<li><a class="reference internal" href="#id58"><code class="docutils literal notranslate"><span class="pre">flush_every</span></code></a></li>
<li><a class="reference internal" href="#id59"><code class="docutils literal notranslate"><span class="pre">time_average</span></code></a></li>
<li><a class="reference internal" href="#id60"><code class="docutils literal notranslate"><span class="pre">species</span></code></a></li>
<li><a class="reference internal" href="#photon_energy_axis"><code class="docutils literal notranslate"><span class="pre">photon_energy_axis</span></code></a></li>
<li><a class="reference internal" href="#id61"><code class="docutils literal notranslate"><span class="pre">axes</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#trackparticles-diagnostics"><em>TrackParticles</em> diagnostics</a><ul>
<li><a class="reference internal" href="#id62"><code class="docutils literal notranslate"><span class="pre">species</span></code></a></li>
<li><a class="reference internal" href="#id63"><code class="docutils literal notranslate"><span class="pre">every</span></code></a></li>
<li><a class="reference internal" href="#id64"><code class="docutils literal notranslate"><span class="pre">flush_every</span></code></a></li>
<li><a class="reference internal" href="#filter"><code class="docutils literal notranslate"><span class="pre">filter</span></code></a></li>
<li><a class="reference internal" href="#attributes"><code class="docutils literal notranslate"><span class="pre">attributes</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#newparticles-diagnostics"><em>NewParticles</em> diagnostics</a></li>
<li><a class="reference internal" href="#performances-diagnostics"><em>Performances</em> diagnostics</a><ul>
<li><a class="reference internal" href="#id66"><code class="docutils literal notranslate"><span class="pre">every</span></code></a></li>
<li><a class="reference internal" href="#id67"><code class="docutils literal notranslate"><span class="pre">flush_every</span></code></a></li>
<li><a class="reference internal" href="#patch_information"><code class="docutils literal notranslate"><span class="pre">patch_information</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#time-selections">Time selections</a></li>
<li><a class="reference internal" href="#profiles">Profiles</a></li>
<li><a class="reference internal" href="#checkpoints">Checkpoints</a><ul>
<li><a class="reference internal" href="#dump_step"><code class="docutils literal notranslate"><span class="pre">dump_step</span></code></a></li>
<li><a class="reference internal" href="#dump_minutes"><code class="docutils literal notranslate"><span class="pre">dump_minutes</span></code></a></li>
<li><a class="reference internal" href="#exit_after_dump"><code class="docutils literal notranslate"><span class="pre">exit_after_dump</span></code></a></li>
<li><a class="reference internal" href="#keep_n_dumps"><code class="docutils literal notranslate"><span class="pre">keep_n_dumps</span></code></a></li>
<li><a class="reference internal" href="#file_grouping"><code class="docutils literal notranslate"><span class="pre">file_grouping</span></code></a></li>
<li><a class="reference internal" href="#dump_deflate"><code class="docutils literal notranslate"><span class="pre">dump_deflate</span></code></a></li>
<li><a class="reference internal" href="#restart_dir"><code class="docutils literal notranslate"><span class="pre">restart_dir</span></code></a></li>
<li><a class="reference internal" href="#restart_number"><code class="docutils literal notranslate"><span class="pre">restart_number</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#variables-defined-by-smilei">Variables defined by Smilei</a><ul>
<li><a class="reference internal" href="#smilei_mpi_rank"><code class="docutils literal notranslate"><span class="pre">smilei_mpi_rank</span></code></a></li>
<li><a class="reference internal" href="#smilei_mpi_size"><code class="docutils literal notranslate"><span class="pre">smilei_mpi_size</span></code></a></li>
<li><a class="reference internal" href="#smilei_omp_threads"><code class="docutils literal notranslate"><span class="pre">smilei_omp_threads</span></code></a></li>
<li><a class="reference internal" href="#smilei_total_cores"><code class="docutils literal notranslate"><span class="pre">smilei_total_cores</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        <ul id="smallScreenMenuAfterTOC">
            <li class="outer">
                <a href="run.html">Run</a>
            </li>
            <li class="outer">
                <a href="post-processing.html">Post-process</a>
            </li>
            <li class="outer">
                <a href="contribute.html">Contribute</a>
            </li>
            <li class="outer">
                <a href="troubleshoot.html">Troubleshoot</a>
            </li>
            <li class="outer">
                <a href="GPU_version.html">GPU version</a>
            </li>
        </ul>
        <hr />
    </div>

</div>
<div id="hcontainer">
    <div id="nav_positioner">
        <div id="nav">
            <div id="nav_button" onclick="toggleNav()">
                Sections
            </div>
            <div id="nav_list" class="toctree-smilei">
                <div id="nav_title"><a href="#">Write a namelist</a></div>
                <ul>
<li><a class="reference internal" href="#">Write a namelist</a><ul>
<li><a class="reference internal" href="#general-rules">General rules</a></li>
<li><a class="reference internal" href="#python-workflow">Python workflow</a></li>
<li><a class="reference internal" href="#main-variables">Main variables</a><ul>
<li><a class="reference internal" href="#geometry"><code class="docutils literal notranslate"><span class="pre">geometry</span></code></a></li>
<li><a class="reference internal" href="#interpolation_order"><code class="docutils literal notranslate"><span class="pre">interpolation_order</span></code></a></li>
<li><a class="reference internal" href="#interpolator"><code class="docutils literal notranslate"><span class="pre">interpolator</span></code></a></li>
<li><a class="reference internal" href="#grid_length"><code class="docutils literal notranslate"><span class="pre">grid_length</span></code></a></li>
<li><a class="reference internal" href="#number_of_cells"><code class="docutils literal notranslate"><span class="pre">number_of_cells</span></code></a></li>
<li><a class="reference internal" href="#cell_length"><code class="docutils literal notranslate"><span class="pre">cell_length</span></code></a></li>
<li><a class="reference internal" href="#simulation_time"><code class="docutils literal notranslate"><span class="pre">simulation_time</span></code></a></li>
<li><a class="reference internal" href="#number_of_timesteps"><code class="docutils literal notranslate"><span class="pre">number_of_timesteps</span></code></a></li>
<li><a class="reference internal" href="#timestep"><code class="docutils literal notranslate"><span class="pre">timestep</span></code></a></li>
<li><a class="reference internal" href="#timestep_over_CFL"><code class="docutils literal notranslate"><span class="pre">timestep_over_CFL</span></code></a></li>
<li><a class="reference internal" href="#gpu_computing"><code class="docutils literal notranslate"><span class="pre">gpu_computing</span></code></a></li>
<li><a class="reference internal" href="#number_of_patches"><code class="docutils literal notranslate"><span class="pre">number_of_patches</span></code></a></li>
<li><a class="reference internal" href="#patch_arrangement"><code class="docutils literal notranslate"><span class="pre">patch_arrangement</span></code></a></li>
<li><a class="reference internal" href="#cluster_width"><code class="docutils literal notranslate"><span class="pre">cluster_width</span></code></a></li>
<li><a class="reference internal" href="#maxwell_solver"><code class="docutils literal notranslate"><span class="pre">maxwell_solver</span></code></a></li>
<li><a class="reference internal" href="#solve_poisson"><code class="docutils literal notranslate"><span class="pre">solve_poisson</span></code></a></li>
<li><a class="reference internal" href="#poisson_max_iteration"><code class="docutils literal notranslate"><span class="pre">poisson_max_iteration</span></code></a></li>
<li><a class="reference internal" href="#poisson_max_error"><code class="docutils literal notranslate"><span class="pre">poisson_max_error</span></code></a></li>
<li><a class="reference internal" href="#solve_relativistic_poisson"><code class="docutils literal notranslate"><span class="pre">solve_relativistic_poisson</span></code></a></li>
<li><a class="reference internal" href="#relativistic_poisson_max_iteration"><code class="docutils literal notranslate"><span class="pre">relativistic_poisson_max_iteration</span></code></a></li>
<li><a class="reference internal" href="#relativistic_poisson_max_error"><code class="docutils literal notranslate"><span class="pre">relativistic_poisson_max_error</span></code></a></li>
<li><a class="reference internal" href="#EM_boundary_conditions"><code class="docutils literal notranslate"><span class="pre">EM_boundary_conditions</span></code></a></li>
<li><a class="reference internal" href="#EM_boundary_conditions_k"><code class="docutils literal notranslate"><span class="pre">EM_boundary_conditions_k</span></code></a></li>
<li><a class="reference internal" href="#number_of_pml_cells"><code class="docutils literal notranslate"><span class="pre">number_of_pml_cells</span></code></a></li>
<li><a class="reference internal" href="#pml_sigma"><code class="docutils literal notranslate"><span class="pre">pml_sigma</span></code></a></li>
<li><a class="reference internal" href="#pml_kappa"><code class="docutils literal notranslate"><span class="pre">pml_kappa</span></code></a></li>
<li><a class="reference internal" href="#time_fields_frozen"><code class="docutils literal notranslate"><span class="pre">time_fields_frozen</span></code></a></li>
<li><a class="reference internal" href="#reference_angular_frequency_SI"><code class="docutils literal notranslate"><span class="pre">reference_angular_frequency_SI</span></code></a></li>
<li><a class="reference internal" href="#print_every"><code class="docutils literal notranslate"><span class="pre">print_every</span></code></a></li>
<li><a class="reference internal" href="#print_expected_disk_usage"><code class="docutils literal notranslate"><span class="pre">print_expected_disk_usage</span></code></a></li>
<li><a class="reference internal" href="#random_seed"><code class="docutils literal notranslate"><span class="pre">random_seed</span></code></a></li>
<li><a class="reference internal" href="#number_of_AM"><code class="docutils literal notranslate"><span class="pre">number_of_AM</span></code></a></li>
<li><a class="reference internal" href="#number_of_AM_classical_Poisson_solver"><code class="docutils literal notranslate"><span class="pre">number_of_AM_classical_Poisson_solver</span></code></a></li>
<li><a class="reference internal" href="#number_of_AM_relativistic_field_initialization"><code class="docutils literal notranslate"><span class="pre">number_of_AM_relativistic_field_initialization</span></code></a></li>
<li><a class="reference internal" href="#use_BTIS3_interpolation"><code class="docutils literal notranslate"><span class="pre">use_BTIS3_interpolation</span></code></a></li>
<li><a class="reference internal" href="#custom_oversize"><code class="docutils literal notranslate"><span class="pre">custom_oversize</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#load-balancing">Load Balancing</a><ul>
<li><a class="reference internal" href="#initial_balance"><code class="docutils literal notranslate"><span class="pre">initial_balance</span></code></a></li>
<li><a class="reference internal" href="#every"><code class="docutils literal notranslate"><span class="pre">every</span></code></a></li>
<li><a class="reference internal" href="#cell_load"><code class="docutils literal notranslate"><span class="pre">cell_load</span></code></a></li>
<li><a class="reference internal" href="#frozen_particle_load"><code class="docutils literal notranslate"><span class="pre">frozen_particle_load</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#multiple-decomposition-of-the-domain">Multiple decomposition of the domain</a><ul>
<li><a class="reference internal" href="#region_ghost_cells"><code class="docutils literal notranslate"><span class="pre">region_ghost_cells</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#vectorization">Vectorization</a><ul>
<li><a class="reference internal" href="#mode"><code class="docutils literal notranslate"><span class="pre">mode</span></code></a></li>
<li><a class="reference internal" href="#reconfigure_every"><code class="docutils literal notranslate"><span class="pre">reconfigure_every</span></code></a></li>
<li><a class="reference internal" href="#initial_mode"><code class="docutils literal notranslate"><span class="pre">initial_mode</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#moving-window">Moving window</a><ul>
<li><a class="reference internal" href="#time_start"><code class="docutils literal notranslate"><span class="pre">time_start</span></code></a></li>
<li><a class="reference internal" href="#velocity_x"><code class="docutils literal notranslate"><span class="pre">velocity_x</span></code></a></li>
<li><a class="reference internal" href="#number_of_additional_shifts"><code class="docutils literal notranslate"><span class="pre">number_of_additional_shifts</span></code></a></li>
<li><a class="reference internal" href="#additional_shifts_time"><code class="docutils literal notranslate"><span class="pre">additional_shifts_time</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#current-filtering">Current filtering</a><ul>
<li><a class="reference internal" href="#model"><code class="docutils literal notranslate"><span class="pre">model</span></code></a></li>
<li><a class="reference internal" href="#passes"><code class="docutils literal notranslate"><span class="pre">passes</span></code></a></li>
<li><a class="reference internal" href="#kernelFIR"><code class="docutils literal notranslate"><span class="pre">kernelFIR</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#field-filtering">Field filtering</a><ul>
<li><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">model</span></code></a></li>
<li><a class="reference internal" href="#theta"><code class="docutils literal notranslate"><span class="pre">theta</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#species">Species</a><ul>
<li><a class="reference internal" href="#name"><code class="docutils literal notranslate"><span class="pre">name</span></code></a></li>
<li><a class="reference internal" href="#position_initialization"><code class="docutils literal notranslate"><span class="pre">position_initialization</span></code></a></li>
<li><a class="reference internal" href="#regular_number"><code class="docutils literal notranslate"><span class="pre">regular_number</span></code></a></li>
<li><a class="reference internal" href="#momentum_initialization"><code class="docutils literal notranslate"><span class="pre">momentum_initialization</span></code></a></li>
<li><a class="reference internal" href="#particles_per_cell"><code class="docutils literal notranslate"><span class="pre">particles_per_cell</span></code></a></li>
<li><a class="reference internal" href="#mass"><code class="docutils literal notranslate"><span class="pre">mass</span></code></a></li>
<li><a class="reference internal" href="#atomic_number"><code class="docutils literal notranslate"><span class="pre">atomic_number</span></code></a></li>
<li><a class="reference internal" href="#maximum_charge_state"><code class="docutils literal notranslate"><span class="pre">maximum_charge_state</span></code></a></li>
<li><a class="reference internal" href="#number_density"><code class="docutils literal notranslate"><span class="pre">number_density</span></code></a></li>
<li><a class="reference internal" href="#charge_density"><code class="docutils literal notranslate"><span class="pre">charge_density</span></code></a></li>
<li><a class="reference internal" href="#charge"><code class="docutils literal notranslate"><span class="pre">charge</span></code></a></li>
<li><a class="reference internal" href="#mean_velocity"><code class="docutils literal notranslate"><span class="pre">mean_velocity</span></code></a></li>
<li><a class="reference internal" href="#mean_velocity_AM"><code class="docutils literal notranslate"><span class="pre">mean_velocity_AM</span></code></a></li>
<li><a class="reference internal" href="#temperature"><code class="docutils literal notranslate"><span class="pre">temperature</span></code></a></li>
<li><a class="reference internal" href="#boundary_conditions"><code class="docutils literal notranslate"><span class="pre">boundary_conditions</span></code></a></li>
<li><a class="reference internal" href="#thermal_boundary_temperature"><code class="docutils literal notranslate"><span class="pre">thermal_boundary_temperature</span></code></a></li>
<li><a class="reference internal" href="#thermal_boundary_velocity"><code class="docutils literal notranslate"><span class="pre">thermal_boundary_velocity</span></code></a></li>
<li><a class="reference internal" href="#time_frozen"><code class="docutils literal notranslate"><span class="pre">time_frozen</span></code></a></li>
<li><a class="reference internal" href="#ionization_model"><code class="docutils literal notranslate"><span class="pre">ionization_model</span></code></a></li>
<li><a class="reference internal" href="#bsi_model"><code class="docutils literal notranslate"><span class="pre">bsi_model</span></code></a></li>
<li><a class="reference internal" href="#ionization_rate"><code class="docutils literal notranslate"><span class="pre">ionization_rate</span></code></a></li>
<li><a class="reference internal" href="#ionization_electrons"><code class="docutils literal notranslate"><span class="pre">ionization_electrons</span></code></a></li>
<li><a class="reference internal" href="#is_test"><code class="docutils literal notranslate"><span class="pre">is_test</span></code></a></li>
<li><a class="reference internal" href="#pusher"><code class="docutils literal notranslate"><span class="pre">pusher</span></code></a></li>
<li><a class="reference internal" href="#radiation_model"><code class="docutils literal notranslate"><span class="pre">radiation_model</span></code></a></li>
<li><a class="reference internal" href="#radiation_photon_species"><code class="docutils literal notranslate"><span class="pre">radiation_photon_species</span></code></a></li>
<li><a class="reference internal" href="#radiation_photon_sampling"><code class="docutils literal notranslate"><span class="pre">radiation_photon_sampling</span></code></a></li>
<li><a class="reference internal" href="#radiation_max_emissions"><code class="docutils literal notranslate"><span class="pre">radiation_max_emissions</span></code></a></li>
<li><a class="reference internal" href="#radiation_photon_gamma_threshold"><code class="docutils literal notranslate"><span class="pre">radiation_photon_gamma_threshold</span></code></a></li>
<li><a class="reference internal" href="#relativistic_field_initialization"><code class="docutils literal notranslate"><span class="pre">relativistic_field_initialization</span></code></a></li>
<li><a class="reference internal" href="#multiphoton_Breit_Wheeler"><code class="docutils literal notranslate"><span class="pre">multiphoton_Breit_Wheeler</span></code></a></li>
<li><a class="reference internal" href="#multiphoton_Breit_Wheeler_sampling"><code class="docutils literal notranslate"><span class="pre">multiphoton_Breit_Wheeler_sampling</span></code></a></li>
<li><a class="reference internal" href="#keep_interpolated_fields"><code class="docutils literal notranslate"><span class="pre">keep_interpolated_fields</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#particle-injector">Particle Injector</a><ul>
<li><a class="reference internal" href="#id9"><code class="docutils literal notranslate"><span class="pre">name</span></code></a></li>
<li><a class="reference internal" href="#id10"><code class="docutils literal notranslate"><span class="pre">species</span></code></a></li>
<li><a class="reference internal" href="#box_side"><code class="docutils literal notranslate"><span class="pre">box_side</span></code></a></li>
<li><a class="reference internal" href="#time_envelope"><code class="docutils literal notranslate"><span class="pre">time_envelope</span></code></a></li>
<li><a class="reference internal" href="#id11"><code class="docutils literal notranslate"><span class="pre">position_initialization</span></code></a></li>
<li><a class="reference internal" href="#id12"><code class="docutils literal notranslate"><span class="pre">momentum_initialization</span></code></a></li>
<li><a class="reference internal" href="#id13"><code class="docutils literal notranslate"><span class="pre">mean_velocity</span></code></a></li>
<li><a class="reference internal" href="#id14"><code class="docutils literal notranslate"><span class="pre">temperature</span></code></a></li>
<li><a class="reference internal" href="#id15"><code class="docutils literal notranslate"><span class="pre">particles_per_cell</span></code></a></li>
<li><a class="reference internal" href="#id16"><code class="docutils literal notranslate"><span class="pre">number_density</span></code></a></li>
<li><a class="reference internal" href="#id17"><code class="docutils literal notranslate"><span class="pre">charge_density</span></code></a></li>
<li><a class="reference internal" href="#id18"><code class="docutils literal notranslate"><span class="pre">regular_number</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#particle-merging">Particle Merging</a><ul>
<li><a class="reference internal" href="#merging_method"><code class="docutils literal notranslate"><span class="pre">merging_method</span></code></a></li>
<li><a class="reference internal" href="#merge_every"><code class="docutils literal notranslate"><span class="pre">merge_every</span></code></a></li>
<li><a class="reference internal" href="#min_particles_per_cell"><code class="docutils literal notranslate"><span class="pre">min_particles_per_cell</span></code></a></li>
<li><a class="reference internal" href="#merge_min_packet_size"><code class="docutils literal notranslate"><span class="pre">merge_min_packet_size</span></code></a></li>
<li><a class="reference internal" href="#merge_max_packet_size"><code class="docutils literal notranslate"><span class="pre">merge_max_packet_size</span></code></a></li>
<li><a class="reference internal" href="#merge_momentum_cell_size"><code class="docutils literal notranslate"><span class="pre">merge_momentum_cell_size</span></code></a></li>
<li><a class="reference internal" href="#merge_discretization_scale"><code class="docutils literal notranslate"><span class="pre">merge_discretization_scale</span></code></a></li>
<li><a class="reference internal" href="#merge_min_momentum"><code class="docutils literal notranslate"><span class="pre">merge_min_momentum</span></code></a></li>
<li><a class="reference internal" href="#merge_min_momentum_cell_length"><code class="docutils literal notranslate"><span class="pre">merge_min_momentum_cell_length</span></code></a></li>
<li><a class="reference internal" href="#merge_accumulation_correction"><code class="docutils literal notranslate"><span class="pre">merge_accumulation_correction</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#lasers">Lasers</a><ul>
<li><a class="reference internal" href="#id21"><code class="docutils literal notranslate"><span class="pre">box_side</span></code></a></li>
<li><a class="reference internal" href="#space_time_profile"><code class="docutils literal notranslate"><span class="pre">space_time_profile</span></code></a></li>
<li><a class="reference internal" href="#space_time_profile_AM"><code class="docutils literal notranslate"><span class="pre">space_time_profile_AM</span></code></a></li>
<li><a class="reference internal" href="#omega"><code class="docutils literal notranslate"><span class="pre">omega</span></code></a></li>
<li><a class="reference internal" href="#chirp_profile"><code class="docutils literal notranslate"><span class="pre">chirp_profile</span></code></a></li>
<li><a class="reference internal" href="#id22"><code class="docutils literal notranslate"><span class="pre">time_envelope</span></code></a></li>
<li><a class="reference internal" href="#space_envelope"><code class="docutils literal notranslate"><span class="pre">space_envelope</span></code></a></li>
<li><a class="reference internal" href="#phase"><code class="docutils literal notranslate"><span class="pre">phase</span></code></a></li>
<li><a class="reference internal" href="#delay_phase"><code class="docutils literal notranslate"><span class="pre">delay_phase</span></code></a></li>
<li><a class="reference internal" href="#a0"><code class="docutils literal notranslate"><span class="pre">a0</span></code></a></li>
<li><a class="reference internal" href="#polarization_phi"><code class="docutils literal notranslate"><span class="pre">polarization_phi</span></code></a></li>
<li><a class="reference internal" href="#ellipticity"><code class="docutils literal notranslate"><span class="pre">ellipticity</span></code></a></li>
<li><a class="reference internal" href="#phase_offset"><code class="docutils literal notranslate"><span class="pre">phase_offset</span></code></a></li>
<li><a class="reference internal" href="#focus"><code class="docutils literal notranslate"><span class="pre">focus</span></code></a></li>
<li><a class="reference internal" href="#waist"><code class="docutils literal notranslate"><span class="pre">waist</span></code></a></li>
<li><a class="reference internal" href="#incidence_angle"><code class="docutils literal notranslate"><span class="pre">incidence_angle</span></code></a></li>
<li><a class="reference internal" href="#id23"><code class="docutils literal notranslate"><span class="pre">space_time_profile</span></code></a></li>
<li><a class="reference internal" href="#offset"><code class="docutils literal notranslate"><span class="pre">offset</span></code></a></li>
<li><a class="reference internal" href="#extra_envelope"><code class="docutils literal notranslate"><span class="pre">extra_envelope</span></code></a></li>
<li><a class="reference internal" href="#keep_n_strongest_modes"><code class="docutils literal notranslate"><span class="pre">keep_n_strongest_modes</span></code></a></li>
<li><a class="reference internal" href="#angle"><code class="docutils literal notranslate"><span class="pre">angle</span></code></a></li>
<li><a class="reference internal" href="#fft_time_window"><code class="docutils literal notranslate"><span class="pre">fft_time_window</span></code></a></li>
<li><a class="reference internal" href="#fft_time_step"><code class="docutils literal notranslate"><span class="pre">fft_time_step</span></code></a></li>
<li><a class="reference internal" href="#number_of_processes"><code class="docutils literal notranslate"><span class="pre">number_of_processes</span></code></a></li>
<li><a class="reference internal" href="#file"><code class="docutils literal notranslate"><span class="pre">file</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#laser-envelope-model">Laser envelope model</a><ul>
<li><a class="reference internal" href="#id24"><code class="docutils literal notranslate"><span class="pre">omega</span></code></a></li>
<li><a class="reference internal" href="#envelope_profile"><code class="docutils literal notranslate"><span class="pre">envelope_profile</span></code></a></li>
<li><a class="reference internal" href="#envelope_solver"><code class="docutils literal notranslate"><span class="pre">envelope_solver</span></code></a></li>
<li><a class="reference internal" href="#Envelope_boundary_conditions"><code class="docutils literal notranslate"><span class="pre">Envelope_boundary_conditions</span></code></a></li>
<li><a class="reference internal" href="#id25"><code class="docutils literal notranslate"><span class="pre">polarization_phi</span></code></a></li>
<li><a class="reference internal" href="#id26"><code class="docutils literal notranslate"><span class="pre">ellipticity</span></code></a></li>
<li><a class="reference internal" href="#id27"><code class="docutils literal notranslate"><span class="pre">time_envelope</span></code></a></li>
<li><a class="reference internal" href="#id28"><code class="docutils literal notranslate"><span class="pre">waist</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#external-fields">External fields</a><ul>
<li><a class="reference internal" href="#field"><code class="docutils literal notranslate"><span class="pre">field</span></code></a></li>
<li><a class="reference internal" href="#profile"><code class="docutils literal notranslate"><span class="pre">profile</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#prescribed-fields">Prescribed fields</a><ul>
<li><a class="reference internal" href="#id29"><code class="docutils literal notranslate"><span class="pre">field</span></code></a></li>
<li><a class="reference internal" href="#id30"><code class="docutils literal notranslate"><span class="pre">profile</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#antennas">Antennas</a><ul>
<li><a class="reference internal" href="#id32"><code class="docutils literal notranslate"><span class="pre">field</span></code></a></li>
<li><a class="reference internal" href="#space_profile"><code class="docutils literal notranslate"><span class="pre">space_profile</span></code></a></li>
<li><a class="reference internal" href="#time_profile"><code class="docutils literal notranslate"><span class="pre">time_profile</span></code></a></li>
<li><a class="reference internal" href="#id33"><code class="docutils literal notranslate"><span class="pre">space_time_profile</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#walls">Walls</a><ul>
<li><a class="reference internal" href="#kind"><code class="docutils literal notranslate"><span class="pre">kind</span></code></a></li>
<li><a class="reference internal" href="#x"><code class="docutils literal notranslate"><span class="pre">x</span></code></a></li>
<li><a class="reference internal" href="#y"><code class="docutils literal notranslate"><span class="pre">y</span></code></a></li>
<li><a class="reference internal" href="#z"><code class="docutils literal notranslate"><span class="pre">z</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#collisions-reactions">Collisions &amp; reactions</a><ul>
<li><a class="reference internal" href="#species1"><code class="docutils literal notranslate"><span class="pre">species1</span></code></a></li>
<li><a class="reference internal" href="#species2"><code class="docutils literal notranslate"><span class="pre">species2</span></code></a></li>
<li><a class="reference internal" href="#id34"><code class="docutils literal notranslate"><span class="pre">every</span></code></a></li>
<li><a class="reference internal" href="#debug_every"><code class="docutils literal notranslate"><span class="pre">debug_every</span></code></a></li>
<li><a class="reference internal" href="#id35"><code class="docutils literal notranslate"><span class="pre">time_frozen</span></code></a></li>
<li><a class="reference internal" href="#coulomb_log"><code class="docutils literal notranslate"><span class="pre">coulomb_log</span></code></a></li>
<li><a class="reference internal" href="#coulomb_log_factor"><code class="docutils literal notranslate"><span class="pre">coulomb_log_factor</span></code></a></li>
<li><a class="reference internal" href="#ionizing"><code class="docutils literal notranslate"><span class="pre">ionizing</span></code></a></li>
<li><a class="reference internal" href="#nuclear_reaction"><code class="docutils literal notranslate"><span class="pre">nuclear_reaction</span></code></a></li>
<li><a class="reference internal" href="#nuclear_reaction_multiplier"><code class="docutils literal notranslate"><span class="pre">nuclear_reaction_multiplier</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#radiation-reaction">Radiation reaction</a><ul>
<li><a class="reference internal" href="#minimum_chi_continuous"><code class="docutils literal notranslate"><span class="pre">minimum_chi_continuous</span></code></a></li>
<li><a class="reference internal" href="#minimum_chi_discontinuous"><code class="docutils literal notranslate"><span class="pre">minimum_chi_discontinuous</span></code></a></li>
<li><a class="reference internal" href="#table_path"><code class="docutils literal notranslate"><span class="pre">table_path</span></code></a></li>
<li><a class="reference internal" href="#Niel_computation_method"><code class="docutils literal notranslate"><span class="pre">Niel_computation_method</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#multiphoton-breit-wheeler">Multiphoton Breit-Wheeler</a><ul>
<li><a class="reference internal" href="#id36"><code class="docutils literal notranslate"><span class="pre">table_path</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#scalar-diagnostics"><em>Scalar</em> diagnostics</a><ul>
<li><a class="reference internal" href="#id37"><code class="docutils literal notranslate"><span class="pre">every</span></code></a></li>
<li><a class="reference internal" href="#vars"><code class="docutils literal notranslate"><span class="pre">vars</span></code></a></li>
<li><a class="reference internal" href="#precision"><code class="docutils literal notranslate"><span class="pre">precision</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#fields-diagnostics"><em>Fields</em> diagnostics</a><ul>
<li><a class="reference internal" href="#id38"><code class="docutils literal notranslate"><span class="pre">name</span></code></a></li>
<li><a class="reference internal" href="#id39"><code class="docutils literal notranslate"><span class="pre">every</span></code></a></li>
<li><a class="reference internal" href="#flush_every"><code class="docutils literal notranslate"><span class="pre">flush_every</span></code></a></li>
<li><a class="reference internal" href="#time_average"><code class="docutils literal notranslate"><span class="pre">time_average</span></code></a></li>
<li><a class="reference internal" href="#fields"><code class="docutils literal notranslate"><span class="pre">fields</span></code></a></li>
<li><a class="reference internal" href="#subgrid"><code class="docutils literal notranslate"><span class="pre">subgrid</span></code></a></li>
<li><a class="reference internal" href="#datatype"><code class="docutils literal notranslate"><span class="pre">datatype</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#probe-diagnostics"><em>Probe</em> diagnostics</a><ul>
<li><a class="reference internal" href="#id40"><code class="docutils literal notranslate"><span class="pre">name</span></code></a></li>
<li><a class="reference internal" href="#id41"><code class="docutils literal notranslate"><span class="pre">every</span></code></a></li>
<li><a class="reference internal" href="#id42"><code class="docutils literal notranslate"><span class="pre">flush_every</span></code></a></li>
<li><a class="reference internal" href="#origin"><code class="docutils literal notranslate"><span class="pre">origin</span></code></a></li>
<li><a class="reference internal" href="#corners"><code class="docutils literal notranslate"><span class="pre">corners</span></code></a></li>
<li><a class="reference internal" href="#vectors"><code class="docutils literal notranslate"><span class="pre">vectors</span></code></a></li>
<li><a class="reference internal" href="#number"><code class="docutils literal notranslate"><span class="pre">number</span></code></a></li>
<li><a class="reference internal" href="#id43"><code class="docutils literal notranslate"><span class="pre">fields</span></code></a></li>
<li><a class="reference internal" href="#time_integral"><code class="docutils literal notranslate"><span class="pre">time_integral</span></code></a></li>
<li><a class="reference internal" href="#id44"><code class="docutils literal notranslate"><span class="pre">datatype</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#particlebinning-diagnostics"><em>ParticleBinning</em> diagnostics</a><ul>
<li><a class="reference internal" href="#id45"><code class="docutils literal notranslate"><span class="pre">name</span></code></a></li>
<li><a class="reference internal" href="#deposited_quantity"><code class="docutils literal notranslate"><span class="pre">deposited_quantity</span></code></a></li>
<li><a class="reference internal" href="#id46"><code class="docutils literal notranslate"><span class="pre">every</span></code></a></li>
<li><a class="reference internal" href="#id47"><code class="docutils literal notranslate"><span class="pre">flush_every</span></code></a></li>
<li><a class="reference internal" href="#id48"><code class="docutils literal notranslate"><span class="pre">time_average</span></code></a></li>
<li><a class="reference internal" href="#id49"><code class="docutils literal notranslate"><span class="pre">species</span></code></a></li>
<li><a class="reference internal" href="#axes"><code class="docutils literal notranslate"><span class="pre">axes</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#screen-diagnostics"><em>Screen</em> diagnostics</a><ul>
<li><a class="reference internal" href="#id50"><code class="docutils literal notranslate"><span class="pre">name</span></code></a></li>
<li><a class="reference internal" href="#shape"><code class="docutils literal notranslate"><span class="pre">shape</span></code></a></li>
<li><a class="reference internal" href="#point"><code class="docutils literal notranslate"><span class="pre">point</span></code></a></li>
<li><a class="reference internal" href="#vector"><code class="docutils literal notranslate"><span class="pre">vector</span></code></a></li>
<li><a class="reference internal" href="#direction"><code class="docutils literal notranslate"><span class="pre">direction</span></code></a></li>
<li><a class="reference internal" href="#id51"><code class="docutils literal notranslate"><span class="pre">deposited_quantity</span></code></a></li>
<li><a class="reference internal" href="#id52"><code class="docutils literal notranslate"><span class="pre">every</span></code></a></li>
<li><a class="reference internal" href="#id53"><code class="docutils literal notranslate"><span class="pre">flush_every</span></code></a></li>
<li><a class="reference internal" href="#id54"><code class="docutils literal notranslate"><span class="pre">species</span></code></a></li>
<li><a class="reference internal" href="#id55"><code class="docutils literal notranslate"><span class="pre">axes</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#radiationspectrum-diagnostics"><em>RadiationSpectrum</em> diagnostics</a><ul>
<li><a class="reference internal" href="#id56"><code class="docutils literal notranslate"><span class="pre">name</span></code></a></li>
<li><a class="reference internal" href="#id57"><code class="docutils literal notranslate"><span class="pre">every</span></code></a></li>
<li><a class="reference internal" href="#id58"><code class="docutils literal notranslate"><span class="pre">flush_every</span></code></a></li>
<li><a class="reference internal" href="#id59"><code class="docutils literal notranslate"><span class="pre">time_average</span></code></a></li>
<li><a class="reference internal" href="#id60"><code class="docutils literal notranslate"><span class="pre">species</span></code></a></li>
<li><a class="reference internal" href="#photon_energy_axis"><code class="docutils literal notranslate"><span class="pre">photon_energy_axis</span></code></a></li>
<li><a class="reference internal" href="#id61"><code class="docutils literal notranslate"><span class="pre">axes</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#trackparticles-diagnostics"><em>TrackParticles</em> diagnostics</a><ul>
<li><a class="reference internal" href="#id62"><code class="docutils literal notranslate"><span class="pre">species</span></code></a></li>
<li><a class="reference internal" href="#id63"><code class="docutils literal notranslate"><span class="pre">every</span></code></a></li>
<li><a class="reference internal" href="#id64"><code class="docutils literal notranslate"><span class="pre">flush_every</span></code></a></li>
<li><a class="reference internal" href="#filter"><code class="docutils literal notranslate"><span class="pre">filter</span></code></a></li>
<li><a class="reference internal" href="#attributes"><code class="docutils literal notranslate"><span class="pre">attributes</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#newparticles-diagnostics"><em>NewParticles</em> diagnostics</a></li>
<li><a class="reference internal" href="#performances-diagnostics"><em>Performances</em> diagnostics</a><ul>
<li><a class="reference internal" href="#id66"><code class="docutils literal notranslate"><span class="pre">every</span></code></a></li>
<li><a class="reference internal" href="#id67"><code class="docutils literal notranslate"><span class="pre">flush_every</span></code></a></li>
<li><a class="reference internal" href="#patch_information"><code class="docutils literal notranslate"><span class="pre">patch_information</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#time-selections">Time selections</a></li>
<li><a class="reference internal" href="#profiles">Profiles</a></li>
<li><a class="reference internal" href="#checkpoints">Checkpoints</a><ul>
<li><a class="reference internal" href="#dump_step"><code class="docutils literal notranslate"><span class="pre">dump_step</span></code></a></li>
<li><a class="reference internal" href="#dump_minutes"><code class="docutils literal notranslate"><span class="pre">dump_minutes</span></code></a></li>
<li><a class="reference internal" href="#exit_after_dump"><code class="docutils literal notranslate"><span class="pre">exit_after_dump</span></code></a></li>
<li><a class="reference internal" href="#keep_n_dumps"><code class="docutils literal notranslate"><span class="pre">keep_n_dumps</span></code></a></li>
<li><a class="reference internal" href="#file_grouping"><code class="docutils literal notranslate"><span class="pre">file_grouping</span></code></a></li>
<li><a class="reference internal" href="#dump_deflate"><code class="docutils literal notranslate"><span class="pre">dump_deflate</span></code></a></li>
<li><a class="reference internal" href="#restart_dir"><code class="docutils literal notranslate"><span class="pre">restart_dir</span></code></a></li>
<li><a class="reference internal" href="#restart_number"><code class="docutils literal notranslate"><span class="pre">restart_number</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#variables-defined-by-smilei">Variables defined by Smilei</a><ul>
<li><a class="reference internal" href="#smilei_mpi_rank"><code class="docutils literal notranslate"><span class="pre">smilei_mpi_rank</span></code></a></li>
<li><a class="reference internal" href="#smilei_mpi_size"><code class="docutils literal notranslate"><span class="pre">smilei_mpi_size</span></code></a></li>
<li><a class="reference internal" href="#smilei_omp_threads"><code class="docutils literal notranslate"><span class="pre">smilei_omp_threads</span></code></a></li>
<li><a class="reference internal" href="#smilei_total_cores"><code class="docutils literal notranslate"><span class="pre">smilei_total_cores</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </div>
        </div>
    </div>
    
    <div class="headercolor">
    </div>
    <div class="hpositioner">
        <div class="header">
        <div class="logo">
            <a href="../index.html">
                <img class="logo" src="../_static/smileiLogo.svg" alt="Logo" />
            </a>
            <!--
            <div style="height:7mm; position: absolute; top:2mm; left:-32mm; padding: 1mm 2mm 0 2mm; border-radius: 2mm; background-color:#C5DCEA; background-color:var(--header_text);">
                <a href="https://indico.math.cnrs.fr/e/smilei5">
                    <img src="../_static/workshopLogo.svg" alt="workshop"
                        style="height:5mm;padding-top: 1mm;" />
                </a>
            </div>
            -->
        </div>
        <div class="menu"
            id="menu_Overview"
            
        >
            <div id="menuButton_Overview" class="menuButton"
                 onmouseenter="prepareMenu('menu_Overview')"
                 onmousedown="event.preventDefault()"
            >
                <a href="../overview.html">
                    <span>Overview</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_Overview',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="../Overview/synopsis.html">Synopsis</a>
                        </li>
                        <li class="outer">
                            <a href="../Overview/highlights.html">Highlights</a>
                        </li>
                        <li class="outer">
                            <a href="../Overview/releases.html">Releases</a>
                        </li>
                        <li class="outer">
                            <a href="../Overview/licence.html">Licence</a>
                        </li>
                        <li class="outer">
                            <a href="../Overview/material.html">Publications</a>
                        </li>
                        <li class="outer">
                            <a href="../Overview/partners.html">Partners</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        <div class="menu"
            id="menu_Understand"
            
        >
            <div id="menuButton_Understand" class="menuButton"
                 onmouseenter="prepareMenu('menu_Understand')"
                 onmousedown="event.preventDefault()"
            >
                <a href="../understand.html">
                    <span>Understand</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_Understand',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="../Understand/units.html">Units</a>
                        </li>
                        <li class="outer">
                            <a href="../Understand/algorithms.html">PIC algorithms</a>
                        </li>
                        <li class="outer">
                            <a href="../Understand/performances.html">Parallelization & optimization</a>
                        </li>
                        <li class="outer">
                            <a href="../Understand/physics_modules.html">Physics modules</a>
                        </li>
                        <li class="outer">
                            <a href="../Understand/numerical_techniques.html">Advanced numerical techniques</a>
                        </li>
                        <li class="outer">
                            <a href="../Understand/PML.html">Perfectly Matched Layers</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        <div class="last menu"
            id="menu_Use"
            style="font-weight:bold"
        >
            <div id="menuButton_Use" class="menuButton"
                 onmouseenter="prepareMenu('menu_Use')"
                 onmousedown="event.preventDefault()"
            >
                <a href="../use.html">
                    <span>Use</span>
                </a>
            </div>
            <div class="off" onmouseleave="leaveMenu('menu_Use',this)">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="installation.html">Install</a>
                        </li>
                        <li class="outer">
                            <a href="https://smileipic.github.io/tutorials">Smilei tutorials</a>
                        </li>
                        <li >
                            <a href="#">Write a namelist</a>
                        </li>
                        <li class="outer">
                            <a href="run.html">Run</a>
                        </li>
                        <li class="outer">
                            <a href="post-processing.html">Post-process</a>
                        </li>
                        <li class="outer">
                            <a href="contribute.html">Contribute</a>
                        </li>
                        <li class="outer">
                            <a href="troubleshoot.html">Troubleshoot</a>
                        </li>
                        <li class="outer">
                            <a href="GPU_version.html">GPU version</a>
                        </li>
        
                    </ul>
                </div>
            </div>
        </div>
        
        <script type="text/javascript">
            var es=document.getElementsByClassName("menuButton"), i=0;
            var evt = "ontouchend" in document ? "touchend" : "click";
            for( var i=0; i<es.length; i+=1 ) {
                es[i].addEventListener(evt, function(a){ return function(){toggleMenu(a)};}(es[i].parentNode.id));
            }
        </script>
        
        <div id="searchbox" role="search" style="display:none">
            <form class="search" action="../search.html" method="get">
              <input type="text" name="q" placeholder="Search" id="searchinput" />
              <input type="hidden" name="check_keywords" value="yes" />
              <input type="hidden" name="area" value="default" />
            </form>
        </div>
        
        <div id="searchicon" onclick="openSearch()" style="display:block">
            <svg
               xmlns="http://www.w3.org/2000/svg"
               viewBox="0 0 80 120">
              <g transform="translate(0,-932.36216)" >
                <circle
                   r="25" cy="977.51044" cx="38.078663"
                   style="opacity:1;fill:none;stroke:#ffffff;stroke:var(--header_text);stroke-width:10;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
                <rect
                   transform="matrix(0.36717877,0.93015039,-0.93427297,0.35655858,0,0)"
                   rx="4.9996676" ry="7.4995141" x="947.6142" y="316.16959"
                   height="14.117695" width="46.476151"
                   style="opacity:1;fill:#ffffff;fill:var(--header_text);fill-opacity:1;stroke:none;" />
                <path
                   d="m 41.383282,962.25996 a 15,15 0 0 1 11.660107,11.6355"
                   style="opacity:1;fill:none;stroke:#ffffff;stroke:var(--header_text);stroke-width:3;stroke-linecap:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
              </g>
            </svg>
        </div>
        <div id="closesearchicon" onclick="closeSearch()" style="display:none">
            <svg
               xmlns="http://www.w3.org/2000/svg"
               viewBox="0 0 80 120">
              <g
                 transform="translate(0,-932.36216)"
                 style="fill:none;stroke:#ffffff;stroke:var(--header_text);stroke-width:10;stroke-linecap:round;stroke-linejoin:miter;stroke-opacity:1;stroke-miterlimit:4;stroke-dasharray:none">
                <path d="m 10,962.36216 60,60.00004" />
                <path d="M 70,962.36216 10,1022.3622" />
              </g>
            </svg>
        </div>
        
        <div id="smallScreenMenuButton" onclick="event.preventDefault(); toggleSmallScreenMenu(event)">
            <svg xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg"
               viewBox="-20 -20 140 140">
              <g  style="fill:#ffffff; fill:var(--header_text);stroke:none;">
                <circle cx="15" cy="20" r="5" />
                <circle cx="35" cy="20" r="5" />
                <circle cx="85" cy="20" r="5" />
                <rect width="50" height="10" x="35" y="15" rx="0" ry="0" />
                <circle cx="15" cy="40" r="5" />
                <circle cx="35" cy="40" r="5" />
                <circle cx="85" cy="40" r="5" />
                <rect width="50" height="10" x="35" y="35" rx="0" ry="0" />
                <circle cx="15" cy="60" r="5" />
                <circle cx="35" cy="60" r="5" />
                <circle cx="85" cy="60" r="5" />
                <rect width="50" height="10" x="35" y="55" rx="0" ry="0" />
                <circle cx="15" cy="80" r="5" />
                <circle cx="35" cy="80" r="5" />
                <circle cx="85" cy="80" r="5" />
                <rect width="50" height="10" x="35" y="75" rx="0" ry="0" />
              </g>
            </svg>
        </div>
        
    </div>
    
</div>
</div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="write-a-namelist">
<h1>Write a namelist<a class="headerlink" href="#write-a-namelist" title="Link to this heading">¶</a></h1>
<p>Before you run <strong class="program">Smilei</strong>, you need a <em>namelist</em> (an input file). The namelist
is written in the <em>python</em> language. It is thus recommended to know the basics of <em>python</em>.</p>
<p>We suggest you copy one existing namelist from the folder <em>benchmarks</em>.
All namelists have the extension <code class="docutils literal notranslate"><span class="pre">.py</span></code>.</p>
<hr class="docutils" />
<section id="general-rules">
<h2>General rules<a class="headerlink" href="#general-rules" title="Link to this heading">¶</a></h2>
<ul>
<li><p><strong class="program">Smilei</strong> requires a few <em>blocks</em> to be defined, such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Main</span><span class="p">(</span>
    <span class="c1"># ...</span>
    <span class="n">timestep</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>         <span class="c1"># defines the timestep value</span>
    <span class="n">grid_length</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">20.</span><span class="p">],</span> <span class="c1"># defines the 2D box dimensions</span>
    <span class="c1"># ...</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Outside blocks, you can calculate anything you require.
Inside a block, you must only define variables for <strong class="program">Smilei</strong>.</p>
</li>
<li><p>The <em>python</em> syntax requires special indentation of each line.
You begin with no indentation, but you have to <strong>add four spaces at the
beginning of lines inside a group</strong>, and so on.
For instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">timestep</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">timestep</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">timestep</span> <span class="o">=</span> <span class="mf">0.3</span>
</pre></div>
</div>
</li>
<li><p>You will need to use <a class="reference external" href="https://docs.python.org/2/tutorial/introduction.html#lists">lists</a>,
which are series of things in <em>python</em>,
defined between brackets <code class="docutils literal notranslate"><span class="pre">[]</span></code> and separated by commas.
For example, <code class="docutils literal notranslate"><span class="pre">mean_velocity</span> <span class="pre">=</span> <span class="pre">[0.,</span> <span class="pre">1.1,</span> <span class="pre">3.]</span></code>.</p></li>
<li><p>You are free to import any installed <em>python</em> package into the namelist.
For instance, you may obtain <span class="math notranslate nohighlight">\(\pi\)</span> using <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">math</span> <span class="pre">import</span> <span class="pre">pi</span></code>.</p></li>
<li><p>All quantities are normalized to arbitrary values: see <a class="reference internal" href="../Understand/units.html"><span class="doc">Units</span></a>.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="python-workflow">
<h2>Python workflow<a class="headerlink" href="#python-workflow" title="Link to this heading">¶</a></h2>
<p><em>Python</em> is started at the beginning of the simulation (one <em>python</em> interpreter
for each MPI process). The following steps are executed:</p>
<ol class="arabic simple">
<li><p>A few variables from <strong class="program">Smilei</strong> are passed to <em>python</em> so that they are
available to the user:</p>
<ul class="simple">
<li><p>The rank of the current MPI process as <a class="reference internal" href="#smilei_mpi_rank" title="smilei_mpi_rank"><code class="xref py py-data docutils literal notranslate"><span class="pre">smilei_mpi_rank</span></code></a>.</p></li>
<li><p>The total number of MPI processes as <a class="reference internal" href="#smilei_mpi_size" title="smilei_mpi_size"><code class="xref py py-data docutils literal notranslate"><span class="pre">smilei_mpi_size</span></code></a>.</p></li>
<li><p>The number of OpenMP threads per MPI <a class="reference internal" href="#smilei_omp_threads" title="smilei_omp_threads"><code class="xref py py-data docutils literal notranslate"><span class="pre">smilei_omp_threads</span></code></a>.</p></li>
<li><p>The total number of cores <a class="reference internal" href="#smilei_total_cores" title="smilei_total_cores"><code class="xref py py-data docutils literal notranslate"><span class="pre">smilei_total_cores</span></code></a>.</p></li>
</ul>
</li>
<li><p>The namelist(s) is executed.</p></li>
<li><p><em>Python</em> runs <code class="xref py py-data docutils literal notranslate"><span class="pre">preprocess()</span></code> if the user has defined it.
This is a good place to calculate things that are not needed for
post-processing with <strong class="program">happi</strong>.</p></li>
<li><p>The simulation is initialized (including field and particle arrays).</p></li>
<li><p><em>Python</em> runs <code class="xref py py-data docutils literal notranslate"><span class="pre">cleanup()</span></code> if the user has defined it.
This is a good place to delete unused heavy variables.</p></li>
<li><p><em>Python</em> checks whether the <em>python</em> interpreter is needed during the simulation
(e.g. the user has defined a temporal <a class="reference internal" href="profiles.html"><span class="doc">profile</span></a> which requires <em>python</em>
to calculate it every timestep). Otherwise, <em>python</em> is stopped.</p></li>
</ol>
<p>All these instructions are summarized in a file <code class="docutils literal notranslate"><span class="pre">smilei.py</span></code>,
so that the user can directly run <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-i</span> <span class="pre">smilei.py</span></code> for post-processing purposes.</p>
</section>
<hr class="docutils" />
<section id="main-variables">
<h2>Main variables<a class="headerlink" href="#main-variables" title="Link to this heading">¶</a></h2>
<p>The block <code class="docutils literal notranslate"><span class="pre">Main</span></code> is <strong>mandatory</strong> and has the following syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Main</span><span class="p">(</span>
    <span class="n">geometry</span> <span class="o">=</span> <span class="s2">&quot;1Dcartesian&quot;</span><span class="p">,</span>
    <span class="n">interpolation_order</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">interpolator</span> <span class="o">=</span> <span class="s2">&quot;momentum-conserving&quot;</span><span class="p">,</span>
    <span class="n">grid_length</span>  <span class="o">=</span> <span class="p">[</span><span class="mf">16.</span> <span class="p">],</span>
    <span class="n">cell_length</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">],</span>
    <span class="n">simulation_time</span>    <span class="o">=</span> <span class="mf">15.</span><span class="p">,</span>
    <span class="n">timestep</span>    <span class="o">=</span> <span class="mf">0.005</span><span class="p">,</span>
    <span class="n">number_of_patches</span> <span class="o">=</span> <span class="p">[</span><span class="mi">64</span><span class="p">],</span>
    <span class="n">cluster_width</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">maxwell_solver</span> <span class="o">=</span> <span class="s1">&#39;Yee&#39;</span><span class="p">,</span>
    <span class="n">EM_boundary_conditions</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">&quot;silver-muller&quot;</span><span class="p">,</span> <span class="s2">&quot;silver-muller&quot;</span><span class="p">],</span>
<span class="c1">#        [&quot;silver-muller&quot;, &quot;silver-muller&quot;],</span>
<span class="c1">#        [&quot;silver-muller&quot;, &quot;silver-muller&quot;],</span>
    <span class="p">],</span>
    <span class="n">time_fields_frozen</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">reference_angular_frequency_SI</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">print_every</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
    <span class="n">random_seed</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="geometry">
<span class="sig-name descname"><span class="pre">geometry</span></span><a class="headerlink" href="#geometry" title="Link to this definition">¶</a></dt>
<dd><p>The geometry of the simulation:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;1Dcartesian&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;2Dcartesian&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;3Dcartesian&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;AMcylindrical&quot;</span></code>: cylindrical geometry with <a class="reference internal" href="../Understand/azimuthal_modes_decomposition.html"><span class="doc">Azimuthal modes decomposition</span></a>.</p></li>
</ul>
<p>In the following documentation, all references to dimensions or coordinates
depend on the <code class="docutils literal notranslate"><span class="pre">geometry</span></code>.
1D, 2D and 3D stand for 1-dimensional, 2-dimensional and 3-dimensional cartesian
geometries, respectively. All coordinates are ordered as <span class="math notranslate nohighlight">\((x)\)</span>, <span class="math notranslate nohighlight">\((x,y)\)</span> or <span class="math notranslate nohighlight">\((x,y,z)\)</span>.
In the <code class="docutils literal notranslate"><span class="pre">&quot;AMcylindrical&quot;</span></code> case, all grid coordinates are 2-dimensional
<span class="math notranslate nohighlight">\((x,r)\)</span>, while particle coordinates (in <a class="reference internal" href="#species"><span class="std std-ref">Species</span></a>)
are expressed in the 3-dimensional Cartesian frame <span class="math notranslate nohighlight">\((x,y,z)\)</span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The <code class="docutils literal notranslate"><span class="pre">&quot;AMcylindrical&quot;</span></code> geometry has some restrictions.
Boundary conditions must be set to <code class="docutils literal notranslate"><span class="pre">&quot;remove&quot;</span></code> for particles,
<code class="docutils literal notranslate"><span class="pre">&quot;silver-muller&quot;</span></code> for longitudinal EM boundaries and
<code class="docutils literal notranslate"><span class="pre">&quot;buneman&quot;</span></code> for transverse EM boundaries.
You can alternatively use <code class="docutils literal notranslate"><span class="pre">&quot;PML&quot;</span></code> for any EM boundary.
Collisions and
order-4 interpolation are not supported yet.</p>
</div>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="interpolation_order">
<span class="sig-name descname"><span class="pre">interpolation_order</span></span><a class="headerlink" href="#interpolation_order" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p>
</dd>
</dl>
<p>Interpolation order, defines particle shape function:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code>  : 2 points stencil in r with Ruyten correction, 3 points stencil in x. Supported only in AM geometry.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code>  : 3 points stencil, supported in all configurations.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">4</span></code>  : 5 points stencil, not supported in vectorized 2D geometry.</p></li>
</ul>
<p>The Ruyten correction is the scheme described bu equation 4.2 in <a class="reference external" href="https://www.sciencedirect.com/science/article/abs/pii/S0021999183710703">this paper</a> .
It allows for a more accurate description on axis at the cost of a higher statistic noise so it often requires the use of more macro-particles.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="interpolator">
<span class="sig-name descname"><span class="pre">interpolator</span></span><a class="headerlink" href="#interpolator" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;momentum-conserving&quot;</span></code></p>
</dd>
</dl>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;momentum-conserving&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;wt&quot;</span></code></p></li>
</ul>
<p>The interpolation scheme to be used in the simulation.
<code class="docutils literal notranslate"><span class="pre">&quot;wt&quot;</span></code> is for the timestep dependent field interpolation scheme described in
<a class="reference external" href="https://doi.org/10.1016/j.jcp.2020.109388">this paper</a> .</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="grid_length">
<span class="sig-name descname"><span class="pre">grid_length</span></span><a class="headerlink" href="#grid_length" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py" id="number_of_cells">
<span class="sig-name descname"><span class="pre">number_of_cells</span></span><a class="headerlink" href="#number_of_cells" title="Link to this definition">¶</a></dt>
<dd><p>A list of numbers: size of the simulation box for each dimension of the simulation.</p>
<ul class="simple">
<li><p>Either <code class="docutils literal notranslate"><span class="pre">grid_length</span></code>, the simulation length in each direction in units of <span class="math notranslate nohighlight">\(L_r\)</span>,</p></li>
<li><p>or <code class="docutils literal notranslate"><span class="pre">number_of_cells</span></code>, the number of cells in each direction.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In <code class="docutils literal notranslate"><span class="pre">AMcylindrical</span></code> geometry, the grid represents 2-dimensional fields.
The second dimension is the <strong>radius</strong> of the cylinder.</p>
</div>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="cell_length">
<span class="sig-name descname"><span class="pre">cell_length</span></span><a class="headerlink" href="#cell_length" title="Link to this definition">¶</a></dt>
<dd><p>A list of floats: sizes of one cell in each direction in units of <span class="math notranslate nohighlight">\(L_r\)</span>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="simulation_time">
<span class="sig-name descname"><span class="pre">simulation_time</span></span><a class="headerlink" href="#simulation_time" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py" id="number_of_timesteps">
<span class="sig-name descname"><span class="pre">number_of_timesteps</span></span><a class="headerlink" href="#number_of_timesteps" title="Link to this definition">¶</a></dt>
<dd><p>Duration of the simulation.</p>
<ul class="simple">
<li><p>Either <code class="docutils literal notranslate"><span class="pre">simulation_time</span></code>, the simulation duration in units of <span class="math notranslate nohighlight">\(T_r\)</span>,</p></li>
<li><p>or <code class="docutils literal notranslate"><span class="pre">number_of_timesteps</span></code>, the total number of timesteps.</p></li>
</ul>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="timestep">
<span class="sig-name descname"><span class="pre">timestep</span></span><a class="headerlink" href="#timestep" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py" id="timestep_over_CFL">
<span class="sig-name descname"><span class="pre">timestep_over_CFL</span></span><a class="headerlink" href="#timestep_over_CFL" title="Link to this definition">¶</a></dt>
<dd><p>Duration of one timestep.</p>
<ul class="simple">
<li><p>Either <code class="docutils literal notranslate"><span class="pre">timestep</span></code>, in units of <span class="math notranslate nohighlight">\(T_r\)</span>,</p></li>
<li><p>or <code class="docutils literal notranslate"><span class="pre">timestep_over_CFL</span></code>, in units of the <em>Courant–Friedrichs–Lewy</em> (CFL) time.</p></li>
</ul>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="gpu_computing">
<span class="sig-name descname"><span class="pre">gpu_computing</span></span><a class="headerlink" href="#gpu_computing" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
<p>Activates GPU acceleration if set to True</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="number_of_patches">
<span class="sig-name descname"><span class="pre">number_of_patches</span></span><a class="headerlink" href="#number_of_patches" title="Link to this definition">¶</a></dt>
<dd><p>A list of integers: the number of patches in each direction.
Each integer must be a power of 2, and the total number of patches must be
greater or equal than the number of MPI processes.
It is also strongly advised to have more patches than the total number of openMP threads.
See <a class="reference internal" href="../Understand/parallelization.html"><span class="doc">Parallelization basics</span></a>.On the other hand, in case of GPU-acceleration it is recommended to use one patch per MPI-rank
(with one MPI-rank per GPU)</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="patch_arrangement">
<span class="sig-name descname"><span class="pre">patch_arrangement</span></span><a class="headerlink" href="#patch_arrangement" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;hilbertian&quot;</span></code></p>
</dd>
</dl>
<p>Determines the ordering of patches and the way they are separated into the
various MPI processes. Options are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;hilbertian&quot;</span></code>: following the Hilbert curve (see <a class="reference internal" href="../Understand/parallelization.html#loadbalancingexplanation"><span class="std std-ref">this explanation</span></a>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;linearized_XY&quot;</span></code> in 2D or <code class="docutils literal notranslate"><span class="pre">&quot;linearized_XYZ&quot;</span></code> in 3D: following the
row-major (C-style) ordering.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;linearized_YX&quot;</span></code> in 2D or <code class="docutils literal notranslate"><span class="pre">&quot;linearized_ZYX&quot;</span></code> in 3D: following the
column-major (fortran-style) ordering. This prevents the usage of
<a class="reference internal" href="#diagfields"><span class="std std-ref">Fields diagnostics</span></a> (see <a class="reference internal" href="../Understand/parallelization.html"><span class="doc">Parallelization basics</span></a>).</p></li>
</ul>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="cluster_width">
<span class="sig-name descname"><span class="pre">cluster_width</span></span><a class="headerlink" href="#cluster_width" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>set to minimize the memory footprint of the particles pusher, especially interpolation and projection processes</p>
</dd>
</dl>
<p>For advanced users. Integer specifying the cluster width along X direction in number of cells.
The “cluster” is a sub-patch structure in which particles are sorted for cache improvement.
<code class="docutils literal notranslate"><span class="pre">cluster_width</span></code> must divide the number of cells in one patch (in dimension X).
The finest sorting is achieved with <code class="docutils literal notranslate"><span class="pre">cluster_width=1</span></code> and no sorting with <code class="docutils literal notranslate"><span class="pre">cluster_width</span></code> equal to the full size of a patch along dimension X.
The cluster size in dimension Y and Z is always the full extent of the patch.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="maxwell_solver">
<span class="sig-name descname"><span class="pre">maxwell_solver</span></span><a class="headerlink" href="#maxwell_solver" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>‘Yee’</p>
</dd>
</dl>
<p>The solver for Maxwell’s equations.
Only <code class="docutils literal notranslate"><span class="pre">&quot;Yee&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;M4&quot;</span></code> are available for all geometries at the moment.
<code class="docutils literal notranslate"><span class="pre">&quot;Cowan&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Grassi&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Lehe&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;Bouchard&quot;</span></code> are available for <code class="docutils literal notranslate"><span class="pre">2DCartesian</span></code>.
<code class="docutils literal notranslate"><span class="pre">&quot;Lehe&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;Bouchard&quot;</span></code> are available for <code class="docutils literal notranslate"><span class="pre">3DCartesian</span></code>.
<code class="docutils literal notranslate"><span class="pre">&quot;Lehe&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;Terzani&quot;</span></code> are available for <code class="docutils literal notranslate"><span class="pre">AMcylindrical</span></code>.
The M4 solver is described in <a class="reference external" href="https://doi.org/10.1016/j.jcp.2020.109388">this paper</a>.
The Lehe solver is described in <a class="reference external" href="https://journals.aps.org/prab/abstract/10.1103/PhysRevSTAB.16.021301">this paper</a>.
The Bouchard solver is described in <a class="reference external" href="https://tel.archives-ouvertes.fr/tel-02967252">this thesis p. 109</a>.
The Terzani solver is described in <a class="reference external" href="https://doi.org/10.1016/j.cpc.2019.04.007">this paper</a>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="solve_poisson">
<span class="sig-name descname"><span class="pre">solve_poisson</span></span><a class="headerlink" href="#solve_poisson" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>True</p>
</dd>
</dl>
<p>Decides if Poisson correction must be applied or not initially.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="poisson_max_iteration">
<span class="sig-name descname"><span class="pre">poisson_max_iteration</span></span><a class="headerlink" href="#poisson_max_iteration" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>50000</p>
</dd>
</dl>
<p>Maximum number of iteration for the Poisson solver.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="poisson_max_error">
<span class="sig-name descname"><span class="pre">poisson_max_error</span></span><a class="headerlink" href="#poisson_max_error" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>1e-14</p>
</dd>
</dl>
<p>Maximum error for the Poisson solver.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="solve_relativistic_poisson">
<span class="sig-name descname"><span class="pre">solve_relativistic_poisson</span></span><a class="headerlink" href="#solve_relativistic_poisson" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>False</p>
</dd>
</dl>
<p>Decides if relativistic Poisson problem must be solved for at least one species.
See <a class="reference internal" href="../Understand/relativistic_fields_initialization.html"><span class="doc">Field initialization for relativistic species</span></a> for more details.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="relativistic_poisson_max_iteration">
<span class="sig-name descname"><span class="pre">relativistic_poisson_max_iteration</span></span><a class="headerlink" href="#relativistic_poisson_max_iteration" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>50000</p>
</dd>
</dl>
<p>Maximum number of iteration for the Poisson solver.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="relativistic_poisson_max_error">
<span class="sig-name descname"><span class="pre">relativistic_poisson_max_error</span></span><a class="headerlink" href="#relativistic_poisson_max_error" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>1e-22</p>
</dd>
</dl>
<p>Maximum error for the Poisson solver.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="EM_boundary_conditions">
<span class="sig-name descname"><span class="pre">EM_boundary_conditions</span></span><a class="headerlink" href="#EM_boundary_conditions" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of lists of strings</p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">[[&quot;periodic&quot;]]</span></code></p>
</dd>
</dl>
<p>The boundary conditions for the electromagnetic fields. Each boundary may have one of
the following conditions: <code class="docutils literal notranslate"><span class="pre">&quot;periodic&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;silver-muller&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;reflective&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;ramp??&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;PML&quot;</span></code>.</p>
<div class="line-block">
<div class="line"><strong>Syntax 1:</strong> <code class="docutils literal notranslate"><span class="pre">[[bc_all]]</span></code>, identical for all boundaries.</div>
<div class="line"><strong>Syntax 2:</strong> <code class="docutils literal notranslate"><span class="pre">[[bc_X],</span> <span class="pre">[bc_Y],</span> <span class="pre">...]</span></code>, different depending on x, y or z.</div>
<div class="line"><strong>Syntax 3:</strong> <code class="docutils literal notranslate"><span class="pre">[[bc_Xmin,</span> <span class="pre">bc_Xmax],</span> <span class="pre">...]</span></code>,  different on each boundary.</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;silver-muller&quot;</span></code> is an open boundary condition.
The incident wave vector <span class="math notranslate nohighlight">\(k_{inc}\)</span> on each face is defined by
<code class="docutils literal notranslate"><span class="pre">&quot;EM_boundary_conditions_k&quot;</span></code>.
When using <code class="docutils literal notranslate"><span class="pre">&quot;silver-muller&quot;</span></code> as an injecting boundary,
make sure <span class="math notranslate nohighlight">\(k_{inc}\)</span> is aligned with the wave you are injecting.
When using <code class="docutils literal notranslate"><span class="pre">&quot;silver-muller&quot;</span></code> as an absorbing boundary,
the optimal wave absorption on a given face will be along <span class="math notranslate nohighlight">\(k_{abs}\)</span>
the specular reflection of <span class="math notranslate nohighlight">\(k_{inc}\)</span> on the considered face.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;ramp??&quot;</span></code> is a basic, open boundary condition designed
for the spectral solver in <code class="docutils literal notranslate"><span class="pre">AMcylindrical</span></code> geometry.
The <code class="docutils literal notranslate"><span class="pre">??</span></code> is an integer representing a number of cells
(smaller than the number of ghost cells).
Over the first half, the fields remain untouched.
Over the second half, all fields are progressively reduced down to zero.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;PML&quot;</span></code> stands for Perfectly Matched Layer. It is an open boundary condition.
The number of cells in the layer must be defined by <code class="docutils literal notranslate"><span class="pre">&quot;number_of_pml_cells&quot;</span></code>.
It supports laser injection as in <code class="docutils literal notranslate"><span class="pre">&quot;silver-muller&quot;</span></code>.
If not all boundary conditions are <code class="docutils literal notranslate"><span class="pre">PML</span></code>, make sure to set <code class="docutils literal notranslate"><span class="pre">number_of_pml_cells=0</span></code> on boundaries not using PML.</p></li>
</ul>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="EM_boundary_conditions_k">
<span class="sig-name descname"><span class="pre">EM_boundary_conditions_k</span></span><a class="headerlink" href="#EM_boundary_conditions_k" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of lists of floats</p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">[[1.,0.],[-1.,0.],[0.,1.],[0.,-1.]]</span></code> in 2D</p>
</dd>
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">[[1.,0.,0.],[-1.,0.,0.],[0.,1.,0.],[0.,-1.,0.],[0.,0.,1.],[0.,0.,-1.]]</span></code> in 3D</p>
</dd>
</dl>
<p>For <code class="docutils literal notranslate"><span class="pre">silver-muller</span></code> absorbing boundaries,
the <em>x,y,z</em> coordinates of the unit wave vector <code class="docutils literal notranslate"><span class="pre">k</span></code> incident on each face
(sequentially Xmin, Xmax, Ymin, Ymax, Zmin, Zmax).
The number of coordinates is equal to the dimension of the simulation.
The number of given vectors must be equal to 1 or to the number of faces
which is twice the dimension of the simulation. In cylindrical geometry,
<code class="docutils literal notranslate"><span class="pre">k</span></code> coordinates are given in the <code class="docutils literal notranslate"><span class="pre">xr</span></code> frame and only the Rmax face is affected.</p>
<div class="line-block">
<div class="line"><strong>Syntax 1:</strong> <code class="docutils literal notranslate"><span class="pre">[[1,0,0]]</span></code>, identical for all boundaries.</div>
<div class="line"><strong>Syntax 2:</strong> <code class="docutils literal notranslate"><span class="pre">[[1,0,0],[-1,0,0],</span> <span class="pre">...]</span></code>,  different on each boundary.</div>
</div>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="number_of_pml_cells">
<span class="sig-name descname"><span class="pre">number_of_pml_cells</span></span><a class="headerlink" href="#number_of_pml_cells" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of lists of integers</p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">[[10,10],[10,10],[10,10]]</span></code></p>
</dd>
</dl>
<p>Defines the number of cells in the <code class="docutils literal notranslate"><span class="pre">&quot;PML&quot;</span></code> layers using the same alternative syntaxes as <code class="docutils literal notranslate"><span class="pre">&quot;EM_boundary_conditions&quot;</span></code>.</p>
</dd></dl>

<dl class="py data experimental">
<dt class="sig sig-object py" id="pml_sigma">
<span class="sig-name descname"><span class="pre">pml_sigma</span></span><a class="headerlink" href="#pml_sigma" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of profiles</p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><p>[lambda x : 20 * x**2]</p>
</dd>
</dl>
<p>Defines the sigma profiles across the transverse dimension of the PML for each dimension of the simulation.
It must be expressed as a list of profiles (1 per dimension).</p>
<p>If a single profile is given, it will be used for all dimensions.</p>
<p>For a given dimension, the same profile is applied to both sides of the domain.</p>
<p>The profile is given as a single variable function defined on the interval [0,1] where 0 is the inner bound of the PML and 1 is the outer bound of the PML.
Please refer to <a class="reference internal" href="../Understand/PML.html"><span class="doc">Perfectly Matched Layers</span></a> if needed in AM geometry.</p>
</dd></dl>

<dl class="py data experimental">
<dt class="sig sig-object py" id="pml_kappa">
<span class="sig-name descname"><span class="pre">pml_kappa</span></span><a class="headerlink" href="#pml_kappa" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of profiles</p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><p>[lambda x : 1 + 79 * x**4]</p>
</dd>
</dl>
<p>Defines the kappa profiles across the transverse dimension of the PML for each dimension of the simulation.
It must be expressed as a list of profiles (1 per dimension).</p>
<p>If a single profile is given, it will be used for all dimensions.</p>
<p>For a given dimension, the same profile is applied to both sides of the domain.</p>
<p>The profile is given as a single variable function defined on the interval [0,1] where 0 is the inner bound of the PML and 1 is the outer bound of the PML.
Please refer to <a class="reference internal" href="../Understand/PML.html"><span class="doc">Perfectly Matched Layers</span></a> if needed in AM geometry.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="time_fields_frozen">
<span class="sig-name descname"><span class="pre">time_fields_frozen</span></span><a class="headerlink" href="#time_fields_frozen" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><ol class="arabic simple" start="0">
<li></li>
</ol>
</dd>
</dl>
<p>Time, at the beginning of the simulation, during which fields are frozen.</p>
</dd></dl>

<dl class="py data" id="reference-angular-frequency-si">
<dt class="sig sig-object py" id="reference_angular_frequency_SI">
<span class="sig-name descname"><span class="pre">reference_angular_frequency_SI</span></span><a class="headerlink" href="#reference_angular_frequency_SI" title="Link to this definition">¶</a></dt>
<dd><p>The value of the reference angular frequency <span class="math notranslate nohighlight">\(\omega_r\)</span> in SI units,
<strong>only needed when collisions, ionization, radiation losses
or multiphoton Breit-Wheeler pair creation are requested</strong>.
This frequency is related to the normalization length according to <span class="math notranslate nohighlight">\(L_r\omega_r = c\)</span>
(see <a class="reference internal" href="../Understand/units.html"><span class="doc">Units</span></a>).</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="print_every">
<span class="sig-name descname"><span class="pre">print_every</span></span><a class="headerlink" href="#print_every" title="Link to this definition">¶</a></dt>
<dd><p>Number of timesteps between each info output on screen. By default, 10 outputs per
simulation.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="print_expected_disk_usage">
<span class="sig-name descname"><span class="pre">print_expected_disk_usage</span></span><a class="headerlink" href="#print_expected_disk_usage" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</dd>
</dl>
<p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, the calculation of the expected disk usage, that is usually printed in the
standard output, is skipped. This might be useful in rare cases where this calculation
is costly.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="random_seed">
<span class="sig-name descname"><span class="pre">random_seed</span></span><a class="headerlink" href="#random_seed" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>0</p>
</dd>
</dl>
<p>The value of the random seed. Each patch has its own random number generator, with a seed
equal to <code class="docutils literal notranslate"><span class="pre">random_seed</span></code> + the index of the patch.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="number_of_AM">
<span class="sig-name descname"><span class="pre">number_of_AM</span></span><a class="headerlink" href="#number_of_AM" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>integer</p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><p>2</p>
</dd>
</dl>
<p>The number of azimuthal modes used for the Fourier decomposition in <code class="docutils literal notranslate"><span class="pre">&quot;AMcylindrical&quot;</span></code> geometry.
The modes range from mode 0 to mode <code class="docutils literal notranslate"><span class="pre">&quot;number_of_AM-1&quot;</span></code>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="number_of_AM_classical_Poisson_solver">
<span class="sig-name descname"><span class="pre">number_of_AM_classical_Poisson_solver</span></span><a class="headerlink" href="#number_of_AM_classical_Poisson_solver" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>1</p>
</dd>
</dl>
<p>The number of azimuthal modes used for the field initialization with non relativistic Poisson solver in <code class="docutils literal notranslate"><span class="pre">&quot;AMcylindrical&quot;</span></code> geometry.
Note that this number must be lower or equal to the number of modes of the simulation.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="number_of_AM_relativistic_field_initialization">
<span class="sig-name descname"><span class="pre">number_of_AM_relativistic_field_initialization</span></span><a class="headerlink" href="#number_of_AM_relativistic_field_initialization" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>1</p>
</dd>
</dl>
<p>The number of azimuthal modes used for the relativistic field initialization in <code class="docutils literal notranslate"><span class="pre">&quot;AMcylindrical&quot;</span></code> geometry.
Note that this number must be lower or equal to the number of modes of the simulation.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="use_BTIS3_interpolation">
<span class="sig-name descname"><span class="pre">use_BTIS3_interpolation</span></span><a class="headerlink" href="#use_BTIS3_interpolation" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the B-translated interpolation scheme 3 (or B-TIS3) described in <a class="reference internal" href="../Understand/algorithms.html"><span class="doc">PIC algorithms</span></a> is used.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="custom_oversize">
<span class="sig-name descname"><span class="pre">custom_oversize</span></span><a class="headerlink" href="#custom_oversize" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>integer</p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><p>2</p>
</dd>
</dl>
<p>The number of ghost-cell for each patches. The default value is set accordingly with
the <code class="docutils literal notranslate"><span class="pre">interpolation_order</span></code> value.</p>
</dd></dl>

</section>
<hr class="docutils" />
<section id="load-balancing">
<h2>Load Balancing<a class="headerlink" href="#load-balancing" title="Link to this heading">¶</a></h2>
<p>Load balancing (explained <a class="reference internal" href="../Understand/parallelization.html#loadbalancingexplanation"><span class="std std-ref">here</span></a>) consists in exchanging
patches (domains of the simulation box) between MPI processes to reduce the
computational load imbalance.
The block <code class="docutils literal notranslate"><span class="pre">LoadBalancing</span></code> is optional. If you do not define it, load balancing will
occur every 150 iterations.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">LoadBalancing</span><span class="p">(</span>
    <span class="n">initial_balance</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">150</span><span class="p">,</span>
    <span class="n">cell_load</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">frozen_particle_load</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="initial_balance">
<span class="sig-name descname"><span class="pre">initial_balance</span></span><a class="headerlink" href="#initial_balance" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>True</p>
</dd>
</dl>
<p>Decides if the load must be balanced at initialization. If not, the same amount of
patches will be attributed to each MPI rank.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="every">
<span class="sig-name descname"><span class="pre">every</span></span><a class="headerlink" href="#every" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>150</p>
</dd>
</dl>
<p>Number of timesteps between each load balancing <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.
The value <code class="docutils literal notranslate"><span class="pre">0</span></code> suppresses all load balancing.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="cell_load">
<span class="sig-name descname"><span class="pre">cell_load</span></span><a class="headerlink" href="#cell_load" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><ol class="arabic simple">
<li></li>
</ol>
</dd>
</dl>
<p>Computational load of a single grid cell considered by the dynamic load balancing algorithm.
This load is normalized to the load of a single particle.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="frozen_particle_load">
<span class="sig-name descname"><span class="pre">frozen_particle_load</span></span><a class="headerlink" href="#frozen_particle_load" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>0.1</p>
</dd>
</dl>
<p>Computational load of a single frozen particle considered by the dynamic load balancing algorithm.
This load is normalized to the load of a single particle.</p>
</dd></dl>

</section>
<hr class="docutils" />
<section class="experimental" id="multiple-decomposition-of-the-domain">
<h2>Multiple decomposition of the domain<a class="headerlink" href="#multiple-decomposition-of-the-domain" title="Link to this heading">¶</a></h2>
<p>The block <code class="docutils literal notranslate"><span class="pre">MultipleDecomposition</span></code> is necessary for spectral solvers and optional in all other cases.
When present, it activates
the <a class="reference internal" href="../Understand/SDMD.html"><span class="doc">Single-domain multiple decompositions</span></a> (SDMD) technique
which separates the decomposition of the field grids from that of the particles.
Fields are set on large sub-domain called <em>regions</em> (1 region per MPI process) while
particles are kept as small <em>patches</em> as in the standard decomposition (many patches per MPI process).
Benefits of this option are illustrated <a class="reference external" href="https://hal.archives-ouvertes.fr/hal-02973139">in this paper</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">MultipleDecomposition</span><span class="p">(</span>
    <span class="n">region_ghost_cells</span> <span class="o">=</span> <span class="mi">2</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="region_ghost_cells">
<span class="sig-name descname"><span class="pre">region_ghost_cells</span></span><a class="headerlink" href="#region_ghost_cells" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>integer</p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><p>2</p>
</dd>
</dl>
<p>The number of ghost cells for each region.
The default value is set accordingly with the <code class="docutils literal notranslate"><span class="pre">interpolation_order</span></code>.
The same number of ghost cells is used in all dimensions except for spectral solver in AM geometry for which the number of radial ghost cells is always automatically set to be the same as patches.</p>
</dd></dl>

<hr class="docutils" />
</section>
<section id="vectorization">
<span id="id5"></span><h2>Vectorization<a class="headerlink" href="#vectorization" title="Link to this heading">¶</a></h2>
<p>The block <code class="docutils literal notranslate"><span class="pre">Vectorization</span></code> is optional.
It controls the SIMD operations that can enhance the performance of some computations.
The technique is detailed in Ref. <a class="reference internal" href="../Overview/material.html#beck2019" id="id6"><span>[Beck2019]</span></a> and summarized in <a class="reference internal" href="../Understand/vectorization.html"><span class="doc">this doc</span></a>.
It requires <a class="reference internal" href="installation.html#vectorization-flags"><span class="std std-ref">additional compilation options</span></a> to be actived.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Vectorization</span><span class="p">(</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;adaptive&quot;</span><span class="p">,</span>
    <span class="n">reconfigure_every</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">initial_mode</span> <span class="o">=</span> <span class="s2">&quot;on&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="mode">
<span class="sig-name descname"><span class="pre">mode</span></span><a class="headerlink" href="#mode" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;off&quot;</span></code></p>
</dd>
</dl>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;off&quot;</span></code>: non-vectorized operators are used.
Recommended when the number of particles per cell stays below 10.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;on&quot;</span></code>: vectorized operators are used.
Recommended when the number of particles per cell stays above 10.
Particles are sorted per cell.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;adaptive&quot;</span></code>: the best operators (scalar or vectorized)
are determined and configured dynamically and locally
(per patch and per species). For the moment this mode is only supported in <code class="docutils literal notranslate"><span class="pre">3Dcartesian</span></code> geometry.
Particles are sorted per cell.</p></li>
</ul>
<p>In the <code class="docutils literal notranslate"><span class="pre">&quot;adaptive&quot;</span></code> mode, <a class="reference internal" href="#cluster_width" title="cluster_width"><code class="xref py py-data docutils literal notranslate"><span class="pre">cluster_width</span></code></a> is set to the maximum.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="reconfigure_every">
<span class="sig-name descname"><span class="pre">reconfigure_every</span></span><a class="headerlink" href="#reconfigure_every" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>20</p>
</dd>
</dl>
<p>The number of timesteps between each dynamic reconfiguration of
the vectorized operators, when using the  <code class="docutils literal notranslate"><span class="pre">&quot;adaptive&quot;</span></code> vectorization mode.
It may be set to a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a> as well.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="initial_mode">
<span class="sig-name descname"><span class="pre">initial_mode</span></span><a class="headerlink" href="#initial_mode" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">off</span></code></p>
</dd>
</dl>
<p>Default state when the <code class="docutils literal notranslate"><span class="pre">&quot;adaptive&quot;</span></code> mode is activated
and no particle is present in the patch.</p>
</dd></dl>

<hr class="docutils" />
</section>
<section id="moving-window">
<span id="movingwindow"></span><h2>Moving window<a class="headerlink" href="#moving-window" title="Link to this heading">¶</a></h2>
<p>The simulated domain can move relatively to its the initial position. The “moving window”
is (almost) periodically shifted in the <code class="docutils literal notranslate"><span class="pre">x_max</span></code> direction.
Each “shift” consists in removing a column of patches from the <code class="docutils literal notranslate"><span class="pre">x_min</span></code> border and
adding a new one after the <code class="docutils literal notranslate"><span class="pre">x_max</span></code> border, thus changing the physical domain that the
simulation represents but keeping the same box size. This is particularly useful to
<em>follow</em> waves or plasma moving at high speed.
The frequency of the shifts is adjusted so that the average displacement velocity
over many shifts matches the velocity given by the user.
The user may ask for a given number of additional shifts at a given time.
These additional shifts are not taken into account for the evaluation of the average
velocity of the moving window.</p>
<p>The block <code class="docutils literal notranslate"><span class="pre">MovingWindow</span></code> is optional. The window does not move it you do not define it.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When the window starts moving, all laser injections via Silver-Muller boundary conditions
are immediately stopped for physical correctness.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">MovingWindow</span><span class="p">(</span>
    <span class="n">time_start</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">velocity_x</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">number_of_additional_shifts</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">additional_shifts_time</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="time_start">
<span class="sig-name descname"><span class="pre">time_start</span></span><a class="headerlink" href="#time_start" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Float.</p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><ol class="arabic simple" start="0">
<li></li>
</ol>
</dd>
</dl>
<p>The time at which the window starts moving.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="velocity_x">
<span class="sig-name descname"><span class="pre">velocity_x</span></span><a class="headerlink" href="#velocity_x" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Float.</p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><ol class="arabic simple" start="0">
<li></li>
</ol>
</dd>
</dl>
<p>The average velocity of the moving window in the <code class="docutils literal notranslate"><span class="pre">x_max</span></code> direction. It muste be between 0 and 1.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="number_of_additional_shifts">
<span class="sig-name descname"><span class="pre">number_of_additional_shifts</span></span><a class="headerlink" href="#number_of_additional_shifts" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Integer.</p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><ol class="arabic simple" start="0">
<li></li>
</ol>
</dd>
</dl>
<p>The number of additional shifts of the moving window.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="additional_shifts_time">
<span class="sig-name descname"><span class="pre">additional_shifts_time</span></span><a class="headerlink" href="#additional_shifts_time" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Float.</p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><ol class="arabic simple" start="0">
<li></li>
</ol>
</dd>
</dl>
<p>The time at which the additional shifts are done.</p>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="#diagparticlebinning"><span class="std std-ref">particle binning diagnostics</span></a> accept an “axis” called <code class="docutils literal notranslate"><span class="pre">moving_x</span></code>
corresponding to the <code class="docutils literal notranslate"><span class="pre">x</span></code> coordinate corrected by the moving window’s current movement.</p>
</div>
<hr class="docutils" />
</section>
<section id="current-filtering">
<span id="currentfilter"></span><h2>Current filtering<a class="headerlink" href="#current-filtering" title="Link to this heading">¶</a></h2>
<p>The present version of <strong class="program">Smilei</strong> provides a
<a class="reference internal" href="../Understand/algorithms.html#multipassbinomialfilter"><span class="std std-ref">multi-pass binomial filter</span></a> on the current densities,
which parameters are controlled in the following block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CurrentFilter</span><span class="p">(</span>
    <span class="n">model</span> <span class="o">=</span> <span class="s2">&quot;binomial&quot;</span><span class="p">,</span>
    <span class="n">passes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">kernelFIR</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.25</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#model" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;binomial&quot;</span></code></p>
</dd>
</dl>
<p>The model for current filtering.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;binomial&quot;</span></code> for a binomial filter.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;customFIR&quot;</span></code> for a custom FIR kernel.</p></li>
</ul>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="passes">
<span class="sig-name descname"><span class="pre">passes</span></span><a class="headerlink" href="#passes" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A python list of integers.</p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">[0]</span></code></p>
</dd>
</dl>
<p>The number of passes (at each timestep) given for each dimension.
If the list is of length 1, the same number of passes is assumed for all dimensions.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="kernelFIR">
<span class="sig-name descname"><span class="pre">kernelFIR</span></span><a class="headerlink" href="#kernelFIR" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;[0.25,0.5,0.25]&quot;</span></code></p>
</dd>
</dl>
<p>The FIR kernel for the <code class="docutils literal notranslate"><span class="pre">&quot;customFIR&quot;</span></code> model. The number of coefficients
must be less than twice the number of ghost cells
(adjusted using <a class="reference internal" href="#custom_oversize" title="custom_oversize"><code class="xref py py-data docutils literal notranslate"><span class="pre">custom_oversize</span></code></a>).</p>
</dd></dl>

<hr class="docutils" />
</section>
<section id="field-filtering">
<span id="fieldfilter"></span><h2>Field filtering<a class="headerlink" href="#field-filtering" title="Link to this heading">¶</a></h2>
<p>The present version of <strong class="program">Smilei</strong> provides a method for field filtering
(at the moment, only the <a class="reference internal" href="../Understand/algorithms.html#efieldfilter"><span class="std std-ref">Friedman electric field time-filter</span></a> is available)
which parameters are controlled in the following block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FieldFilter</span><span class="p">(</span>
    <span class="n">model</span> <span class="o">=</span> <span class="s2">&quot;Friedman&quot;</span><span class="p">,</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#id0" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;Friedman&quot;</span></code></p>
</dd>
</dl>
<p>The model for field filtering. Presently, only <code class="docutils literal notranslate"><span class="pre">&quot;Friedman&quot;</span></code> field filtering is available.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="theta">
<span class="sig-name descname"><span class="pre">theta</span></span><a class="headerlink" href="#theta" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">0.</span></code></p>
</dd>
</dl>
<p>The <span class="math notranslate nohighlight">\(\theta\)</span> parameter (between 0 and 1) of Friedman’s method.</p>
</dd></dl>

<hr class="docutils" />
</section>
<section id="species">
<span id="id7"></span><h2>Species<a class="headerlink" href="#species" title="Link to this heading">¶</a></h2>
<p>Each species has to be defined in a <code class="docutils literal notranslate"><span class="pre">Species</span></code> block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Species</span><span class="p">(</span>
    <span class="n">name</span>      <span class="o">=</span> <span class="s2">&quot;electrons1&quot;</span><span class="p">,</span>
    <span class="n">position_initialization</span> <span class="o">=</span> <span class="s2">&quot;random&quot;</span><span class="p">,</span>
    <span class="n">momentum_initialization</span> <span class="o">=</span> <span class="s2">&quot;maxwell-juettner&quot;</span><span class="p">,</span>
    <span class="n">regular_number</span> <span class="o">=</span> <span class="p">[],</span>
    <span class="n">particles_per_cell</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
    <span class="n">mass</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">atomic_number</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="c1">#maximum_charge_state = None,</span>
    <span class="n">number_density</span> <span class="o">=</span> <span class="mf">10.</span><span class="p">,</span>
    <span class="c1"># charge_density = None,</span>
    <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span>
    <span class="n">mean_velocity</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">],</span>
    <span class="c1">#mean_velocity_AM = [0.],</span>
    <span class="n">temperature</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e-10</span><span class="p">],</span>
    <span class="n">boundary_conditions</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">&quot;reflective&quot;</span><span class="p">,</span> <span class="s2">&quot;reflective&quot;</span><span class="p">],</span>
    <span class="c1">#    [&quot;periodic&quot;, &quot;periodic&quot;],</span>
    <span class="c1">#    [&quot;periodic&quot;, &quot;periodic&quot;],</span>
    <span class="p">],</span>
    <span class="c1"># thermal_boundary_temperature = None,</span>
    <span class="c1"># thermal_boundary_velocity = None,</span>
    <span class="n">time_frozen</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="c1"># ionization_model = &quot;none&quot;,</span>
    <span class="c1"># ionization_electrons = None,</span>
    <span class="c1"># ionization_rate = None,</span>
    <span class="n">is_test</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">pusher</span> <span class="o">=</span> <span class="s2">&quot;boris&quot;</span><span class="p">,</span>

    <span class="c1"># Radiation reaction, for particles only:</span>
    <span class="n">radiation_model</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span>
    <span class="n">radiation_photon_species</span> <span class="o">=</span> <span class="s2">&quot;photon&quot;</span><span class="p">,</span>
    <span class="n">radiation_photon_sampling</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">radiation_photon_gamma_threshold</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">radiation_max_emissions</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>

    <span class="c1"># Relativistic field initialization:</span>
    <span class="n">relativistic_field_initialization</span> <span class="o">=</span> <span class="s2">&quot;False&quot;</span><span class="p">,</span>

    <span class="c1"># For photon species only:</span>
    <span class="n">multiphoton_Breit_Wheeler</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;electron&quot;</span><span class="p">,</span><span class="s2">&quot;positron&quot;</span><span class="p">],</span>
    <span class="n">multiphoton_Breit_Wheeler_sampling</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Merging</span>
    <span class="n">merging_method</span> <span class="o">=</span> <span class="s2">&quot;vranic_spherical&quot;</span><span class="p">,</span>
    <span class="n">merge_every</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">merge_min_particles_per_cell</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
    <span class="n">merge_max_packet_size</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">merge_min_packet_size</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">merge_momentum_cell_size</span> <span class="o">=</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#name" title="Link to this definition">¶</a></dt>
<dd><p>The name you want to give to this species.
It should be more than one character and can not start with <code class="docutils literal notranslate"><span class="pre">&quot;m_&quot;</span></code>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="position_initialization">
<span class="sig-name descname"><span class="pre">position_initialization</span></span><a class="headerlink" href="#position_initialization" title="Link to this definition">¶</a></dt>
<dd><p>The method for initialization of particle positions. Options are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;regular&quot;</span></code> for regularly spaced. See <a class="reference internal" href="#id18" title="regular_number"><code class="xref py py-data docutils literal notranslate"><span class="pre">regular_number</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;random&quot;</span></code> for randomly distributed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;centered&quot;</span></code> for centered in each cell (not supported in <code class="docutils literal notranslate"><span class="pre">AMcylindrical</span></code> geometry.</p></li>
<li><p>The <a class="reference internal" href="#id56" title="name"><code class="xref py py-data docutils literal notranslate"><span class="pre">name</span></code></a> of another species from which the positions are copied.
The <em>source</em> species must have positions initialized using one of the three
other options above, and must be defined before this species.</p></li>
<li><p>A <em>numpy</em> array or an <em>HDF5</em> file defining all the positions of the particles.
In this case you must also provide the weight of each particle (see <a class="reference internal" href="../Understand/units.html#weights"><span class="std std-ref">Macro-particle weights</span></a>).
See <a class="reference internal" href="particle_initialization.html"><span class="doc">Initialize particles from an array or a file</span></a>.</p></li>
</ul>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="regular_number">
<span class="sig-name descname"><span class="pre">regular_number</span></span><a class="headerlink" href="#regular_number" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of as many integers as the simulation dimension</p>
</dd>
</dl>
<p>When <code class="docutils literal notranslate"><span class="pre">position_initialization</span> <span class="pre">=</span> <span class="pre">&quot;regular&quot;</span></code>, this sets the number of evenly-spaced
particles per cell in each direction: <code class="docutils literal notranslate"><span class="pre">[Nx,</span> <span class="pre">Ny,</span> <span class="pre">Nz]</span></code> in cartesian geometries and
<code class="docutils literal notranslate"><span class="pre">[Nx,</span> <span class="pre">Nr,</span> <span class="pre">Ntheta]</span></code> in <code class="docutils literal notranslate"><span class="pre">AMcylindrical</span></code> in which case we recommend
<code class="docutils literal notranslate"><span class="pre">Ntheta</span></code> <span class="math notranslate nohighlight">\(\geq 4\times (\)</span> <code class="docutils literal notranslate"><span class="pre">number_of_AM</span></code> <span class="math notranslate nohighlight">\(-1)\)</span>.
If unset, <code class="docutils literal notranslate"><span class="pre">particles_per_cell</span></code> must be a power of the simulation dimension,
for instance, a power of 2 in <code class="docutils literal notranslate"><span class="pre">2Dcartesian</span></code>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="momentum_initialization">
<span class="sig-name descname"><span class="pre">momentum_initialization</span></span><a class="headerlink" href="#momentum_initialization" title="Link to this definition">¶</a></dt>
<dd><p>The method for initialization of particle momenta. Options are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;maxwell-juettner&quot;</span></code> for a relativistic maxwellian (see <a class="reference internal" href="maxwell-juttner.html"><span class="doc">how it is done</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;rectangular&quot;</span></code> for a rectangular distribution</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;cold&quot;</span></code> for zero temperature</p></li>
<li><p>A <em>numpy</em> array or an <em>HDF5</em> file defining all the momenta of the particles.
See <a class="reference internal" href="particle_initialization.html"><span class="doc">Initialize particles from an array or a file</span></a>.</p></li>
</ul>
<p>The first 2 distributions depend on the parameter <a class="reference internal" href="#id14" title="temperature"><code class="xref py py-data docutils literal notranslate"><span class="pre">temperature</span></code></a> explained below.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="particles_per_cell">
<span class="sig-name descname"><span class="pre">particles_per_cell</span></span><a class="headerlink" href="#particles_per_cell" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or <a class="reference internal" href="profiles.html"><span class="doc">profile</span></a></p>
</dd>
</dl>
<p>The number of particles per cell.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="mass">
<span class="sig-name descname"><span class="pre">mass</span></span><a class="headerlink" href="#mass" title="Link to this definition">¶</a></dt>
<dd><p>The mass of particles, in units of the electron mass <span class="math notranslate nohighlight">\(m_e\)</span>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="atomic_number">
<span class="sig-name descname"><span class="pre">atomic_number</span></span><a class="headerlink" href="#atomic_number" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>0</p>
</dd>
</dl>
<p>The atomic number of the particles (must be below 101).
It is required for ionization and nuclear reactions.
It has an effect on collisions by accounting for the atomic screening
(if not defined, or set to 0 for ions, screening is discarded as if
the ion was fully ionized).</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="maximum_charge_state">
<span class="sig-name descname"><span class="pre">maximum_charge_state</span></span><a class="headerlink" href="#maximum_charge_state" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>0</p>
</dd>
</dl>
<p>The maximum charge state of a species for which the ionization model is <code class="docutils literal notranslate"><span class="pre">&quot;from_rate&quot;</span></code>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="number_density">
<span class="sig-name descname"><span class="pre">number_density</span></span><a class="headerlink" href="#number_density" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py" id="charge_density">
<span class="sig-name descname"><span class="pre">charge_density</span></span><a class="headerlink" href="#charge_density" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or <a class="reference internal" href="profiles.html"><span class="doc">profile</span></a></p>
</dd>
</dl>
<p>The absolute value of the charge density or number density (choose one only)
of the particle distribution, in units of the reference density <span class="math notranslate nohighlight">\(N_r\)</span> (see <a class="reference internal" href="../Understand/units.html"><span class="doc">Units</span></a>).</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="charge">
<span class="sig-name descname"><span class="pre">charge</span></span><a class="headerlink" href="#charge" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or <a class="reference internal" href="profiles.html"><span class="doc">profile</span></a></p>
</dd>
</dl>
<p>The particle charge, in units of the elementary charge <span class="math notranslate nohighlight">\(e\)</span>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="mean_velocity">
<span class="sig-name descname"><span class="pre">mean_velocity</span></span><a class="headerlink" href="#mean_velocity" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>a list of 3 floats or <a class="reference internal" href="profiles.html"><span class="doc">profiles</span></a></p>
</dd>
</dl>
<p>The initial drift velocity of the particles, in units of the speed of light <span class="math notranslate nohighlight">\(c\)</span>, in the <cite>x</cite>, <cite>y</cite> and <cite>z</cite> directions.</p>
<p><strong>WARNING</strong>: For massless particles, this is actually the momentum in units of <span class="math notranslate nohighlight">\(m_e c\)</span>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="mean_velocity_AM">
<span class="sig-name descname"><span class="pre">mean_velocity_AM</span></span><a class="headerlink" href="#mean_velocity_AM" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>a list of 3 floats or <a class="reference internal" href="profiles.html"><span class="doc">profiles</span></a></p>
</dd>
</dl>
<p>The initial drift velocity of the particles, in units of the speed of light <span class="math notranslate nohighlight">\(c\)</span>, in the longitudinal, radial and azimuthal directions.
This entry is available only in <code class="docutils literal notranslate"><span class="pre">AMcylindrical</span></code> velocity and cannot be used if also <code class="docutils literal notranslate"><span class="pre">mean_velocity</span></code> is used in the same <code class="docutils literal notranslate"><span class="pre">Species</span></code>: only one of the two can be chosen.</p>
<p><strong>WARNING</strong>: For massless particles, this is actually the momentum in units of <span class="math notranslate nohighlight">\(m_e c\)</span>.</p>
<p><strong>WARNING</strong>: The initial cylindrical drift velocity is applied to each particle, thus it can be computationally demanding.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="temperature">
<span class="sig-name descname"><span class="pre">temperature</span></span><a class="headerlink" href="#temperature" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>a list of 3 floats or <a class="reference internal" href="profiles.html"><span class="doc">profiles</span></a></p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">1e-10</span></code></p>
</dd>
</dl>
<p>The initial temperature of the particles, in units of <span class="math notranslate nohighlight">\(m_ec^2\)</span>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="boundary_conditions">
<span class="sig-name descname"><span class="pre">boundary_conditions</span></span><a class="headerlink" href="#boundary_conditions" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>a list of lists of strings</p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">[[&quot;periodic&quot;]]</span></code></p>
</dd>
</dl>
<p>The boundary conditions for the particles of this species.
Each boundary may have one of the following conditions:
<code class="docutils literal notranslate"><span class="pre">&quot;periodic&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;reflective&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;remove&quot;</span></code> (particles are deleted),
<code class="docutils literal notranslate"><span class="pre">&quot;stop&quot;</span></code> (particle momenta are set to 0), and <code class="docutils literal notranslate"><span class="pre">&quot;thermalize&quot;</span></code>.
For photon species (<code class="docutils literal notranslate"><span class="pre">mass=0</span></code>), the last two options are not available.</p>
<div class="line-block">
<div class="line"><strong>Syntax 1:</strong> <code class="docutils literal notranslate"><span class="pre">[[bc_all]]</span></code>, identical for all boundaries.</div>
<div class="line"><strong>Syntax 2:</strong> <code class="docutils literal notranslate"><span class="pre">[[bc_X],</span> <span class="pre">[bc_Y],</span> <span class="pre">...]</span></code>, different depending on x, y or z.</div>
<div class="line"><strong>Syntax 3:</strong> <code class="docutils literal notranslate"><span class="pre">[[bc_Xmin,</span> <span class="pre">bc_Xmax],</span> <span class="pre">...]</span></code>,  different on each boundary.</div>
</div>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="thermal_boundary_temperature">
<span class="sig-name descname"><span class="pre">thermal_boundary_temperature</span></span><a class="headerlink" href="#thermal_boundary_temperature" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p>A list of floats representing the temperature of the thermal boundaries (those set to
<code class="docutils literal notranslate"><span class="pre">&quot;thermalize&quot;</span></code> in  <a class="reference internal" href="#boundary_conditions" title="boundary_conditions"><code class="xref py py-data docutils literal notranslate"><span class="pre">boundary_conditions</span></code></a>) for each spatial coordinate.
Currently, only the first coordinate (x) is taken into account.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="thermal_boundary_velocity">
<span class="sig-name descname"><span class="pre">thermal_boundary_velocity</span></span><a class="headerlink" href="#thermal_boundary_velocity" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>[]</p>
</dd>
</dl>
<p>A list of floats representing the components of the particles’ drift velocity after
encountering the thermal boundaries (those set to <code class="docutils literal notranslate"><span class="pre">&quot;thermalize&quot;</span></code> in <a class="reference internal" href="#boundary_conditions" title="boundary_conditions"><code class="xref py py-data docutils literal notranslate"><span class="pre">boundary_conditions</span></code></a>).</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="time_frozen">
<span class="sig-name descname"><span class="pre">time_frozen</span></span><a class="headerlink" href="#time_frozen" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><ol class="arabic simple" start="0">
<li></li>
</ol>
</dd>
</dl>
<p>The time during which the particles are “frozen”, in units of <span class="math notranslate nohighlight">\(T_r\)</span>.
Frozen particles do not move and therefore do not deposit any current density either.
Nonetheless, they deposit a charge density.
They are computationally much cheaper than non-frozen particles and oblivious to any EM-fields
in the simulation. Note that frozen particles can be ionized (this is computationally much cheaper
if ion motion is not relevant).</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="ionization_model">
<span class="sig-name descname"><span class="pre">ionization_model</span></span><a class="headerlink" href="#ionization_model" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code></p>
</dd>
</dl>
<p>The model for <a class="reference internal" href="../Understand/ionization.html#field-ionization"><span class="std std-ref">field ionization</span></a>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;tunnel&quot;</span></code> for tunnel ionization using <a class="reference internal" href="../Understand/ionization.html#ppt-adk"><span class="std std-ref">PPT-ADK</span></a> (requires species with an <a class="reference internal" href="#atomic_number" title="atomic_number"><code class="xref py py-data docutils literal notranslate"><span class="pre">atomic_number</span></code></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;tunnel_full_PPT&quot;</span></code> <span class="exp-label">experimental</span> for tunnel ionization using <a class="reference internal" href="../Understand/ionization.html#ppt-adk"><span class="std std-ref">PPT-ADK with account for magnetic number</span></a> (requires species with an <a class="reference internal" href="#atomic_number" title="atomic_number"><code class="xref py py-data docutils literal notranslate"><span class="pre">atomic_number</span></code></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;tunnel_envelope_averaged&quot;</span></code> for <a class="reference internal" href="../Understand/ionization.html#field-ionization-envelope"><span class="std std-ref">field ionization with a laser envelope</span></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;from_rate&quot;</span></code>, relying on a <a class="reference internal" href="../Understand/ionization.html#rate-ionization"><span class="std std-ref">user-defined ionization rate</span></a> (requires species with a <a class="reference internal" href="#maximum_charge_state" title="maximum_charge_state"><code class="xref py py-data docutils literal notranslate"><span class="pre">maximum_charge_state</span></code></a>).</p></li>
</ul>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="bsi_model">
<span class="sig-name descname"><span class="pre">bsi_model</span></span><a class="headerlink" href="#bsi_model" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code></p>
</dd>
</dl>
<p>Apply the <a class="reference internal" href="../Understand/ionization.html#barrier-suppression"><span class="std std-ref">Barrier Suppression Ionization</span></a> correction for ionization in strong fields.
This correction is supported only for <code class="docutils literal notranslate"><span class="pre">ionization_model</span></code> = <code class="docutils literal notranslate"><span class="pre">&quot;tunnel&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">tunnel_full_PPT</span></code>.
The available BSI models are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;Tong_Lin&quot;</span></code> for <a class="reference internal" href="../Understand/ionization.html#tong-lin"><span class="std std-ref">Tong and Lin</span></a>’s rate.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;KAG&quot;</span></code> for <a class="reference internal" href="../Understand/ionization.html#kag"><span class="std std-ref">Kostyukov Artemenko Golovanov</span></a>’s rate.</p></li>
</ul>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="ionization_rate">
<span class="sig-name descname"><span class="pre">ionization_rate</span></span><a class="headerlink" href="#ionization_rate" title="Link to this definition">¶</a></dt>
<dd><p>A python function giving the user-defined ionisation rate as a function of various particle attributes.
To use this option, the <a class="reference external" href="http://www.numpy.org/">numpy package</a> must be available in your python installation.
The function must have one argument, that you may call, for instance, <code class="docutils literal notranslate"><span class="pre">particles</span></code>.
This object has several attributes <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, <code class="docutils literal notranslate"><span class="pre">z</span></code>, <code class="docutils literal notranslate"><span class="pre">px</span></code>, <code class="docutils literal notranslate"><span class="pre">py</span></code>, <code class="docutils literal notranslate"><span class="pre">pz</span></code>, <code class="docutils literal notranslate"><span class="pre">charge</span></code>, <code class="docutils literal notranslate"><span class="pre">weight</span></code> and <code class="docutils literal notranslate"><span class="pre">id</span></code>.
Each of these attributes are provided as <strong>numpy</strong> arrays where each cell corresponds to one particle.</p>
<p>The following example defines, for a species with maximum charge state of 2,
an ionization rate that depends on the initial particle charge
and linear in the x coordinate:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">exp</span><span class="p">,</span> <span class="n">zeros_like</span>

<span class="k">def</span> <span class="nf">my_rate</span><span class="p">(</span><span class="n">particles</span><span class="p">):</span>
    <span class="n">rate</span> <span class="o">=</span> <span class="n">zeros_like</span><span class="p">(</span><span class="n">particles</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
    <span class="n">charge_0</span> <span class="o">=</span> <span class="p">(</span><span class="n">particles</span><span class="o">.</span><span class="n">charge</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">charge_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">particles</span><span class="o">.</span><span class="n">charge</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">rate</span><span class="p">[</span><span class="n">charge_0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span> <span class="o">*</span> <span class="n">particles</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">charge_0</span><span class="p">]</span>
    <span class="n">rate</span><span class="p">[</span><span class="n">charge_1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">*</span> <span class="n">particles</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">charge_1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">rate</span>

<span class="n">Species</span><span class="p">(</span> <span class="o">...</span><span class="p">,</span> <span class="n">ionization_rate</span> <span class="o">=</span> <span class="n">my_rate</span> <span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="ionization_electrons">
<span class="sig-name descname"><span class="pre">ionization_electrons</span></span><a class="headerlink" href="#ionization_electrons" title="Link to this definition">¶</a></dt>
<dd><p>The name of the electron species that <a class="reference internal" href="#ionization_model" title="ionization_model"><code class="xref py py-data docutils literal notranslate"><span class="pre">ionization_model</span></code></a> uses when creating new electrons.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="is_test">
<span class="sig-name descname"><span class="pre">is_test</span></span><a class="headerlink" href="#is_test" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
<p>Flag for test particles. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, this species will contain only test particles
which do not participate in the charge and currents.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pusher">
<span class="sig-name descname"><span class="pre">pusher</span></span><a class="headerlink" href="#pusher" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;boris&quot;</span></code></p>
</dd>
</dl>
<p>Type of pusher to be used for this species. Options are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;boris&quot;</span></code>: The relativistic Boris pusher</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;borisnr&quot;</span></code>: The non-relativistic Boris pusher</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;vay&quot;</span></code>: The relativistic pusher of J. L. Vay</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;higueracary&quot;</span></code>: The relativistic pusher of A. V. Higuera and J. R. Cary</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;norm&quot;</span></code>:  For photon species only (rectilinear propagation)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;ponderomotive_boris&quot;</span></code>: modified relativistic Boris pusher for species interacting with the laser envelope model. Valid only if the species has non-zero mass</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;borisBTIS3&quot;</span></code>: as <code class="docutils literal notranslate"><span class="pre">&quot;boris&quot;</span></code>, but using B fields interpolated with the B-TIS3 scheme.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;ponderomotive_borisBTIS3&quot;</span></code>: as <code class="docutils literal notranslate"><span class="pre">&quot;ponderomotive_boris&quot;</span></code>, but using B fields interpolated with the B-TIS3 scheme.</p></li>
</ul>
<p><strong>WARNING</strong>: <code class="docutils literal notranslate"><span class="pre">&quot;borisBTIS3&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;ponderomotive_borisBTIS3&quot;</span></code> can be used only when <code class="docutils literal notranslate"><span class="pre">use_BTIS3_interpolation=True</span></code> in the <code class="docutils literal notranslate"><span class="pre">Main</span></code> block.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="radiation_model">
<span class="sig-name descname"><span class="pre">radiation_model</span></span><a class="headerlink" href="#radiation_model" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code></p>
</dd>
</dl>
<p>The <strong>radiation reaction</strong> model used for this species (see <a class="reference internal" href="../Understand/radiation_loss.html"><span class="doc">High-energy photon emission &amp; radiation reaction</span></a>).</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>: no radiation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;Landau-Lifshitz&quot;</span></code> (or <code class="docutils literal notranslate"><span class="pre">ll</span></code>): Landau-Lifshitz model approximated for high energies</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;corrected-Landau-Lifshitz&quot;</span></code> (or <code class="docutils literal notranslate"><span class="pre">cll</span></code>): with quantum correction</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;Niel&quot;</span></code>: a <a class="reference external" href="https://arxiv.org/abs/1707.02618">stochastic radiation model</a> based on the work of Niel <cite>et al.</cite>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;Monte-Carlo&quot;</span></code> (or <code class="docutils literal notranslate"><span class="pre">mc</span></code>): Monte-Carlo radiation model. This model can be configured to generate macro-photons with <a class="reference internal" href="#radiation_photon_species" title="radiation_photon_species"><code class="xref py py-data docutils literal notranslate"><span class="pre">radiation_photon_species</span></code></a>.</p></li>
</ul>
<p>This parameter cannot be assigned to photons (mass = 0).</p>
<p>Radiation is emitted only with the <code class="docutils literal notranslate"><span class="pre">&quot;Monte-Carlo&quot;</span></code> model when
<a class="reference internal" href="#radiation_photon_species" title="radiation_photon_species"><code class="xref py py-data docutils literal notranslate"><span class="pre">radiation_photon_species</span></code></a> is defined.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="radiation_photon_species">
<span class="sig-name descname"><span class="pre">radiation_photon_species</span></span><a class="headerlink" href="#radiation_photon_species" title="Link to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#id56" title="name"><code class="xref py py-data docutils literal notranslate"><span class="pre">name</span></code></a> of the photon species in which the Monte-Carlo <a class="reference internal" href="#radiation_model" title="radiation_model"><code class="xref py py-data docutils literal notranslate"><span class="pre">radiation_model</span></code></a>
will generate macro-photons. If unset (or <code class="docutils literal notranslate"><span class="pre">None</span></code>), no macro-photon will be created.
The <em>target</em> photon species must be have its mass set to 0, and appear <em>after</em> the
particle species in the namelist.</p>
<p>This parameter cannot be assigned to photons (mass = 0).</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="radiation_photon_sampling">
<span class="sig-name descname"><span class="pre">radiation_photon_sampling</span></span><a class="headerlink" href="#radiation_photon_sampling" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p>
</dd>
</dl>
<p>The number of macro-photons generated per emission event, when the macro-photon creation
is activated (see <a class="reference internal" href="#radiation_photon_species" title="radiation_photon_species"><code class="xref py py-data docutils literal notranslate"><span class="pre">radiation_photon_species</span></code></a>). The total macro-photon weight
is still conserved.</p>
<p>A large number may rapidly slow down the performances and lead to memory saturation.</p>
<p>This parameter cannot be assigned to photons (mass = 0).</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="radiation_max_emissions">
<span class="sig-name descname"><span class="pre">radiation_max_emissions</span></span><a class="headerlink" href="#radiation_max_emissions" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">10</span></code></p>
</dd>
</dl>
<p>The maximum number of emission Monte-Carlo event a macro-particle can undergo during a timestep.
Since this value is used to allocate some buffers, a high value can saturate memory.</p>
<p>This parameter cannot be assigned to photons (mass = 0).</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="radiation_photon_gamma_threshold">
<span class="sig-name descname"><span class="pre">radiation_photon_gamma_threshold</span></span><a class="headerlink" href="#radiation_photon_gamma_threshold" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p>
</dd>
</dl>
<p>The threshold on the photon energy for the macro-photon emission when using the
radiation reaction Monte-Carlo process.
Under this threshold, the macro-photon from the radiation reaction Monte-Carlo
process is not created but still taken into account in the energy balance.
The default value corresponds to twice the electron rest mass energy that
is the required energy to decay into electron-positron pairs.</p>
<p>This parameter cannot be assigned to photons (mass = 0).</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="relativistic_field_initialization">
<span class="sig-name descname"><span class="pre">relativistic_field_initialization</span></span><a class="headerlink" href="#relativistic_field_initialization" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
<p>Flag for relativistic particles. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the electromagnetic fields of this species will added to the electromagnetic fields already present in the simulation.
This operation will be performed when time equals <a class="reference internal" href="#id35" title="time_frozen"><code class="xref py py-data docutils literal notranslate"><span class="pre">time_frozen</span></code></a>. See <a class="reference internal" href="../Understand/relativistic_fields_initialization.html"><span class="doc">Field initialization for relativistic species</span></a> for details on the computation of the electromagentic fields of a relativistic species.
To have physically meaningful results, we recommend to place a species which requires this method of field initialization far from other species, otherwise the latter could experience instantly turned-on unphysical forces by the relativistic species’ fields.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="multiphoton_Breit_Wheeler">
<span class="sig-name descname"><span class="pre">multiphoton_Breit_Wheeler</span></span><a class="headerlink" href="#multiphoton_Breit_Wheeler" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">[None,None]</span></code></p>
</dd>
</dl>
<p>An list of the <a class="reference internal" href="#id56" title="name"><code class="xref py py-data docutils literal notranslate"><span class="pre">name</span></code></a> of two species: electrons and positrons created through
the <a class="reference internal" href="../Understand/multiphoton_Breit_Wheeler.html"><span class="doc">Multiphoton Breit-Wheeler pair creation</span></a>.
By default, the process is not activated.</p>
<p>This parameter can <strong>only</strong> be assigned to photons species (mass = 0).</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="multiphoton_Breit_Wheeler_sampling">
<span class="sig-name descname"><span class="pre">multiphoton_Breit_Wheeler_sampling</span></span><a class="headerlink" href="#multiphoton_Breit_Wheeler_sampling" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">[1,1]</span></code></p>
</dd>
</dl>
<p>A list of two integers: the number of electrons and positrons generated per photon decay
in the <a class="reference internal" href="../Understand/multiphoton_Breit_Wheeler.html"><span class="doc">Multiphoton Breit-Wheeler pair creation</span></a>. The total macro-particle weight is still
conserved.</p>
<p>Large numbers may rapidly slow down the performances and lead to memory saturation.</p>
<p>This parameter can <strong>only</strong> be assigned to photons species (mass = 0).</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="keep_interpolated_fields">
<span class="sig-name descname"><span class="pre">keep_interpolated_fields</span></span><a class="headerlink" href="#keep_interpolated_fields" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">[]</span></code></p>
</dd>
</dl>
<p>A list of interpolated fields that should be stored in memory for all particles of this species,
instead of being located in temporary buffers. These fields can then
be accessed in some diagnostics such as <a class="reference internal" href="#diagparticlebinning"><span class="std std-ref">particle binning</span></a> or
<a class="reference internal" href="#diagtrackparticles"><span class="std std-ref">tracking</span></a>. The available fields are <code class="docutils literal notranslate"><span class="pre">&quot;Ex&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Ey&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Ez&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;Bx&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;By&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;Bz&quot;</span></code>.</p>
<p>Note that magnetic field components, as they originate from the interpolator,
are shifted by half a timestep compared to those from the <em>Fields</em> diagnostics.</p>
<p>Additionally, the work done by each component of the electric field is available as
<code class="docutils literal notranslate"><span class="pre">&quot;Wx&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Wy&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;Wz&quot;</span></code>. Contrary to the other interpolated fields, these quantities
are accumulated over time.</p>
</dd></dl>

<hr class="docutils" />
</section>
<section id="particle-injector">
<span id="id8"></span><h2>Particle Injector<a class="headerlink" href="#particle-injector" title="Link to this heading">¶</a></h2>
<p>Injectors enable to inject macro-particles in the simulation domain from the boundaries.
By default, some parameters that are not specified are inherited from the associated <a class="reference internal" href="#id62" title="species"><code class="xref py py-data docutils literal notranslate"><span class="pre">species</span></code></a>.</p>
<p>Each particle injector has to be defined in a <code class="docutils literal notranslate"><span class="pre">ParticleInjector</span></code> block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ParticleInjector</span><span class="p">(</span>
    <span class="n">name</span>      <span class="o">=</span> <span class="s2">&quot;injector1&quot;</span><span class="p">,</span>
    <span class="n">species</span>   <span class="o">=</span> <span class="s2">&quot;electrons1&quot;</span><span class="p">,</span>
    <span class="n">box_side</span>  <span class="o">=</span> <span class="s2">&quot;xmin&quot;</span><span class="p">,</span>
    <span class="n">time_envelope</span> <span class="o">=</span> <span class="n">tgaussian</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span>

    <span class="c1"># Parameters inherited from the associated ``species`` by default</span>

    <span class="n">position_initialization</span> <span class="o">=</span> <span class="s2">&quot;species&quot;</span><span class="p">,</span>
    <span class="n">momentum_initialization</span> <span class="o">=</span> <span class="s2">&quot;rectangular&quot;</span><span class="p">,</span>
    <span class="n">mean_velocity</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>
    <span class="n">temperature</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e-30</span><span class="p">],</span>
    <span class="n">number_density</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">particles_per_cell</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="id9">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#id9" title="Link to this definition">¶</a></dt>
<dd><p>The name you want to give to this injector.
If you do not specify a name, it will be attributed automatically.
The name is useful if you want to inject particles at the same position of another injector.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id10">
<span class="sig-name descname"><span class="pre">species</span></span><a class="headerlink" href="#id10" title="Link to this definition">¶</a></dt>
<dd><p>The name of the species in which to inject the new particles</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="box_side">
<span class="sig-name descname"><span class="pre">box_side</span></span><a class="headerlink" href="#box_side" title="Link to this definition">¶</a></dt>
<dd><p>From where the macro-particles are injected. Options are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;xmin&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;xmax&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;ymin&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;ymax&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;zmax&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;zmin&quot;</span></code></p></li>
</ul>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="time_envelope">
<span class="sig-name descname"><span class="pre">time_envelope</span></span><a class="headerlink" href="#time_envelope" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>a <em>python</em> function or a <a class="reference internal" href="profiles.html"><span class="doc">time profile</span></a></p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">tconstant()</span></code></p>
</dd>
</dl>
<p>The temporal envelope of the injector.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id11">
<span class="sig-name descname"><span class="pre">position_initialization</span></span><a class="headerlink" href="#id11" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>parameters provided the species</p>
</dd>
</dl>
<p>The method for initialization of particle positions. Options are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;species&quot;</span></code> or empty <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code>: injector uses the option of the specified <a class="reference internal" href="#id62" title="species"><code class="xref py py-data docutils literal notranslate"><span class="pre">species</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;regular&quot;</span></code> for regularly spaced. See <a class="reference internal" href="#id18" title="regular_number"><code class="xref py py-data docutils literal notranslate"><span class="pre">regular_number</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;random&quot;</span></code> for randomly distributed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;centered&quot;</span></code> for centered in each cell</p></li>
<li><p>The <a class="reference internal" href="#id56" title="name"><code class="xref py py-data docutils literal notranslate"><span class="pre">name</span></code></a> of another injector from which the positions are copied.
This option requires (1) that the <em>target</em> injector’s positions are initialized
using one of the three other options above.</p></li>
</ul>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id12">
<span class="sig-name descname"><span class="pre">momentum_initialization</span></span><a class="headerlink" href="#id12" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>parameters provided the species</p>
</dd>
</dl>
<p>The method for initialization of particle momenta. Options are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;species&quot;</span></code> or empty <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code>: injector uses the option of the specified <a class="reference internal" href="#id62" title="species"><code class="xref py py-data docutils literal notranslate"><span class="pre">species</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;maxwell-juettner&quot;</span></code> for a relativistic maxwellian (see <a class="reference internal" href="maxwell-juttner.html"><span class="doc">how it is done</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;rectangular&quot;</span></code> for a rectangular distribution</p></li>
</ul>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id13">
<span class="sig-name descname"><span class="pre">mean_velocity</span></span><a class="headerlink" href="#id13" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>a list of 3 floats or <a class="reference internal" href="profiles.html"><span class="doc">profiles</span></a></p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><p>parameters provided the species</p>
</dd>
</dl>
<p>The initial drift velocity of the particles, in units of the speed of light <span class="math notranslate nohighlight">\(c\)</span>.</p>
<p><strong>WARNING</strong>: For massless particles, this is actually the momentum in units of <span class="math notranslate nohighlight">\(m_e c\)</span>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id14">
<span class="sig-name descname"><span class="pre">temperature</span></span><a class="headerlink" href="#id14" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>a list of 3 floats or <a class="reference internal" href="profiles.html"><span class="doc">profiles</span></a></p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><p>parameters provided the species</p>
</dd>
</dl>
<p>The initial temperature of the particles, in units of <span class="math notranslate nohighlight">\(m_ec^2\)</span>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id15">
<span class="sig-name descname"><span class="pre">particles_per_cell</span></span><a class="headerlink" href="#id15" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or <a class="reference internal" href="profiles.html"><span class="doc">profile</span></a></p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><p>parameters provided the species</p>
</dd>
</dl>
<p>The number of particles per cell to use for the injector.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id16">
<span class="sig-name descname"><span class="pre">number_density</span></span><a class="headerlink" href="#id16" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py" id="id17">
<span class="sig-name descname"><span class="pre">charge_density</span></span><a class="headerlink" href="#id17" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or <a class="reference internal" href="profiles.html"><span class="doc">profile</span></a></p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><p>parameters provided the species</p>
</dd>
</dl>
<p>The absolute value of the number density or charge density (choose one only)
of the particle distribution, in units of the reference density <span class="math notranslate nohighlight">\(N_r\)</span> (see <a class="reference internal" href="../Understand/units.html"><span class="doc">Units</span></a>)</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id18">
<span class="sig-name descname"><span class="pre">regular_number</span></span><a class="headerlink" href="#id18" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of as many integers as the simulation dimension</p>
</dd>
</dl>
<p>Same as for <a class="reference internal" href="#species"><span class="std std-ref">Species</span></a>. When <code class="docutils literal notranslate"><span class="pre">position_initialization</span> <span class="pre">=</span> <span class="pre">&quot;regular&quot;</span></code>, this sets the number of evenly-spaced
particles per cell in each direction: <code class="docutils literal notranslate"><span class="pre">[Nx,</span> <span class="pre">Ny,</span> <span class="pre">Nz]</span></code> in cartesian geometries.</p>
</dd></dl>

<hr class="docutils" />
</section>
<section class="experimental" id="particle-merging">
<span id="id19"></span><h2>Particle Merging<a class="headerlink" href="#particle-merging" title="Link to this heading">¶</a></h2>
<p>The macro-particle merging method is documented in
the <a class="reference internal" href="../Understand/particle_merging.html"><span class="doc">corresponding page</span></a>.
Note that for merging to be able to operate either vectorization or cell sorting must be activated.
It is optionnally specified in the <code class="docutils literal notranslate"><span class="pre">Species</span></code> block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Species</span><span class="p">(</span>
    <span class="o">....</span>

    <span class="c1"># Merging</span>
    <span class="n">merging_method</span> <span class="o">=</span> <span class="s2">&quot;vranic_spherical&quot;</span><span class="p">,</span>
    <span class="n">merge_every</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">merge_min_particles_per_cell</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
    <span class="n">merge_max_packet_size</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">merge_min_packet_size</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
    <span class="n">merge_momentum_cell_size</span> <span class="o">=</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">16</span><span class="p">],</span>
    <span class="n">merge_discretization_scale</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span>
    <span class="c1"># Extra parameters for experts:</span>
    <span class="n">merge_min_momentum_cell_length</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e-10</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">],</span>
    <span class="n">merge_accumulation_correction</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="merging_method">
<span class="sig-name descname"><span class="pre">merging_method</span></span><a class="headerlink" href="#merging_method" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code></p>
</dd>
</dl>
<p>The particle merging method to use:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>: no merging</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;vranic_cartesian&quot;</span></code>: method of M. Vranic with a cartesian momentum-space decomposition</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;vranic_spherical&quot;</span></code>: method of M. Vranic with a spherical momentum-space decomposition</p></li>
</ul>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="merge_every">
<span class="sig-name descname"><span class="pre">merge_every</span></span><a class="headerlink" href="#merge_every" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p>Number of timesteps between each merging event
<strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="min_particles_per_cell">
<span class="sig-name descname"><span class="pre">min_particles_per_cell</span></span><a class="headerlink" href="#min_particles_per_cell" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">4</span></code></p>
</dd>
</dl>
<p>The minimum number of particles per cell for the merging.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="merge_min_packet_size">
<span class="sig-name descname"><span class="pre">merge_min_packet_size</span></span><a class="headerlink" href="#merge_min_packet_size" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">4</span></code></p>
</dd>
</dl>
<p>The minimum number of particles per packet to merge. Must be greater or equal to 4.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="merge_max_packet_size">
<span class="sig-name descname"><span class="pre">merge_max_packet_size</span></span><a class="headerlink" href="#merge_max_packet_size" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">4</span></code></p>
</dd>
</dl>
<p>The maximum number of particles per packet to merge.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="merge_momentum_cell_size">
<span class="sig-name descname"><span class="pre">merge_momentum_cell_size</span></span><a class="headerlink" href="#merge_momentum_cell_size" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">[16,16,16]</span></code></p>
</dd>
</dl>
<p>A list of 3 integers defining the number of sub-groups in each direction
for the momentum-space discretization.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="merge_discretization_scale">
<span class="sig-name descname"><span class="pre">merge_discretization_scale</span></span><a class="headerlink" href="#merge_discretization_scale" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;linear&quot;</span></code></p>
</dd>
</dl>
<p>The momentum discretization scale:: <code class="docutils literal notranslate"><span class="pre">&quot;linear&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;log&quot;</span></code>.
The <code class="docutils literal notranslate"><span class="pre">&quot;log&quot;</span></code> scale only works with the spherical discretization at the moment.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="merge_min_momentum">
<span class="sig-name descname"><span class="pre">merge_min_momentum</span></span><a class="headerlink" href="#merge_min_momentum" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">1e-5</span></code></p>
</dd>
</dl>
<p><span class="red">[for experts]</span> The minimum momentum value when the log scale
is chosen (<code class="docutils literal notranslate"><span class="pre">merge_discretization_scale</span> <span class="pre">=</span> <span class="pre">log</span></code>).
This avoids a potential 0 value in the log domain.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="merge_min_momentum_cell_length">
<span class="sig-name descname"><span class="pre">merge_min_momentum_cell_length</span></span><a class="headerlink" href="#merge_min_momentum_cell_length" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">[1e-10,1e-10,1e-10]</span></code></p>
</dd>
</dl>
<p><span class="red">[for experts]</span> The minimum sub-group length for the momentum-space
discretization (below which the number of sub-groups is set to 1).</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="merge_accumulation_correction">
<span class="sig-name descname"><span class="pre">merge_accumulation_correction</span></span><a class="headerlink" href="#merge_accumulation_correction" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</dd>
</dl>
<p><span class="red">[for experts]</span> Activates the accumulation correction
(see <a class="reference internal" href="../Understand/particle_merging.html"><span class="doc">Particle Merging</span></a> for more information).
The correction only works in linear scale.</p>
</dd></dl>

<hr class="docutils" />
</section>
<section id="lasers">
<span id="id20"></span><h2>Lasers<a class="headerlink" href="#lasers" title="Link to this heading">¶</a></h2>
<p>A laser consists in applying oscillating boundary conditions for the magnetic
field on one of the box sides. The only boundary conditions that support lasers
are <code class="docutils literal notranslate"><span class="pre">&quot;silver-muller&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;PML&quot;</span></code> (see <a class="reference internal" href="#EM_boundary_conditions" title="EM_boundary_conditions"><code class="xref py py-data docutils literal notranslate"><span class="pre">EM_boundary_conditions</span></code></a>).
There are several syntaxes to introduce a laser in <strong class="program">Smilei</strong>:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following definitions are given for lasers incoming from the <code class="docutils literal notranslate"><span class="pre">xmin</span></code> or <code class="docutils literal notranslate"><span class="pre">xmax</span></code>
boundaries. For lasers incoming from <code class="docutils literal notranslate"><span class="pre">ymin</span></code> or <code class="docutils literal notranslate"><span class="pre">ymax</span></code>, replace the <code class="docutils literal notranslate"><span class="pre">By</span></code>
profiles by <code class="docutils literal notranslate"><span class="pre">Bx</span></code> profiles. For lasers incoming from <code class="docutils literal notranslate"><span class="pre">zmin</span></code> or <code class="docutils literal notranslate"><span class="pre">zmax</span></code>,
replace <code class="docutils literal notranslate"><span class="pre">By</span></code> and <code class="docutils literal notranslate"><span class="pre">Bz</span></code> profiles by <code class="docutils literal notranslate"><span class="pre">Bx</span></code> and <code class="docutils literal notranslate"><span class="pre">By</span></code> profiles, respectively.</p>
</div>
<p class="rubric">1. Defining a generic wave</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Laser</span><span class="p">(</span>
    <span class="n">box_side</span> <span class="o">=</span> <span class="s2">&quot;xmin&quot;</span><span class="p">,</span>
    <span class="n">space_time_profile</span> <span class="o">=</span> <span class="p">[</span> <span class="n">By_profile</span><span class="p">,</span> <span class="n">Bz_profile</span> <span class="p">]</span>
    <span class="n">space_time_profile_AM</span> <span class="o">=</span> <span class="p">[</span> <span class="n">Br_mode0</span><span class="p">,</span> <span class="n">Bt_mode0</span><span class="p">,</span> <span class="n">Br_mode1</span><span class="p">,</span> <span class="n">Bt_mode1</span><span class="p">,</span> <span class="o">...</span> <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<dl class="py data">
<dt class="sig sig-object py" id="id21">
<span class="sig-name descname"><span class="pre">box_side</span></span><a class="headerlink" href="#id21" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;xmin&quot;</span></code></p>
</dd>
</dl>
<p>Side of the box from which the laser originates: <code class="docutils literal notranslate"><span class="pre">&quot;xmin&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;xmax&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;ymin&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;ymax&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;zmin&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;zmax&quot;</span></code>.</p>
<p>In the cases of <code class="docutils literal notranslate"><span class="pre">&quot;ymin&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;ymax&quot;</span></code>, replace, in the following profiles,
coordinates <em>y</em> by <em>x</em>, and fields <span class="math notranslate nohighlight">\(B_y\)</span> by <span class="math notranslate nohighlight">\(B_x\)</span>.</p>
<p>In the cases of <code class="docutils literal notranslate"><span class="pre">&quot;zmin&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;zmax&quot;</span></code>, replace, in the following profiles,
coordinates <em>y</em> by <em>x</em>, coordinates <em>z</em> by <em>y</em>, fields <span class="math notranslate nohighlight">\(B_y\)</span> by <span class="math notranslate nohighlight">\(B_x\)</span>
and fields <span class="math notranslate nohighlight">\(B_z\)</span> by <span class="math notranslate nohighlight">\(B_y\)</span>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="space_time_profile">
<span class="sig-name descname"><span class="pre">space_time_profile</span></span><a class="headerlink" href="#space_time_profile" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of two <em>python</em> functions</p>
</dd>
</dl>
<p>The full wave expression at the chosen box side. It is a list of <strong>two</strong> <em>python</em>
functions taking several arguments depending on the simulation dimension:
<span class="math notranslate nohighlight">\((t)\)</span> for a 1-D simulation, <span class="math notranslate nohighlight">\((y,t)\)</span> for a 2-D simulation (etc.)
The two functions represent <span class="math notranslate nohighlight">\(B_y\)</span> and <span class="math notranslate nohighlight">\(B_z\)</span>, respectively.
This can be used only in Cartesian geometries.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="space_time_profile_AM">
<span class="sig-name descname"><span class="pre">space_time_profile_AM</span></span><a class="headerlink" href="#space_time_profile_AM" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of maximum 2 x <code class="docutils literal notranslate"><span class="pre">number_of_AM</span></code> complex valued <em>python</em> functions.</p>
</dd>
</dl>
<p>These profiles define the first modes of <span class="math notranslate nohighlight">\(B_r\)</span> and <span class="math notranslate nohighlight">\(B_\theta\)</span> of the laser in the
order shown in the above example. Higher undefined modes are considered zero.
This can be used only in <code class="docutils literal notranslate"><span class="pre">AMcylindrical</span></code> geometry. In this
geometry a two-dimensional <span class="math notranslate nohighlight">\((x,r)\)</span> grid is used and the laser is injected from a
<span class="math notranslate nohighlight">\(x\)</span> boundary, thus the provided profiles must be a function of <span class="math notranslate nohighlight">\((r,t)\)</span>.</p>
</dd></dl>

<p class="rubric">2. Defining the wave envelopes</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Laser</span><span class="p">(</span>
    <span class="n">box_side</span>       <span class="o">=</span> <span class="s2">&quot;xmin&quot;</span><span class="p">,</span>
    <span class="n">omega</span>          <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">chirp_profile</span>  <span class="o">=</span> <span class="n">tconstant</span><span class="p">(),</span>
    <span class="n">time_envelope</span>  <span class="o">=</span> <span class="n">tgaussian</span><span class="p">(),</span>
    <span class="n">space_envelope</span> <span class="o">=</span> <span class="p">[</span> <span class="n">By_profile</span>  <span class="p">,</span> <span class="n">Bz_profile</span>   <span class="p">],</span>
    <span class="n">phase</span>          <span class="o">=</span> <span class="p">[</span> <span class="n">PhiY_profile</span><span class="p">,</span> <span class="n">PhiZ_profile</span> <span class="p">],</span>
    <span class="n">delay_phase</span>    <span class="o">=</span> <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span> <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This implements a wave of the form:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}B_y(\mathbf{x}, t) = S_y(\mathbf{x})\; T\left(t-t_{0y}\right)
\;\sin\left( \omega(t) t - \phi_y(\mathbf{x}) \right)\\B_z(\mathbf{x}, t) = S_z(\mathbf{x})\; T\left(t-t_{0z}\right)
\;\sin\left( \omega(t) t - \phi_z(\mathbf{x}) \right)\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\(T\)</span> is the temporal envelope, <span class="math notranslate nohighlight">\(S_y\)</span> and <span class="math notranslate nohighlight">\(S_z\)</span> are the
spatial envelopes, <span class="math notranslate nohighlight">\(\omega\)</span> is the time-varying frequency,
<span class="math notranslate nohighlight">\(\phi_y\)</span> and <span class="math notranslate nohighlight">\(\phi_z\)</span> are the phases, and we defined the delays
<span class="math notranslate nohighlight">\(t_{0y} = (\phi_y(\mathbf{x})-\varphi_y)/\omega(t)\)</span> and
<span class="math notranslate nohighlight">\(t_{0z} = (\phi_z(\mathbf{x})-\varphi_z)/\omega(t)\)</span>.</p>
<dl class="py data">
<dt class="sig sig-object py" id="omega">
<span class="sig-name descname"><span class="pre">omega</span></span><a class="headerlink" href="#omega" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><ol class="arabic simple">
<li></li>
</ol>
</dd>
</dl>
<p>The laser angular frequency.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="chirp_profile">
<span class="sig-name descname"><span class="pre">chirp_profile</span></span><a class="headerlink" href="#chirp_profile" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>a <em>python</em> function or a <a class="reference internal" href="profiles.html"><span class="doc">time profile</span></a></p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">tconstant()</span></code></p>
</dd>
</dl>
<p>The variation of the laser frequency over time, such that
<span class="math notranslate nohighlight">\(\omega(t)=\)</span> <code class="docutils literal notranslate"><span class="pre">omega</span></code> x <code class="docutils literal notranslate"><span class="pre">chirp_profile</span></code> <span class="math notranslate nohighlight">\((t)\)</span>.</p>
</dd></dl>

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This definition of the chirp profile is not standard.
Indeed, <span class="math notranslate nohighlight">\(\omega(t)\)</span> as defined here <strong>is not</strong> the instantaneous frequency, <span class="math notranslate nohighlight">\(\omega_{\rm inst}(t)\)</span>,
which is obtained from the time derivative of the phase <span class="math notranslate nohighlight">\(\omega(t) t\)</span>.</p>
<p>Should one define the chirp as <span class="math notranslate nohighlight">\(C(t) = \omega_{\rm inst}(t)/\omega\)</span> (with <span class="math notranslate nohighlight">\(\omega\)</span> defined by the input
parameter <span class="math notranslate nohighlight">\(\mathtt{omega}\)</span>), the user can easily obtain the corresponding chirp profile as defined in
<strong class="program">Smilei</strong> as:</p>
<div class="math notranslate nohighlight">
\[\mathtt{chirp\_profile}(t) = \frac{1}{t} \int_0^t dt' C(t')\,.\]</div>
<p>Let us give as an example the case of a <em>linear chirp</em>, with the instantaneous frequency
<span class="math notranslate nohighlight">\(\omega_{\rm inst}(t) = \omega [1+\alpha\,\omega(t-t_0)]\)</span>.
<span class="math notranslate nohighlight">\(C(t) = 1+\alpha\,\omega(t-t_0)\)</span>. The corresponding input chirp profile reads:</p>
<div class="math notranslate nohighlight">
\[\mathtt{chirp\_profile}(t) = 1 - \alpha\, \omega t_0 + \frac{\alpha}{2} \omega t\]</div>
<p>Similarly, for a <em>geometric (exponential) chirp</em> such that <span class="math notranslate nohighlight">\(\omega_{\rm inst}(t) = \omega\, \alpha^{\omega t}\)</span>,
<span class="math notranslate nohighlight">\(C(t) = \alpha^{\omega t}\)</span>, and the corresponding input chirp profile reads:</p>
<div class="math notranslate nohighlight">
\[\mathtt{chirp\_profile}(t) = \frac{\alpha^{\omega t} - 1}{\omega t \, \ln \alpha}\,.\]</div>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="id22">
<span class="sig-name descname"><span class="pre">time_envelope</span></span><a class="headerlink" href="#id22" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>a <em>python</em> function or a <a class="reference internal" href="profiles.html"><span class="doc">time profile</span></a></p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">tconstant()</span></code></p>
</dd>
</dl>
<p>The temporal envelope of the laser (field, not intensity).</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="space_envelope">
<span class="sig-name descname"><span class="pre">space_envelope</span></span><a class="headerlink" href="#space_envelope" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>a list of two <em>python</em> functions or two <a class="reference internal" href="profiles.html"><span class="doc">spatial profiles</span></a></p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">1.,</span> <span class="pre">0.</span> <span class="pre">]</span></code></p>
</dd>
</dl>
<p>The two spatial envelopes <span class="math notranslate nohighlight">\(S_y\)</span> and <span class="math notranslate nohighlight">\(S_z\)</span>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="phase">
<span class="sig-name descname"><span class="pre">phase</span></span><a class="headerlink" href="#phase" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>a list of two <em>python</em> functions or two <a class="reference internal" href="profiles.html"><span class="doc">spatial profiles</span></a></p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">0.,</span> <span class="pre">0.</span> <span class="pre">]</span></code></p>
</dd>
</dl>
<p>The two spatially-varying phases <span class="math notranslate nohighlight">\(\phi_y\)</span> and <span class="math notranslate nohighlight">\(\phi_z\)</span>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="delay_phase">
<span class="sig-name descname"><span class="pre">delay_phase</span></span><a class="headerlink" href="#delay_phase" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>a list of two floats</p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">0.,</span> <span class="pre">0.</span> <span class="pre">]</span></code></p>
</dd>
</dl>
<p>An extra delay for the time envelopes of <span class="math notranslate nohighlight">\(B_y\)</span> and <span class="math notranslate nohighlight">\(B_z\)</span>,
expressed in terms of phase (<span class="math notranslate nohighlight">\(=\omega t\)</span>). This delay is applied to the
<a class="reference internal" href="#id27" title="time_envelope"><code class="xref py py-data docutils literal notranslate"><span class="pre">time_envelope</span></code></a>, but not to the carrier wave.
This option is useful in the
case of elliptical polarization where the two temporal profiles should have a slight
delay due to the mismatched <a class="reference internal" href="#phase" title="phase"><code class="xref py py-data docutils literal notranslate"><span class="pre">phase</span></code></a>.</p>
</dd></dl>

</div></blockquote>
<p class="rubric">3. Defining a 1D planar wave</p>
<blockquote>
<div><p>For one-dimensional simulations, you may use the simplified laser creator:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LaserPlanar1D</span><span class="p">(</span>
    <span class="n">box_side</span>         <span class="o">=</span> <span class="s2">&quot;xmin&quot;</span><span class="p">,</span>
    <span class="n">a0</span>               <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">omega</span>            <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">polarization_phi</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">ellipticity</span>      <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">time_envelope</span>    <span class="o">=</span> <span class="n">tconstant</span><span class="p">(),</span>
    <span class="n">phase_offset</span>     <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="a0">
<span class="sig-name descname"><span class="pre">a0</span></span><a class="headerlink" href="#a0" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><ol class="arabic simple">
<li></li>
</ol>
</dd>
</dl>
<p>The normalized vector potential</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="polarization_phi">
<span class="sig-name descname"><span class="pre">polarization_phi</span></span><a class="headerlink" href="#polarization_phi" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><ol class="arabic simple" start="0">
<li></li>
</ol>
</dd>
</dl>
<p>The angle of the polarization ellipse major axis relative to the X-Y plane, in radians.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="ellipticity">
<span class="sig-name descname"><span class="pre">ellipticity</span></span><a class="headerlink" href="#ellipticity" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><ol class="arabic simple" start="0">
<li></li>
</ol>
</dd>
</dl>
<p>The polarization ellipticity: 0 for linear and <span class="math notranslate nohighlight">\(\pm 1\)</span> for circular.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="phase_offset">
<span class="sig-name descname"><span class="pre">phase_offset</span></span><a class="headerlink" href="#phase_offset" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><ol class="arabic simple" start="0">
<li></li>
</ol>
</dd>
</dl>
<p>An extra phase added to both the envelope and to the carrier wave.</p>
</dd></dl>

</div></blockquote>
<p class="rubric">4. Defining a 2D gaussian wave</p>
<blockquote>
<div><p>For two-dimensional simulations, you may use the simplified laser creator:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LaserGaussian2D</span><span class="p">(</span>
    <span class="n">box_side</span>         <span class="o">=</span> <span class="s2">&quot;xmin&quot;</span><span class="p">,</span>
    <span class="n">a0</span>               <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">omega</span>            <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">focus</span>            <span class="o">=</span> <span class="p">[</span><span class="mf">50.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">],</span>
    <span class="n">waist</span>            <span class="o">=</span> <span class="mf">3.</span><span class="p">,</span>
    <span class="n">incidence_angle</span>  <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">polarization_phi</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">ellipticity</span>      <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">time_envelope</span>    <span class="o">=</span> <span class="n">tconstant</span><span class="p">(),</span>
    <span class="n">phase_offset</span>     <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This is similar to <code class="docutils literal notranslate"><span class="pre">LaserPlanar1D</span></code>, with some additional arguments for
specific 2D aspects.</p>
<dl class="py data">
<dt class="sig sig-object py" id="focus">
<span class="sig-name descname"><span class="pre">focus</span></span><a class="headerlink" href="#focus" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of two floats <code class="docutils literal notranslate"><span class="pre">[X,</span> <span class="pre">Y]</span></code></p>
</dd>
</dl>
<p>The <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">Y</span></code> positions of the laser focus.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="waist">
<span class="sig-name descname"><span class="pre">waist</span></span><a class="headerlink" href="#waist" title="Link to this definition">¶</a></dt>
<dd><p>The waist value. Transverse coordinate at which the field is at 1/e of its maximum value.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="incidence_angle">
<span class="sig-name descname"><span class="pre">incidence_angle</span></span><a class="headerlink" href="#incidence_angle" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><ol class="arabic simple" start="0">
<li></li>
</ol>
</dd>
</dl>
<p>The angle of the laser beam relative to the normal to the injection plane, in radians.</p>
</dd></dl>

</div></blockquote>
<p class="rubric">5. Defining a 3D gaussian wave</p>
<blockquote>
<div><p>For three-dimensional simulations, you may use the simplified laser creator:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LaserGaussian3D</span><span class="p">(</span>
    <span class="n">box_side</span>         <span class="o">=</span> <span class="s2">&quot;xmin&quot;</span><span class="p">,</span>
    <span class="n">a0</span>               <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">omega</span>            <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">focus</span>            <span class="o">=</span> <span class="p">[</span><span class="mf">50.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">],</span>
    <span class="n">waist</span>            <span class="o">=</span> <span class="mf">3.</span><span class="p">,</span>
    <span class="n">incidence_angle</span>  <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
    <span class="n">polarization_phi</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">ellipticity</span>      <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">time_envelope</span>    <span class="o">=</span> <span class="n">tconstant</span><span class="p">(),</span>
    <span class="n">phase_offset</span>     <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This is almost the same as <code class="docutils literal notranslate"><span class="pre">LaserGaussian2D</span></code>, with the <code class="docutils literal notranslate"><span class="pre">focus</span></code> parameter having
now 3 elements (focus position in 3D), and the <code class="docutils literal notranslate"><span class="pre">incidence_angle</span></code> being a list of
two angles, corresponding to rotations around <code class="docutils literal notranslate"><span class="pre">y</span></code> and <code class="docutils literal notranslate"><span class="pre">z</span></code>, respectively.</p>
<p>When injecting on <code class="docutils literal notranslate"><span class="pre">&quot;ymin&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;ymax&quot;</span></code>, the incidence angles corresponds to
rotations around <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">z</span></code>, respectively.</p>
</div></blockquote>
<p class="rubric">6. Defining a gaussian wave with Azimuthal Fourier decomposition</p>
<blockquote>
<div><p>For simulations with <code class="docutils literal notranslate"><span class="pre">&quot;AMcylindrical&quot;</span></code> geometry, you may use the simplified laser creator:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LaserGaussianAM</span><span class="p">(</span>
    <span class="n">box_side</span>         <span class="o">=</span> <span class="s2">&quot;xmin&quot;</span><span class="p">,</span>
    <span class="n">a0</span>               <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">omega</span>            <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">focus</span>            <span class="o">=</span> <span class="p">[</span><span class="mf">50.</span><span class="p">],</span>
    <span class="n">waist</span>            <span class="o">=</span> <span class="mf">3.</span><span class="p">,</span>
    <span class="n">polarization_phi</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">ellipticity</span>      <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">time_envelope</span>    <span class="o">=</span> <span class="n">tconstant</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Note that here the focus is given in [x] coordinates, since it propagates on the <cite>r=0</cite> axis .</p>
</div></blockquote>
<p class="rubric">7. Defining a generic wave at some distance from the boundary</p>
<blockquote>
<div><p>In some cases, the laser field is not known at the box boundary, but rather at some
plane inside the box. Smilei can pre-calculate the corresponding wave at the boundary
using the <em>angular spectrum method</em>. This technique is only available in 2D and 3D
cartesian geometries and requires the python packages <em>numpy</em>.
A <a class="reference internal" href="laser_offset.html"><span class="doc">detailed explanation</span></a> of the method is available.
The laser is introduced using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LaserOffset</span><span class="p">(</span>
    <span class="n">box_side</span>               <span class="o">=</span> <span class="s2">&quot;xmin&quot;</span><span class="p">,</span>
    <span class="n">space_time_profile</span>     <span class="o">=</span> <span class="p">[</span> <span class="n">By_profile</span><span class="p">,</span> <span class="n">Bz_profile</span> <span class="p">],</span>
    <span class="n">offset</span>                 <span class="o">=</span> <span class="mf">10.</span><span class="p">,</span>
    <span class="n">extra_envelope</span>          <span class="o">=</span> <span class="n">tconstant</span><span class="p">(),</span>
    <span class="n">keep_n_strongest_modes</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
    <span class="n">angle</span> <span class="o">=</span> <span class="mf">10.</span><span class="o">/</span><span class="mf">180.</span><span class="o">*</span><span class="mf">3.14159</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="id23">
<span class="sig-name descname"><span class="pre">space_time_profile</span></span><a class="headerlink" href="#id23" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of two <em>python</em> functions</p>
</dd>
</dl>
<p>The magnetic field profiles at some arbitrary plane, as a function of space and time.
The arguments of these profiles are <code class="docutils literal notranslate"><span class="pre">(y,t)</span></code> in 2D and <code class="docutils literal notranslate"><span class="pre">(y,z,t)</span></code> in 3D.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="offset">
<span class="sig-name descname"><span class="pre">offset</span></span><a class="headerlink" href="#offset" title="Link to this definition">¶</a></dt>
<dd><p>The distance from the box boundary to the plane where <a class="reference internal" href="#id33" title="space_time_profile"><code class="xref py py-data docutils literal notranslate"><span class="pre">space_time_profile</span></code></a>
is defined.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="extra_envelope">
<span class="sig-name descname"><span class="pre">extra_envelope</span></span><a class="headerlink" href="#extra_envelope" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>a <em>python</em> function or a <a class="reference internal" href="profiles.html"><span class="doc">python profile</span></a></p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">*z:</span> <span class="pre">1.</span></code>, which means a profile of value 1 everywhere</p>
</dd>
</dl>
<p>An extra envelope applied at the boundary, on top of the <a class="reference internal" href="#id33" title="space_time_profile"><code class="xref py py-data docutils literal notranslate"><span class="pre">space_time_profile</span></code></a>.
This envelope takes two arguments (<code class="docutils literal notranslate"><span class="pre">y</span></code>, <code class="docutils literal notranslate"><span class="pre">t</span></code>) in 2D, and three arguments (<code class="docutils literal notranslate"><span class="pre">y</span></code>, <code class="docutils literal notranslate"><span class="pre">z</span></code>, <code class="docutils literal notranslate"><span class="pre">t</span></code>)
in 3D.
As the wave propagation technique stores a limited number of Fourier modes (in the time
domain) of the wave, some periodicity can be obtained in the actual laser.
One may thus observe that the laser pulse is repeated several times.
The envelope can be used to remove these spurious repetitions.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="keep_n_strongest_modes">
<span class="sig-name descname"><span class="pre">keep_n_strongest_modes</span></span><a class="headerlink" href="#keep_n_strongest_modes" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>100</p>
</dd>
</dl>
<p>The number of temporal Fourier modes that are kept during the pre-processing.
See <a class="reference internal" href="laser_offset.html"><span class="doc">this page</span></a> for more details.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="angle">
<span class="sig-name descname"><span class="pre">angle</span></span><a class="headerlink" href="#angle" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><ol class="arabic simple" start="0">
<li></li>
</ol>
</dd>
</dl>
<p>Angle between the boundary and the profile’s plane, the rotation being around <span class="math notranslate nohighlight">\(z\)</span>.
See <a class="reference internal" href="laser_offset.html"><span class="doc">this page</span></a> for more details.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="fft_time_window">
<span class="sig-name descname"><span class="pre">fft_time_window</span></span><a class="headerlink" href="#fft_time_window" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#simulation_time" title="simulation_time"><code class="xref py py-data docutils literal notranslate"><span class="pre">simulation_time</span></code></a></p>
</dd>
</dl>
<p>Time during which the <code class="docutils literal notranslate"><span class="pre">space_time_profile</span></code> is sampled (calculating the
<code class="docutils literal notranslate"><span class="pre">LaserOffset</span></code> on the whole simulation duration can be costly). Note that
the Fourier approach will naturally repeat the signal periodically.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="fft_time_step">
<span class="sig-name descname"><span class="pre">fft_time_step</span></span><a class="headerlink" href="#fft_time_step" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#timestep" title="timestep"><code class="xref py py-data docutils literal notranslate"><span class="pre">timestep</span></code></a></p>
</dd>
</dl>
<p>Temporal step between each sample of the <code class="docutils literal notranslate"><span class="pre">space_time_profile</span></code>.
Chosing a larger step can help reduce the memory load but will remove high temporal frequencies.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="number_of_processes">
<span class="sig-name descname"><span class="pre">number_of_processes</span></span><a class="headerlink" href="#number_of_processes" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>all available processes</em></p>
</dd>
</dl>
<p>The number of MPI processes that will be used for computing the <code class="docutils literal notranslate"><span class="pre">LaserOffset</span></code>.
Using more processes computes the FFT faster, but too many processes may
be very costly in communication. In addition, using too few may not allow
the arrays to fit in memory.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="file">
<span class="sig-name descname"><span class="pre">file</span></span><a class="headerlink" href="#file" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
<p>The path to a <code class="docutils literal notranslate"><span class="pre">LaserOffset*.h5</span></code> file generated from a previous simulation. This option
can help reduce the computation time by re-using the <code class="docutils literal notranslate"><span class="pre">LaserOffset</span></code> computation
from a previous simulation.</p>
</dd></dl>

</div></blockquote>
<hr class="docutils" />
</section>
<section id="laser-envelope-model">
<span id="laser-envelope"></span><h2>Laser envelope model<a class="headerlink" href="#laser-envelope-model" title="Link to this heading">¶</a></h2>
<p>In all the available geometries, it is possible to model a laser pulse
propagating in the <code class="docutils literal notranslate"><span class="pre">x</span></code> direction
using an envelope model (see <a class="reference internal" href="../Understand/laser_envelope.html"><span class="doc">Laser envelope model</span></a> for the advantages
and limits of this approximation).
The fast oscillations of the laser are neglected and all the physical
quantities of the simulation, including the electromagnetic fields and
their source terms, as well as the particles positions and momenta, are
meant as an average over one or more optical cycles.
Effects involving characteristic lengths comparable to the laser central
wavelength (i.e. sharp plasma density profiles) cannot be modeled with
this option.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The envelope model in <code class="docutils literal notranslate"><span class="pre">&quot;AMcylindrical&quot;</span></code> geometry is implemented only in the hypothesis of
cylindrical symmetry, i.e. only one azimuthal mode. Therefore, to use it the user must choose
<code class="docutils literal notranslate"><span class="pre">number_of_AM</span> <span class="pre">=</span> <span class="pre">1</span></code>.</p>
</div>
<p>Contrarily to a standard Laser initialized with the Silver-Müller
boundary conditions, the laser envelope will be entirely initialized inside
the simulation box at the start of the simulation.</p>
<p>Currently only one laser pulse of a given frequency propagating in the positive
<cite>x</cite> direction can be speficified. However, a multi-pulse set-up can be initialized
if a multi-pulse profile is specified, e.g. if the temporal profile is given by two adjacents gaussian functions.
The whole multi-pulse profile would have the same carrier frequency and would propagate in the positive
<cite>x</cite> direction. For the moment it is not possible to specify more than one laser envelope profile, e.g.
two counterpropagating lasers, or two lasers with different carrier frequency.</p>
<p>Please note that describing a laser through its complex envelope loses physical accuracy if its
characteristic space-time variation scales are too small, i.e. of the order of the laser
central wavelength (see <a class="reference internal" href="../Understand/laser_envelope.html"><span class="doc">Laser envelope model</span></a>).
Thus, space-time profiles with variation scales larger than this length should be used.</p>
<p class="rubric">1. Defining a generic laser envelope</p>
<p>Following is the generic laser envelope creator</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LaserEnvelope</span><span class="p">(</span>
    <span class="n">omega</span>          <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">envelope_solver</span> <span class="o">=</span> <span class="s1">&#39;explicit&#39;</span><span class="p">,</span>
    <span class="n">envelope_profile</span> <span class="o">=</span> <span class="n">envelope_profile</span><span class="p">,</span>
    <span class="n">Envelope_boundary_conditions</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;reflective&quot;</span><span class="p">]]</span>
    <span class="n">polarization_phi</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">ellipticity</span>      <span class="o">=</span> <span class="mf">0.</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="id24">
<span class="sig-name descname"><span class="pre">omega</span></span><a class="headerlink" href="#id24" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">1.</span></code></p>
</dd>
</dl>
<p>The laser angular frequency.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="envelope_profile">
<span class="sig-name descname"><span class="pre">envelope_profile</span></span><a class="headerlink" href="#envelope_profile" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>a <em>python</em> function or a <a class="reference internal" href="profiles.html"><span class="doc">python profile</span></a></p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p>The laser space-time profile, so if the geometry is <code class="docutils literal notranslate"><span class="pre">3Dcartesian</span></code> a function of 4 arguments (3 for space, 1 for time) is necessary.
Please note that the envelope will be entirely initialized in the simulation box
already at the start of the simulation, so the time coordinate will be applied
to the <code class="docutils literal notranslate"><span class="pre">x</span></code> direction instead of time. It is recommended to initialize the
laser envelope in vacuum, separated from the plasma, to avoid unphysical
results.
Envelopes with variation scales near to the laser wavelength do not
satisfy the assumptions of the envelope model (see <a class="reference internal" href="../Understand/laser_envelope.html"><span class="doc">Laser envelope model</span></a>),
yielding inaccurate results.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="envelope_solver">
<span class="sig-name descname"><span class="pre">envelope_solver</span></span><a class="headerlink" href="#envelope_solver" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">explicit</span></code></p>
</dd>
</dl>
<p>The solver scheme for the envelope equation.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;explicit&quot;</span></code>: an explicit scheme based  on central finite differences.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;explicit_reduced_dispersion&quot;</span></code>: the finite difference derivatives along <code class="docutils literal notranslate"><span class="pre">x</span></code> in the <code class="docutils literal notranslate"><span class="pre">&quot;explicit&quot;</span></code> solver are substituted by
optimized derivatives to reduce numerical dispersion. For more accurate results over long distances, the use of this solver is recommended.
Please note that the CFL limit of this solver is lower than the one of the <code class="docutils literal notranslate"><span class="pre">&quot;explicit&quot;</span></code> solver. Thus, a smaller integration
timestep may be necessary.</p></li>
</ul>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="Envelope_boundary_conditions">
<span class="sig-name descname"><span class="pre">Envelope_boundary_conditions</span></span><a class="headerlink" href="#Envelope_boundary_conditions" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of lists of strings</p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">[[&quot;reflective&quot;]]</span></code></p>
</dd>
</dl>
<p>Defines the boundary conditions used for the envelope. Either <code class="docutils literal notranslate"><span class="pre">&quot;reflective&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;PML&quot;</span></code>.
In the case of <code class="docutils literal notranslate"><span class="pre">&quot;PML&quot;</span></code>, make sure to define <code class="docutils literal notranslate"><span class="pre">&quot;number_of_pml_cells&quot;</span></code> in the <code class="docutils literal notranslate"><span class="pre">Main</span></code> block.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id25">
<span class="sig-name descname"><span class="pre">polarization_phi</span></span><a class="headerlink" href="#id25" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><ol class="arabic simple" start="0">
<li></li>
</ol>
</dd>
</dl>
<p>The angle of the polarization ellipse major axis relative to the X-Y plane, in radians. Needed only for ionization.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id26">
<span class="sig-name descname"><span class="pre">ellipticity</span></span><a class="headerlink" href="#id26" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><ol class="arabic simple" start="0">
<li></li>
</ol>
</dd>
</dl>
<p>The polarization ellipticity: 0 for linear and 1 for circular. For the moment, only these two polarizations are available.</p>
</dd></dl>

<p class="rubric">2. Defining a 1D laser envelope</p>
<p>Following is the simplified laser envelope creator in 1D</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LaserEnvelopePlanar1D</span><span class="p">(</span>
    <span class="n">a0</span>              <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">time_envelope</span>   <span class="o">=</span> <span class="n">tgaussian</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="mf">150.</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mf">40.</span><span class="p">),</span>
    <span class="n">envelope_solver</span> <span class="o">=</span> <span class="s1">&#39;explicit&#39;</span><span class="p">,</span>
    <span class="n">Envelope_boundary_conditions</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="s2">&quot;reflective&quot;</span><span class="p">]</span> <span class="p">],</span>
    <span class="n">polarization_phi</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">ellipticity</span>      <span class="o">=</span> <span class="mf">0.</span>
<span class="p">)</span>
</pre></div>
</div>
<p class="rubric">3. Defining a 2D gaussian laser envelope</p>
<p>Following is the simplified gaussian laser envelope creator in 2D</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LaserEnvelopeGaussian2D</span><span class="p">(</span>
    <span class="n">a0</span>              <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">focus</span>           <span class="o">=</span> <span class="p">[</span><span class="mf">150.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">],</span>
    <span class="n">waist</span>           <span class="o">=</span> <span class="mf">30.</span><span class="p">,</span>
    <span class="n">time_envelope</span>   <span class="o">=</span> <span class="n">tgaussian</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="mf">150.</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mf">40.</span><span class="p">),</span>
    <span class="n">envelope_solver</span> <span class="o">=</span> <span class="s1">&#39;explicit&#39;</span><span class="p">,</span>
    <span class="n">Envelope_boundary_conditions</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="s2">&quot;reflective&quot;</span><span class="p">]</span> <span class="p">],</span>
    <span class="n">polarization_phi</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">ellipticity</span>      <span class="o">=</span> <span class="mf">0.</span>
<span class="p">)</span>
</pre></div>
</div>
<p class="rubric">4. Defining a 3D gaussian laser envelope</p>
<p>Following is the simplified laser envelope creator in 3D</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LaserEnvelopeGaussian3D</span><span class="p">(</span>
    <span class="n">a0</span>              <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">focus</span>           <span class="o">=</span> <span class="p">[</span><span class="mf">150.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">],</span>
    <span class="n">waist</span>           <span class="o">=</span> <span class="mf">30.</span><span class="p">,</span>
    <span class="n">time_envelope</span>   <span class="o">=</span> <span class="n">tgaussian</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="mf">150.</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mf">40.</span><span class="p">),</span>
    <span class="n">envelope_solver</span> <span class="o">=</span> <span class="s1">&#39;explicit&#39;</span><span class="p">,</span>
    <span class="n">Envelope_boundary_conditions</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="s2">&quot;reflective&quot;</span><span class="p">]</span> <span class="p">],</span>
    <span class="n">polarization_phi</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">ellipticity</span>      <span class="o">=</span> <span class="mf">0.</span>
<span class="p">)</span>
</pre></div>
</div>
<p class="rubric">5. Defining a cylindrical gaussian laser envelope</p>
<p>Following is the simplified laser envelope creator in <code class="docutils literal notranslate"><span class="pre">&quot;AMcylindrical&quot;</span></code> geometry (remember that
in this geometry the envelope model can be used only if <code class="docutils literal notranslate"><span class="pre">number_of_AM</span> <span class="pre">=</span> <span class="pre">1</span></code>)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LaserEnvelopeGaussianAM</span><span class="p">(</span>
    <span class="n">a0</span>              <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">focus</span>           <span class="o">=</span> <span class="p">[</span><span class="mf">150.</span><span class="p">],</span>
    <span class="n">waist</span>           <span class="o">=</span> <span class="mf">30.</span><span class="p">,</span>
    <span class="n">time_envelope</span>   <span class="o">=</span> <span class="n">tgaussian</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="mf">150.</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mf">40.</span><span class="p">),</span>
    <span class="n">envelope_solver</span> <span class="o">=</span> <span class="s1">&#39;explicit&#39;</span><span class="p">,</span>
    <span class="n">Envelope_boundary_conditions</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="s2">&quot;reflective&quot;</span><span class="p">]</span> <span class="p">],</span>
    <span class="n">polarization_phi</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">ellipticity</span>      <span class="o">=</span> <span class="mf">0.</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The arguments appearing <code class="docutils literal notranslate"><span class="pre">LaserEnvelopePlanar1D</span></code>, <code class="docutils literal notranslate"><span class="pre">LaserEnvelopeGaussian2D</span></code>,
<code class="docutils literal notranslate"><span class="pre">LaserEnvelopeGaussian3D</span></code> and <code class="docutils literal notranslate"><span class="pre">LaserEnvelopeGaussianAM</span></code> have the same meaning they would have in a
normal <code class="docutils literal notranslate"><span class="pre">LaserPlanar1D</span></code>, <code class="docutils literal notranslate"><span class="pre">LaserGaussian2D</span></code>, <code class="docutils literal notranslate"><span class="pre">LaserGaussian3D</span></code> and <code class="docutils literal notranslate"><span class="pre">LaserGaussianAM</span></code>,
with some differences:</p>
<dl class="py data">
<dt class="sig sig-object py" id="id27">
<span class="sig-name descname"><span class="pre">time_envelope</span></span><a class="headerlink" href="#id27" title="Link to this definition">¶</a></dt>
<dd><p>Since the envelope will be entirely initialized in the simulation box
already at the start of the simulation, the time envelope will be applied
in the <code class="docutils literal notranslate"><span class="pre">x</span></code> direction instead of time. It is recommended to initialize the
laser envelope in vacuum, separated from the plasma, to avoid unphysical
results.
Temporal envelopes with variation scales near to the laser wavelength do not
satisfy the assumptions of the envelope model (see <a class="reference internal" href="../Understand/laser_envelope.html"><span class="doc">Laser envelope model</span></a>),
yielding inaccurate results.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id28">
<span class="sig-name descname"><span class="pre">waist</span></span><a class="headerlink" href="#id28" title="Link to this definition">¶</a></dt>
<dd><p>Please note that a waist size comparable to the laser wavelength does not
satisfy the assumptions of the envelope model.</p>
</dd></dl>

<p>It is important to remember that the profile defined through the blocks
<code class="docutils literal notranslate"><span class="pre">LaserEnvelopePlanar1D</span></code>, <code class="docutils literal notranslate"><span class="pre">LaserEnvelopeGaussian2D</span></code>, <code class="docutils literal notranslate"><span class="pre">LaserEnvelopeGaussian3D</span></code>
correspond to the complex envelope of the laser vector potential component
<span class="math notranslate nohighlight">\(\tilde{A}\)</span> in the polarization direction.
The calculation of the correspondent complex envelope for the laser electric field
component in that direction is described in <a class="reference internal" href="../Understand/laser_envelope.html"><span class="doc">Laser envelope model</span></a>.</p>
<p>Note that only order 2 interpolation and projection are supported in presence of
the envelope model for the laser.</p>
<p>The parameters <code class="docutils literal notranslate"><span class="pre">polarization_phi</span></code> and <code class="docutils literal notranslate"><span class="pre">ellipticity</span></code> specify the polarization state of the laser. In envelope model implemented in <strong class="program">Smilei</strong>,
they are only used to compute the rate of ionization and the initial momentum of the electrons newly created by ionization,
where the polarization of the laser plays an important role (see <a class="reference internal" href="../Understand/ionization.html"><span class="doc">Ionization</span></a>).
For all other purposes (e.g. the particles equations of motions, the computation of the ponderomotive force,
the evolution of the laser), the polarization of the laser plays no role in the envelope model.</p>
<hr class="docutils" />
</section>
<section id="external-fields">
<span id="externalfield"></span><h2>External fields<a class="headerlink" href="#external-fields" title="Link to this heading">¶</a></h2>
<p>An initial field can be applied over the whole box
at the beginning of the simulation using the <code class="docutils literal notranslate"><span class="pre">ExternalField</span></code> block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ExternalField</span><span class="p">(</span>
    <span class="n">field</span> <span class="o">=</span> <span class="s2">&quot;Ex&quot;</span><span class="p">,</span>
    <span class="n">profile</span> <span class="o">=</span> <span class="n">constant</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">xvacuum</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="field">
<span class="sig-name descname"><span class="pre">field</span></span><a class="headerlink" href="#field" title="Link to this definition">¶</a></dt>
<dd><p>Field names in Cartesian geometries: <code class="docutils literal notranslate"><span class="pre">&quot;Ex&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Ey&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Ez&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Bx&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;By&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Bz&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Bx_m&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;By_m&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Bz_m&quot;</span></code>.
Field names in AM geometry: <code class="docutils literal notranslate"><span class="pre">&quot;El_mode_m&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Er_mode_m&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Et_mode_m&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Bl_mode_m&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Br_mode_m&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Bt_mode_m&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Bl_m_mode_m&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Br_m_mode_m&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Bt_m_mode_m&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;A_mode_1&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;A0_mode_1&quot;</span></code> .</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="profile">
<span class="sig-name descname"><span class="pre">profile</span></span><a class="headerlink" href="#profile" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or <a class="reference internal" href="profiles.html"><span class="doc">profile</span></a></p>
</dd>
</dl>
<p>The initial spatial profile of the applied field.
Refer to <a class="reference internal" href="../Understand/units.html"><span class="doc">Units</span></a> to understand the units of this field.</p>
<p>Note that when using standard FDTD schemes, <code class="docutils literal notranslate"><span class="pre">B</span></code> fields are given at time <code class="docutils literal notranslate"><span class="pre">t=0.5</span> <span class="pre">dt</span></code> and <code class="docutils literal notranslate"><span class="pre">B_m</span></code> fields at time <code class="docutils literal notranslate"><span class="pre">t=0</span></code> like <code class="docutils literal notranslate"><span class="pre">E</span></code> fields.
It is important to initialize <code class="docutils literal notranslate"><span class="pre">B_m</span></code> fields at <code class="docutils literal notranslate"><span class="pre">t=0</span></code> if there are particles in the simulation domain at the start of the simulation.
If <code class="docutils literal notranslate"><span class="pre">B_m</span></code> is omited, it is assumed that the magnetic field is constant and that <code class="docutils literal notranslate"><span class="pre">B_m=B</span></code>.</p>
<p>Note that in AM geometry all field names must be followed by the number <code class="docutils literal notranslate"><span class="pre">&quot;i&quot;</span></code> of the mode that is currently passed with the string <code class="docutils literal notranslate"><span class="pre">&quot;_mode_i&quot;</span></code>. For instance <code class="docutils literal notranslate"><span class="pre">&quot;Er_mode_1&quot;</span></code>.
In this geometry, an external envelope field can also be used. It needs to be initialized at times <code class="docutils literal notranslate"><span class="pre">&quot;t=0&quot;</span></code> in <code class="docutils literal notranslate"><span class="pre">&quot;A_mode_1&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;t=-dt&quot;</span></code> in <code class="docutils literal notranslate"><span class="pre">&quot;A0_mode_1&quot;</span></code>.
The user must use the <code class="docutils literal notranslate"><span class="pre">&quot;_mode_1&quot;</span></code> suffix for these two fields because there is no other possible mode for them.</p>
</dd></dl>

<hr class="docutils" />
</section>
<section id="prescribed-fields">
<span id="prescribedfield"></span><h2>Prescribed fields<a class="headerlink" href="#prescribed-fields" title="Link to this heading">¶</a></h2>
<p>User-defined electromagnetic fields, with spatio-temporal dependence,
can be superimposed to the self-consistent Maxwell fields.
These fields push the particles but <strong>do not participate in the Maxwell solver</strong>:
they are not self-consistent.
They are however useful to describe charged particles’ dynamics in a given
electromagnetic field.</p>
<p>This feature is accessible using the <code class="docutils literal notranslate"><span class="pre">PrescribedField</span></code> block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span>
<span class="k">def</span> <span class="nf">myPrescribedProfile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

<span class="n">PrescribedField</span><span class="p">(</span>
    <span class="n">field</span> <span class="o">=</span> <span class="s2">&quot;Ex&quot;</span><span class="p">,</span>
    <span class="n">profile</span> <span class="o">=</span> <span class="n">myPrescribedProfile</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="id29">
<span class="sig-name descname"><span class="pre">field</span></span><a class="headerlink" href="#id29" title="Link to this definition">¶</a></dt>
<dd><p>Field names in Cartesian geometries: <code class="docutils literal notranslate"><span class="pre">&quot;Ex&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Ey&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Ez&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Bx_m&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;By_m&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;Bz_m&quot;</span></code>.
Field names in AM geometry: <code class="docutils literal notranslate"><span class="pre">&quot;El_mode_m&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Er_mode_m&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Et_mode_m&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Bl_m_mode_m&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Br_m_mode_m&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;Bt_m_mode_m&quot;</span></code>.</p>
</dd></dl>

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When prescribing a magnetic field, always use the time-centered fields <code class="docutils literal notranslate"><span class="pre">&quot;Bx_m&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;By_m&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;Bz_m&quot;</span></code>.
These fields are those used in the particle pusher, and are defined at integer time-steps.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When prescribing a field in AM geometry, the mode “m” must be specified explicitly in the name of the field and the profile
must return a complex value.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code class="docutils literal notranslate"><span class="pre">PrescribedFields</span></code> are not visible in the <code class="docutils literal notranslate"><span class="pre">Field</span></code> diagnostic,
but can be visualised through <code class="docutils literal notranslate"><span class="pre">Probes</span></code> and with the fields attributes of <code class="docutils literal notranslate"><span class="pre">TrackParticles</span></code>
(since they sample the total field acting on the macro-particles).</p>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="id30">
<span class="sig-name descname"><span class="pre">profile</span></span><a class="headerlink" href="#id30" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or <a class="reference internal" href="profiles.html"><span class="doc">profile</span></a></p>
</dd>
</dl>
<p>The spatio-temporal profile of the applied field: a <em>python</em> function
with arguments (<em>x</em>, <em>t</em>) or (<em>x</em>, <em>y</em>, <em>t</em>), etc.
Refer to <a class="reference internal" href="../Understand/units.html"><span class="doc">Units</span></a> to understand the units of this field.</p>
</dd></dl>

<hr class="docutils" />
</section>
<section id="antennas">
<span id="id31"></span><h2>Antennas<a class="headerlink" href="#antennas" title="Link to this heading">¶</a></h2>
<p>An antenna is an extra current applied during the whole simulation.
It is applied using an <code class="docutils literal notranslate"><span class="pre">Antenna</span></code> block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Antenna</span><span class="p">(</span>
    <span class="n">field</span> <span class="o">=</span> <span class="s2">&quot;Jz&quot;</span><span class="p">,</span>
    <span class="n">space_profile</span> <span class="o">=</span> <span class="n">gaussian</span><span class="p">(</span><span class="mf">0.01</span><span class="p">),</span>
    <span class="n">time_profile</span> <span class="o">=</span> <span class="n">tcosine</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="id32">
<span class="sig-name descname"><span class="pre">field</span></span><a class="headerlink" href="#id32" title="Link to this definition">¶</a></dt>
<dd><p>The name of the current: <code class="docutils literal notranslate"><span class="pre">&quot;Jx&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Jy&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;Jz&quot;</span></code>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="space_profile">
<span class="sig-name descname"><span class="pre">space_profile</span></span><a class="headerlink" href="#space_profile" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or <a class="reference internal" href="profiles.html"><span class="doc">profile</span></a></p>
</dd>
</dl>
<p>The initial spatial profile of the applied antenna.
Refer to <a class="reference internal" href="../Understand/units.html"><span class="doc">Units</span></a> to understand the units of this current.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="time_profile">
<span class="sig-name descname"><span class="pre">time_profile</span></span><a class="headerlink" href="#time_profile" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or <a class="reference internal" href="profiles.html"><span class="doc">profile</span></a></p>
</dd>
</dl>
<p>The temporal profile of the applied antenna. It multiplies <code class="docutils literal notranslate"><span class="pre">space_profile</span></code>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id33">
<span class="sig-name descname"><span class="pre">space_time_profile</span></span><a class="headerlink" href="#id33" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or <a class="reference internal" href="profiles.html"><span class="doc">profile</span></a></p>
</dd>
</dl>
<p>A space &amp; time profile for the antenna (not compatible with <code class="docutils literal notranslate"><span class="pre">space_profile</span></code>
or <code class="docutils literal notranslate"><span class="pre">time_profile</span></code>). It should have <code class="docutils literal notranslate"><span class="pre">N+1``arguments,</span> <span class="pre">where</span> <span class="pre">``N</span></code> is the dimension
of the simulation. For instance <code class="docutils literal notranslate"><span class="pre">(x,t)</span></code> in 1D, <code class="docutils literal notranslate"><span class="pre">(x,y,t)</span></code> in 2D, etc.</p>
<p>The function must accept <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code> and <code class="docutils literal notranslate"><span class="pre">z</span></code> either as floats or numpy arrays.
If it accepts floats, the return value must be a float.
If it accepts numpy arrays, these arrays will correspond to the coordinates of 1 patch,
and the return value must be a numpy array of the same size.</p>
</dd></dl>

</section>
<hr class="docutils" />
<section id="walls">
<h2>Walls<a class="headerlink" href="#walls" title="Link to this heading">¶</a></h2>
<p>A wall can be introduced using a <code class="docutils literal notranslate"><span class="pre">PartWall</span></code> block in order to
reflect, stop, thermalize or kill particles which reach it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PartWall</span><span class="p">(</span>
    <span class="n">kind</span> <span class="o">=</span> <span class="s2">&quot;reflective&quot;</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mf">20.</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="kind">
<span class="sig-name descname"><span class="pre">kind</span></span><a class="headerlink" href="#kind" title="Link to this definition">¶</a></dt>
<dd><p>The kind of wall: <code class="docutils literal notranslate"><span class="pre">&quot;reflective&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;stop&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;thermalize&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;remove&quot;</span></code>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="x">
<span class="sig-name descname"><span class="pre">x</span></span><a class="headerlink" href="#x" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py" id="y">
<span class="sig-name descname"><span class="pre">y</span></span><a class="headerlink" href="#y" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py" id="z">
<span class="sig-name descname"><span class="pre">z</span></span><a class="headerlink" href="#z" title="Link to this definition">¶</a></dt>
<dd><p>Position of the wall in the desired direction. Use only one of <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code> or <code class="docutils literal notranslate"><span class="pre">z</span></code>.</p>
</dd></dl>

<hr class="docutils" />
</section>
<section id="collisions-reactions">
<span id="collisions"></span><h2>Collisions &amp; reactions<a class="headerlink" href="#collisions-reactions" title="Link to this heading">¶</a></h2>
<p><a class="reference internal" href="../Understand/collisions.html"><span class="doc">Binary collisions &amp; reactions</span></a> account for short-range Coulomb interactions of particles (shorter than the
cell size), but also include other effects such as impact ionization and nuclear reactions.
These are gathered under this section because they are treated as <em>binary processes</em> (meaning
they happen during the encounter of two macro-particles).</p>
<p>They are specified by one or several <code class="docutils literal notranslate"><span class="pre">Collisions</span></code> blocks:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Collisions</span><span class="p">(</span>
    <span class="n">species1</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;electrons1&quot;</span><span class="p">,</span>  <span class="s2">&quot;electrons2&quot;</span><span class="p">],</span>
    <span class="n">species2</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ions1&quot;</span><span class="p">],</span>
    <span class="n">debug_every</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">coulomb_log</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
    <span class="n">coulomb_log_factor</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
    <span class="n">ionizing</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="c1">#      nuclear_reaction = [],</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The screening from bound electrons, which is important when
the atom is neutral or partially ionized, is accounted for only in the
case of e-i collisions. To activate it, atom species <strong>must have</strong>
their <a class="reference internal" href="#atomic_number" title="atomic_number"><code class="xref py py-data docutils literal notranslate"><span class="pre">atomic_number</span></code></a> defined and non-zero.</p>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="species1">
<span class="sig-name descname"><span class="pre">species1</span></span><a class="headerlink" href="#species1" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py" id="species2">
<span class="sig-name descname"><span class="pre">species2</span></span><a class="headerlink" href="#species2" title="Link to this definition">¶</a></dt>
<dd><p>Lists of species’ <a class="reference internal" href="#id56" title="name"><code class="xref py py-data docutils literal notranslate"><span class="pre">name</span></code></a>.</p>
<p>The collisions and reactions will occur between all species under the group <code class="docutils literal notranslate"><span class="pre">species1</span></code>
and all species under the group <code class="docutils literal notranslate"><span class="pre">species2</span></code>. For example, to collide all
electrons with ions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">species1</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;electrons1&quot;</span><span class="p">,</span> <span class="s2">&quot;electrons2&quot;</span><span class="p">],</span> <span class="n">species2</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ions&quot;</span><span class="p">]</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This does not make <code class="docutils literal notranslate"><span class="pre">electrons1</span></code> collide with <code class="docutils literal notranslate"><span class="pre">electrons2</span></code>.</p>
</div>
<p>The two groups of species have to be <em>completely different</em> OR <em>exactly equal</em>.
In other words, if <code class="docutils literal notranslate"><span class="pre">species1</span></code> is not equal to <code class="docutils literal notranslate"><span class="pre">species2</span></code>,
then they cannot have any common species.
If the two groups are exactly equal, we call this situation <strong>intra-collisions</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If both lists <code class="docutils literal notranslate"><span class="pre">species1</span></code> and <code class="docutils literal notranslate"><span class="pre">species2</span></code> contain only one species,
the algorithm is potentially faster than the situation with several
species in one or the other list. This is especially true if the
machine accepts SIMD vectorization.</p>
</div>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id34">
<span class="sig-name descname"><span class="pre">every</span></span><a class="headerlink" href="#id34" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>1</p>
</dd>
</dl>
<p>Number of timesteps between each computation of the collisions or reactions.
Use a number higher than 1 only if you know the collision frequency is low
with respect to the inverse of the timestep.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="debug_every">
<span class="sig-name descname"><span class="pre">debug_every</span></span><a class="headerlink" href="#debug_every" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>0</p>
</dd>
</dl>
<p>Number of timesteps between each output of information about collisions or reactions.
If 0, there will be no outputs.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id35">
<span class="sig-name descname"><span class="pre">time_frozen</span></span><a class="headerlink" href="#id35" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><ol class="arabic simple" start="0">
<li></li>
</ol>
</dd>
</dl>
<p>The time during which no collisions or reactions happen, in units of <span class="math notranslate nohighlight">\(T_r\)</span>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="coulomb_log">
<span class="sig-name descname"><span class="pre">coulomb_log</span></span><a class="headerlink" href="#coulomb_log" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><ol class="arabic simple" start="0">
<li></li>
</ol>
</dd>
</dl>
<p>The Coulomb logarithm.</p>
<ul class="simple">
<li><p>If <span class="math notranslate nohighlight">\(= 0\)</span>, the Coulomb logarithm is automatically computed for each collision.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(&gt; 0\)</span>, the Coulomb logarithm is equal to this value.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(&lt; 0\)</span>, collisions are not treated (but other reactions may happen).</p></li>
</ul>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="coulomb_log_factor">
<span class="sig-name descname"><span class="pre">coulomb_log_factor</span></span><a class="headerlink" href="#coulomb_log_factor" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><ol class="arabic simple">
<li></li>
</ol>
</dd>
</dl>
<p>A constant, strictly positive factor that multiplies the Coulomb logarithm, regardless
of <a class="reference internal" href="#coulomb_log" title="coulomb_log"><code class="xref py py-data docutils literal notranslate"><span class="pre">coulomb_log</span></code></a> being automatically computed or set to a constant value.
This can help, for example, to compensate artificially-reduced ion masses.</p>
</dd></dl>

<dl class="py data" id="collisionalionization">
<dt class="sig sig-object py" id="ionizing">
<span class="sig-name descname"><span class="pre">ionizing</span></span><a class="headerlink" href="#ionizing" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
<p><a class="reference internal" href="../Understand/collisions.html#collionization"><span class="std std-ref">Collisional ionization</span></a> is set when this parameter is not <code class="docutils literal notranslate"><span class="pre">False</span></code>.
It can either be set to the name of a pre-existing electron species (where the ionized
electrons are created), or to <code class="docutils literal notranslate"><span class="pre">True</span></code> (the first electron species in <a class="reference internal" href="#species1" title="species1"><code class="xref py py-data docutils literal notranslate"><span class="pre">species1</span></code></a>
or <a class="reference internal" href="#species2" title="species2"><code class="xref py py-data docutils literal notranslate"><span class="pre">species2</span></code></a> is then chosen for ionized electrons).</p>
<p>One of the species groups must be all electrons (<a class="reference internal" href="#mass" title="mass"><code class="xref py py-data docutils literal notranslate"><span class="pre">mass</span></code></a> = 1), and the other
one all ions of the same <a class="reference internal" href="#atomic_number" title="atomic_number"><code class="xref py py-data docutils literal notranslate"><span class="pre">atomic_number</span></code></a>.</p>
</dd></dl>

<dl class="py data experimental">
<dt class="sig sig-object py" id="nuclear_reaction">
<span class="sig-name descname"><span class="pre">nuclear_reaction</span></span><a class="headerlink" href="#nuclear_reaction" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>a list of strings</p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code> (no nuclear reaction)</p>
</dd>
</dl>
<p>A list of the species names for the products of <a class="reference internal" href="../Understand/collisions.html#collnuclearreactions"><span class="std std-ref">Nuclear reactions</span></a>
that may occur during collisions. You may omit product species if they are not necessary
for the simulation.</p>
<p>All members of <a class="reference internal" href="#species1" title="species1"><code class="xref py py-data docutils literal notranslate"><span class="pre">species1</span></code></a> must be the same type of atoms, which is automatically
recognized by their <a class="reference internal" href="#mass" title="mass"><code class="xref py py-data docutils literal notranslate"><span class="pre">mass</span></code></a> and <a class="reference internal" href="#atomic_number" title="atomic_number"><code class="xref py py-data docutils literal notranslate"><span class="pre">atomic_number</span></code></a>. The same applies for
all members of <a class="reference internal" href="#species2" title="species2"><code class="xref py py-data docutils literal notranslate"><span class="pre">species2</span></code></a>.</p>
<p>In the current version, only the reaction D(d,n)He³ is available.</p>
</dd></dl>

<dl class="py data experimental">
<dt class="sig sig-object py" id="nuclear_reaction_multiplier">
<span class="sig-name descname"><span class="pre">nuclear_reaction_multiplier</span></span><a class="headerlink" href="#nuclear_reaction_multiplier" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>a float</p>
</dd>
<dt class="field-even">Default<span class="colon">:</span></dt>
<dd class="field-even"><ol class="arabic simple" start="0">
<li><p>(automatically adjusted)</p></li>
</ol>
</dd>
</dl>
<p>The rate multiplier for nuclear reactions. It is a positive number that artificially
increases the occurence of reactions so that a good statistics is obtained. The number
of actual reaction products is adjusted by changing their weights in order to provide
a physically correct number of reactions. Leave this number to <code class="docutils literal notranslate"><span class="pre">0.</span></code> for an automatic
rate multiplier: the final number of produced macro-particles will be of the same order
as that of reactants.</p>
</dd></dl>

<hr class="docutils" />
</section>
<section id="radiation-reaction">
<span id="radiationreaction"></span><h2>Radiation reaction<a class="headerlink" href="#radiation-reaction" title="Link to this heading">¶</a></h2>
<p>The block <code class="docutils literal notranslate"><span class="pre">RadiationReaction()</span></code> enables to tune the radiation loss properties
(see <a class="reference internal" href="../Understand/radiation_loss.html"><span class="doc">High-energy photon emission &amp; radiation reaction</span></a>).
Many parameters are used for the generation of the cross-section tables
for the Monte-Carlo emission process.
If the tables already exist in the simulation directory, then they will be read
and no new table will be generated by <strong class="program">Smilei</strong>.
Otherwise, <strong class="program">Smilei</strong> can compute and output these
tables.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RadiationReaction</span><span class="p">(</span>

  <span class="c1"># Radiation parameters</span>
  <span class="n">minimum_chi_continuous</span> <span class="o">=</span> <span class="mf">1e-3</span><span class="p">,</span>
  <span class="n">minimum_chi_discontinuous</span> <span class="o">=</span> <span class="mf">1e-2</span><span class="p">,</span>
  <span class="n">table_path</span> <span class="o">=</span> <span class="s2">&quot;&lt;path to the external table folder&gt;&quot;</span><span class="p">,</span>

  <span class="c1"># Parameters for Niel et al.</span>
  <span class="n">Niel_computation_method</span> <span class="o">=</span> <span class="s2">&quot;table&quot;</span><span class="p">,</span>

<span class="p">)</span>
</pre></div>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="minimum_chi_continuous">
<span class="sig-name descname"><span class="pre">minimum_chi_continuous</span></span><a class="headerlink" href="#minimum_chi_continuous" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>1e-3</p>
</dd>
</dl>
<p>Threshold on the particle quantum parameter <em>particle_chi</em>. When a particle has a
quantum parameter below this threshold, radiation reaction is not taken
into account.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="minimum_chi_discontinuous">
<span class="sig-name descname"><span class="pre">minimum_chi_discontinuous</span></span><a class="headerlink" href="#minimum_chi_discontinuous" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>1e-2</p>
</dd>
</dl>
<p>Threshold on the particle quantum parameter <em>particle_chi</em> between the continuous
and the discontinuous radiation model.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="table_path">
<span class="sig-name descname"><span class="pre">table_path</span></span><a class="headerlink" href="#table_path" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code></p>
</dd>
</dl>
<p>Path to the <strong>directory</strong> that contains external tables for the radiation losses.
If empty, the default tables are used.
Default tables are embedded in the code.
External tables can be generated using the external tool <strong class="program">smilei_tables</strong> (see <a class="reference internal" href="tables.html"><span class="doc">Generation of the external tables</span></a>).</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="Niel_computation_method">
<span class="sig-name descname"><span class="pre">Niel_computation_method</span></span><a class="headerlink" href="#Niel_computation_method" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;table&quot;</span></code></p>
</dd>
</dl>
<p>Method to compute the value of the table <em>h</em> of Niel <em>et al</em> during the emission process.
The possible values are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;table&quot;</span></code>: the <em>h</em> function is tabulated. The table is computed at initialization or read from an external file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;fit5&quot;</span></code>: A polynomial fit of order 5 is used. No table is required.
The maximal relative error to the reference data is of maximum of 0.02.
The fit is valid for quantum parameters <span class="math notranslate nohighlight">\(\chi\)</span> between 1e-3 and 10.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;fit10&quot;</span></code>:  A polynomial fit of order 10 is used. No table is required.
The precision if better than the fit of order 5 with a maximal relative error of 0.0002.
The fit is valid for quantum parameters <span class="math notranslate nohighlight">\(\chi\)</span> between 1e-3 and 10.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;ridgers&quot;</span></code>: The fit of Ridgers given in Ridgers <em>et al.</em>, ArXiv 1708.04511 (2017)</p></li>
</ul>
<p>The use of tabulated values is best for accuracy but not for performance.
Table access prevent total vectorization.
Fits are vectorizable.</p>
</dd></dl>

<hr class="docutils" />
</section>
<section id="multiphoton-breit-wheeler">
<span id="multiphotonbreitwheeler"></span><h2>Multiphoton Breit-Wheeler<a class="headerlink" href="#multiphoton-breit-wheeler" title="Link to this heading">¶</a></h2>
<p>The block <code class="docutils literal notranslate"><span class="pre">MultiphotonBreitWheeler</span></code> enables to tune parameters of the
multiphoton Breit-Wheeler process and particularly the table generation.
For more information on this physical mechanism, see <a class="reference internal" href="../Understand/multiphoton_Breit_Wheeler.html"><span class="doc">Multiphoton Breit-Wheeler pair creation</span></a>.</p>
<p>There are three tables used for the multiphoton Breit-Wheeler refers to as the
<em>integration_dT_dchi</em>, <em>min_particle_chi_for_xi</em> and <em>xi</em> table.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MultiphotonBreitWheeler</span><span class="p">(</span>

  <span class="c1"># Path to the tables</span>
  <span class="n">table_path</span> <span class="o">=</span> <span class="s2">&quot;&lt;path to the external table folder&gt;&quot;</span><span class="p">,</span>

<span class="p">)</span>
</pre></div>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="id36">
<span class="sig-name descname"><span class="pre">table_path</span></span><a class="headerlink" href="#id36" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code></p>
</dd>
</dl>
<p>Path to the <strong>directory</strong> that contains external tables for the multiphoton Breit-Wheeler.
If empty, the default tables are used.
Default tables are embedded in the code.
External tables can be generated using the external tool <strong class="program">smilei_tables</strong> (see <a class="reference internal" href="tables.html"><span class="doc">Generation of the external tables</span></a>).</p>
</dd></dl>

<hr class="docutils" />
</section>
<section id="scalar-diagnostics">
<span id="diagscalar"></span><h2><em>Scalar</em> diagnostics<a class="headerlink" href="#scalar-diagnostics" title="Link to this heading">¶</a></h2>
<p><strong class="program">Smilei</strong> can collect various scalar data, such as total particle energy, total field energy, etc.
This is done by including the block <code class="docutils literal notranslate"><span class="pre">DiagScalar</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagScalar</span><span class="p">(</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">10</span> <span class="p">,</span>
    <span class="nb">vars</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Utot&quot;</span><span class="p">,</span> <span class="s2">&quot;Ukin&quot;</span><span class="p">,</span> <span class="s2">&quot;Uelm&quot;</span><span class="p">],</span>
    <span class="n">precision</span> <span class="o">=</span> <span class="mi">10</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="id37">
<span class="sig-name descname"><span class="pre">every</span></span><a class="headerlink" href="#id37" title="Link to this definition">¶</a></dt>
<dd><p>Number of timesteps between each output <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="vars">
<span class="sig-name descname"><span class="pre">vars</span></span><a class="headerlink" href="#vars" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">[]</span></code></p>
</dd>
</dl>
<div class="line-block">
<div class="line">List of scalars that will be actually output. Note that most scalars are computed anyways.</div>
<div class="line">Omit this argument to include all scalars.</div>
</div>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="precision">
<span class="sig-name descname"><span class="pre">precision</span></span><a class="headerlink" href="#precision" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>10</p>
</dd>
</dl>
<p>Number of digits of the outputs.</p>
</dd></dl>

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Scalars diagnostics min/max cell are not yet supported in <code class="docutils literal notranslate"><span class="pre">&quot;AMcylindrical&quot;</span></code> geometry.</p>
</div>
<p>The full list of available scalars is given in the table below.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>As some of these quantities are integrated in space and/or time, their
units are unusual, and depend on the simulation dimension.
All details <a class="reference internal" href="../Understand/units.html#integrated-quantities"><span class="std std-ref">here</span></a>.</p>
</div>
<table class="fancy docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>Space-integrated energy densities</strong></p></td>
</tr>
<tr class="row-even"><td><table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Utot</p></td>
<td><p>Total</p></td>
</tr>
<tr class="row-even"><td><p>Ukin</p></td>
<td><p>Total kinetic (in the particles)</p></td>
</tr>
<tr class="row-odd"><td><p>Uelm</p></td>
<td><p>Total electromagnetic (in the fields)</p></td>
</tr>
<tr class="row-even"><td><p>Uexp</p></td>
<td><p>Expected (Initial <span class="math notranslate nohighlight">\(-\)</span> lost <span class="math notranslate nohighlight">\(+\)</span> gained)</p></td>
</tr>
<tr class="row-odd"><td><p>Ubal</p></td>
<td><p>Balance (Utot <span class="math notranslate nohighlight">\(-\)</span> Uexp)</p></td>
</tr>
<tr class="row-even"><td><p>Ubal_norm</p></td>
<td><p>Normalized balance (Ubal <span class="math notranslate nohighlight">\(/\)</span> Utot)</p></td>
</tr>
<tr class="row-odd"><td><p>Uelm_Ex</p></td>
<td><p>Ex field contribution (<span class="math notranslate nohighlight">\(\int E_x^2 dV /2\)</span>)</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>… same for fields Ey, Ez, Bx_m, By_m and Bz_m</p></td>
</tr>
<tr class="row-odd"><td><p>Urad</p></td>
<td><p>Total radiated</p></td>
</tr>
<tr class="row-even"><td><p>UmBWpairs</p></td>
<td><p>Total energy converted into electron-position pairs</p></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="row-odd"><td><p><strong>Space- &amp; time-integrated Energies lost/gained at boundaries</strong></p></td>
</tr>
<tr class="row-even"><td><table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Ukin_bnd</p></td>
<td><p>Time-accumulated kinetic energy exchanged at the boundaries</p></td>
</tr>
<tr class="row-even"><td><p>Uelm_bnd</p></td>
<td><p>Time-accumulated EM energy exchanged at boundaries</p></td>
</tr>
<tr class="row-odd"><td><p>PoyXminInst</p></td>
<td><p>Poynting contribution through xmin boundary during the timestep</p></td>
</tr>
<tr class="row-even"><td><p>PoyXmin</p></td>
<td><p>Time-accumulated Poynting contribution through xmin boundary</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>… same for other boundaries</p></td>
</tr>
<tr class="row-even"><td><p>Ukin_new</p></td>
<td><p>Time-accumulated kinetic energy from new particles (injector)</p></td>
</tr>
<tr class="row-odd"><td><p>Ukin_out_mvw</p></td>
<td><p>Time-accumulated kinetic energy lost by the moving window</p></td>
</tr>
<tr class="row-even"><td><p>Ukin_inj_mvw</p></td>
<td><p>Time-accumulated kinetic energy gained by the moving window</p></td>
</tr>
<tr class="row-odd"><td><p>Uelm_out_mvw</p></td>
<td><p>Time-accumulated EM energy lost by the moving window</p></td>
</tr>
<tr class="row-even"><td><p>Uelm_inj_mvw</p></td>
<td><p>Time-accumulated EM energy gained by the moving window</p></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="row-odd"><td><p><strong>Particle information</strong></p></td>
</tr>
<tr class="row-even"><td><table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>Zavg_abc</p></td>
<td><p>Average charge of species “abc” (equals <code class="docutils literal notranslate"><span class="pre">nan</span></code> if no particle)</p></td>
</tr>
<tr class="row-even"><td><p>Dens_abc</p></td>
<td><p>… its integrated density</p></td>
</tr>
<tr class="row-odd"><td><p>Ukin_abc</p></td>
<td><p>… its integrated kinetic energy density</p></td>
</tr>
<tr class="row-even"><td><p>Urad_abc</p></td>
<td><p>… its integrated radiated energy density</p></td>
</tr>
<tr class="row-odd"><td><p>Ntot_abc</p></td>
<td><p>… and number of macro-particles</p></td>
</tr>
<tr class="row-even"><td></td>
<td></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="row-odd"><td><p><strong>Fields information</strong></p></td>
</tr>
<tr class="row-even"><td><table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>ExMin</p></td>
<td><p>Minimum of <span class="math notranslate nohighlight">\(E_x\)</span></p></td>
</tr>
<tr class="row-even"><td><p>ExMinCell</p></td>
<td><p>… and its location (cell index)</p></td>
</tr>
<tr class="row-odd"><td><p>ExMax</p></td>
<td><p>Maximum of <span class="math notranslate nohighlight">\(E_x\)</span></p></td>
</tr>
<tr class="row-even"><td><p>ExMaxCell</p></td>
<td><p>… and its location (cell index)</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>… same for fields Ey Ez Bx_m By_m Bz_m Jx Jy Jz Rho</p></td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>Checkout the <a class="reference internal" href="post-processing.html"><span class="doc">post-processing</span></a> documentation as well.</p>
<hr class="docutils" />
</section>
<section id="fields-diagnostics">
<span id="diagfields"></span><h2><em>Fields</em> diagnostics<a class="headerlink" href="#fields-diagnostics" title="Link to this heading">¶</a></h2>
<p><strong class="program">Smilei</strong> can collect various field data (electromagnetic fields, currents and density)
taken at the location of the PIC grid, both as instantaneous values and averaged values.
This is done by including a block <code class="docutils literal notranslate"><span class="pre">DiagFields</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagFields</span><span class="p">(</span>
    <span class="c1">#name = &quot;my field diag&quot;,</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">time_average</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Ey&quot;</span><span class="p">,</span> <span class="s2">&quot;Ez&quot;</span><span class="p">],</span>
    <span class="c1">#subgrid = None</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="id38">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#id38" title="Link to this definition">¶</a></dt>
<dd><p>Optional name of the diagnostic. Used only for post-processing purposes.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id39">
<span class="sig-name descname"><span class="pre">every</span></span><a class="headerlink" href="#id39" title="Link to this definition">¶</a></dt>
<dd><p>Number of timesteps between each output <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="flush_every">
<span class="sig-name descname"><span class="pre">flush_every</span></span><a class="headerlink" href="#flush_every" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>1</p>
</dd>
</dl>
<p>Number of timesteps <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">flush_every</span></code> coincides with <code class="docutils literal notranslate"><span class="pre">every</span></code>, the output
file is actually written (“flushed” from the buffer). Flushing
too often can <em>dramatically</em> slow down the simulation.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="time_average">
<span class="sig-name descname"><span class="pre">time_average</span></span><a class="headerlink" href="#time_average" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">1</span></code> <em>(no averaging)</em></p>
</dd>
</dl>
<p>The number of timesteps for time-averaging.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="fields">
<span class="sig-name descname"><span class="pre">fields</span></span><a class="headerlink" href="#fields" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">[]</span></code> <em>(all fields are written)</em></p>
</dd>
</dl>
<p>List of the field names that are saved. By default, they all are.
The full list of fields that are saved by this diagnostic:</p>
<table class="fancy docutils align-default">
<tbody>
<tr class="row-odd"><td><div class="line-block">
<div class="line">Bx</div>
<div class="line">By</div>
<div class="line">Bz</div>
</div>
</td>
<td><div class="line-block">
<div class="line"><br /></div>
<div class="line">Components of the magnetic field</div>
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">Bx_m</div>
<div class="line">By_m</div>
<div class="line">Bz_m</div>
</div>
</td>
<td><div class="line-block">
<div class="line"><br /></div>
<div class="line">Components of the magnetic field (time-centered)</div>
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line">Ex</div>
<div class="line">Ey</div>
<div class="line">Ez</div>
</div>
</td>
<td><div class="line-block">
<div class="line"><br /></div>
<div class="line">Components of the electric field</div>
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">Jx</div>
<div class="line">Jy</div>
<div class="line">Jz</div>
</div>
</td>
<td><div class="line-block">
<div class="line"><br /></div>
<div class="line">Components of the total current</div>
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line">Jx_abc</div>
<div class="line">Jy_abc</div>
<div class="line">Jz_abc</div>
</div>
</td>
<td><div class="line-block">
<div class="line"><br /></div>
<div class="line">Components of the current due to species “abc”</div>
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">Rho</div>
<div class="line">Rho_abc</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Total charge density</div>
<div class="line">Charge density of species “abc”</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>In <code class="docutils literal notranslate"><span class="pre">AMcylindrical</span></code> geometry, the <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code> and <code class="docutils literal notranslate"><span class="pre">z</span></code>
indices are replaced by <code class="docutils literal notranslate"><span class="pre">l</span></code> (longitudinal), <code class="docutils literal notranslate"><span class="pre">r</span></code> (radial) and <code class="docutils literal notranslate"><span class="pre">t</span></code> (theta). In addition,
the angular Fourier modes are denoted by the suffix <code class="docutils literal notranslate"><span class="pre">_mode_i</span></code> where <code class="docutils literal notranslate"><span class="pre">i</span></code>
is the mode number.
If a field is specified without its associated mode number, all available modes will be included.
In summary, the list of fields reads as follows.</p>
<table class="fancy docutils align-default">
<tbody>
<tr class="row-odd"><td><div class="line-block">
<div class="line">Bl_mode_0, Bl_mode_1, etc.</div>
<div class="line">Br_mode_0, Br_mode_1, etc.</div>
<div class="line">Bt_mode_0, Bt_mode_1, etc.</div>
</div>
</td>
<td><div class="line-block">
<div class="line"><br /></div>
<div class="line">Components of the magnetic field</div>
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">El_mode_0, El_mode_1, etc.</div>
<div class="line">Er_mode_0, Er_mode_1, etc.</div>
<div class="line">Et_mode_0, Et_mode_1, etc.</div>
</div>
</td>
<td><div class="line-block">
<div class="line"><br /></div>
<div class="line">Components of the electric field</div>
<div class="line"><br /></div>
</div>
</td>
</tr>
<tr class="row-odd"><td colspan="2"><p>The same notation works for Jl, Jr, Jt, and Rho</p></td>
</tr>
</tbody>
</table>
<p>In the case of an envelope model for the laser (see <a class="reference internal" href="../Understand/laser_envelope.html"><span class="doc">Laser envelope model</span></a>),
the following fields are also available:</p>
<table class="fancy docutils align-default">
<tbody>
<tr class="row-odd"><td><div class="line-block">
<div class="line"><br /></div>
<div class="line">Env_A_abs</div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line">Module of laser vector potential’s complex envelope</div>
<div class="line"><span class="math notranslate nohighlight">\(\tilde{A}\)</span> (component along the transverse</div>
<div class="line">direction)</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">Env_Chi</div>
</div>
</td>
<td><div class="line-block">
<div class="line">Total  susceptibility <span class="math notranslate nohighlight">\(\chi\)</span></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="line-block">
<div class="line"><br /></div>
<div class="line">Env_E_abs</div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line">Module of laser electric field’s complex envelope</div>
<div class="line"><span class="math notranslate nohighlight">\(\tilde{E}\)</span> (component along the transverse</div>
<div class="line">direction)</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line"><br /></div>
<div class="line">Env_Ex_abs</div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line">Module of laser electric field’s complex envelope</div>
<div class="line"><span class="math notranslate nohighlight">\(\tilde{E}_x\)</span> (component along the propagation</div>
<div class="line">direction)</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>In the case the B-TIS3 interpolation is activated (see <a class="reference internal" href="../Understand/algorithms.html"><span class="doc">PIC algorithms</span></a>),
the following fields are also available:</p>
<table class="fancy docutils align-default">
<tbody>
<tr class="row-odd"><td><div class="line-block">
<div class="line">By_mBTIS3</div>
<div class="line">By_mBTIS3</div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line">Components of the magnetic field</div>
<div class="line">for the B-TIS3 interpolation</div>
<div class="line">(time-centered)</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">Br_mBTIS3_mode_0, Br_mBTIS3_mode_1, etc.</div>
<div class="line">Bt_mBTIS3_mode_0, Bt+mBTIS3_mode_1, etc.</div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line">Components of the magnetic field</div>
<div class="line">for the B-TIS3 interpolation</div>
<div class="line">(<code class="docutils literal notranslate"><span class="pre">AMcylindrical</span></code> geometry, time-centered)</div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In a given <cite>DiagFields</cite>, all fields must be of the same kind: either real or complex. Therefore To write these last three envelope real fields in <code class="docutils literal notranslate"><span class="pre">&quot;AMcylindrical&quot;</span></code> geometry,
a dedicated block <code class="docutils literal notranslate"><span class="pre">DiagFields</span></code> must be defined, e.g. with <code class="docutils literal notranslate"><span class="pre">fields</span> <span class="pre">=</span> <span class="pre">[&quot;Env_A_abs&quot;,</span> <span class="pre">&quot;Env_Chi&quot;]</span></code>.</p>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="subgrid">
<span class="sig-name descname"><span class="pre">subgrid</span></span><a class="headerlink" href="#subgrid" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">None</span></code> <em>(the whole grid is used)</em></p>
</dd>
</dl>
<p>A list of slices indicating a portion of the simulation grid to be written by this
diagnostic. This list must have as many elements as the simulation dimension.
For example, in a 3D simulation, the list has 3 elements. Each element can be:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>, to select the whole grid along that dimension</p></li>
<li><p>an integer, to select only the corresponding cell index along that dimension</p></li>
<li><p>a <em>python</em> <a class="reference external" href="https://docs.python.org/3/library/functions.html#slice">slice object</a>
to select regularly-spaced cell indices along that dimension.</p></li>
</ul>
<p>This can be easily implemented using the
<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.s_.html">numpy.s_ expression</a>.
For instance, in a 3D simulation, the following subgrid selects only every other element
in each dimension:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">s_</span>
<span class="n">DiagFields</span><span class="p">(</span> <span class="c1">#...</span>
    <span class="n">subgrid</span> <span class="o">=</span> <span class="n">s_</span><span class="p">[::</span><span class="mi">2</span><span class="p">,</span> <span class="p">::</span><span class="mi">2</span><span class="p">,</span> <span class="p">::</span><span class="mi">2</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>while this one selects cell indices included in a contiguous parallelepiped:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">subgrid</span> <span class="o">=</span> <span class="n">s_</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">:</span><span class="mi">500</span><span class="p">,</span> <span class="mi">300</span><span class="p">:</span><span class="mi">600</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="datatype">
<span class="sig-name descname"><span class="pre">datatype</span></span><a class="headerlink" href="#datatype" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;double&quot;</span></code></p>
</dd>
</dl>
<p>The data type when written to the HDF5 file. Accepts <code class="docutils literal notranslate"><span class="pre">&quot;double&quot;</span></code> (8 bytes) or <code class="docutils literal notranslate"><span class="pre">&quot;float&quot;</span></code> (4 bytes).</p>
</dd></dl>

<hr class="docutils" />
</section>
<section id="probe-diagnostics">
<span id="diagprobe"></span><h2><em>Probe</em> diagnostics<a class="headerlink" href="#probe-diagnostics" title="Link to this heading">¶</a></h2>
<p>The fields from the previous section are taken at the PIC grid locations,
but it is also possible to obtain the fields at arbitrary locations.
These are called <em>probes</em>.</p>
<p>A probe interpolates the fields at either one point (0-D),
several points arranged in a line (1-D),
or several points arranged in a 2-D or 3-D grid.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p><strong>Probes follow the moving window.</strong>
To obtain the fields at fixed points in the plasma instead, create a cold,
chargeless species, and <a class="reference internal" href="#diagtrackparticles"><span class="std std-ref">track the particles</span></a>.</p></li>
<li><p><strong>In “AMcylindrical” geometry</strong>, probes are defined with 3D Cartesian coordinates
and cannot be separated per mode. Use Field diagnostics for cylindrical coordinates and
information per mode.</p></li>
<li><p><strong>Probes rely on the particle interpolator to compute fields</strong> so that the
magnetic field is shifted by half a timestep compared to that of <em>Fields</em> diagnostics.</p></li>
</ul>
</div>
<p>To add one probe diagnostic, include the block <code class="docutils literal notranslate"><span class="pre">DiagProbe</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagProbe</span><span class="p">(</span>
    <span class="c1">#name = &quot;my_probe&quot;,</span>
    <span class="n">every</span>    <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">origin</span>   <span class="o">=</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
    <span class="n">corners</span>  <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="mf">1.</span><span class="p">,</span><span class="mf">10.</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">10.</span><span class="p">,</span><span class="mf">1.</span><span class="p">],</span>
    <span class="p">],</span>
    <span class="n">number</span>   <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
    <span class="n">fields</span>   <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Ex&quot;</span><span class="p">,</span> <span class="s2">&quot;Ey&quot;</span><span class="p">,</span> <span class="s2">&quot;Ez&quot;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="id40">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#id40" title="Link to this definition">¶</a></dt>
<dd><p>Optional name of the diagnostic. Used only for post-processing purposes.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id41">
<span class="sig-name descname"><span class="pre">every</span></span><a class="headerlink" href="#id41" title="Link to this definition">¶</a></dt>
<dd><p>Number of timesteps between each output <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id42">
<span class="sig-name descname"><span class="pre">flush_every</span></span><a class="headerlink" href="#id42" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>1</p>
</dd>
</dl>
<p>Number of timesteps <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">flush_every</span></code> coincides with <code class="docutils literal notranslate"><span class="pre">every</span></code>, the output
file is actually written (“flushed” from the buffer). Flushing
too often can <em>dramatically</em> slow down the simulation.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="origin">
<span class="sig-name descname"><span class="pre">origin</span></span><a class="headerlink" href="#origin" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of floats, of length equal to the simulation dimensionality.</p>
</dd>
</dl>
<p>The coordinates of the origin of the probe grid</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="corners">
<span class="sig-name descname"><span class="pre">corners</span></span><a class="headerlink" href="#corners" title="Link to this definition">¶</a></dt>
<dt class="sig sig-object py" id="vectors">
<span class="sig-name descname"><span class="pre">vectors</span></span><a class="headerlink" href="#vectors" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of lists of floats.</p>
</dd>
</dl>
<p>Defines the corners of the probe grid.
Each corner is a list of coordinates (as many as the simulation dimensions).</p>
<p>When using <code class="docutils literal notranslate"><span class="pre">corners</span></code>, the absolute coordinates of each corner must be specified.
When using <code class="docutils literal notranslate"><span class="pre">vectors</span></code>, the coordinates relative to <a class="reference internal" href="#origin" title="origin"><code class="xref py py-data docutils literal notranslate"><span class="pre">origin</span></code></a> must be specified.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="number">
<span class="sig-name descname"><span class="pre">number</span></span><a class="headerlink" href="#number" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of integers, one for each dimension of the probe.</p>
</dd>
</dl>
<p>The number of points in each probe axis. Must not be defined for a 0-D probe.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id43">
<span class="sig-name descname"><span class="pre">fields</span></span><a class="headerlink" href="#id43" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">[]</span></code>, which means <code class="docutils literal notranslate"><span class="pre">[&quot;Ex&quot;,</span> <span class="pre">&quot;Ey&quot;,</span> <span class="pre">&quot;Ez&quot;,</span> <span class="pre">&quot;Bx&quot;,</span> <span class="pre">&quot;By&quot;,</span> <span class="pre">&quot;Bz&quot;,</span> <span class="pre">&quot;Jx&quot;,</span> <span class="pre">&quot;Jy&quot;,</span> <span class="pre">&quot;Jz&quot;,</span> <span class="pre">&quot;Rho&quot;]</span></code></p>
</dd>
</dl>
<p>A list of fields among:</p>
<ul class="simple">
<li><p>the electric field components <code class="docutils literal notranslate"><span class="pre">&quot;Ex&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Ey&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Ez&quot;</span></code></p></li>
<li><p>the magnetic field components <code class="docutils literal notranslate"><span class="pre">&quot;Bx&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;By&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Bz&quot;</span></code></p></li>
<li><p>the Poynting vector components <code class="docutils literal notranslate"><span class="pre">&quot;PoyX&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;PoyY&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;PoyZ&quot;</span></code></p></li>
<li><p>the current density components <code class="docutils literal notranslate"><span class="pre">&quot;Jx&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Jy&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Jz&quot;</span></code> and charge density <code class="docutils literal notranslate"><span class="pre">&quot;Rho&quot;</span></code></p></li>
<li><p>the current density <code class="docutils literal notranslate"><span class="pre">&quot;Jx_abc&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Jy_abc&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Jz_abc&quot;</span></code> and charge density <code class="docutils literal notranslate"><span class="pre">&quot;Rho_abc&quot;</span></code>
of a given species named <code class="docutils literal notranslate"><span class="pre">&quot;abc&quot;</span></code></p></li>
</ul>
<p>In the case of an envelope model for the laser (see <a class="reference internal" href="../Understand/laser_envelope.html"><span class="doc">Laser envelope model</span></a>),
the following fields are also available: <code class="docutils literal notranslate"><span class="pre">&quot;Env_Chi&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Env_A_abs&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Env_E_abs&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Env_Ex_abs&quot;</span></code>.
They are respectively the susceptibility, the envelope of the laser transverse vector potential,
the envelope of the laser transverse electric field and the envelope of the laser longitudinal
electric field.</p>
<p>If the B-TIS3 interpolation scheme is activated (see <a class="reference internal" href="../Understand/algorithms.html"><span class="doc">PIC algorithms</span></a>),
the following fields are also available: <code class="docutils literal notranslate"><span class="pre">&quot;ByBTIS3&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;BzBTIS3&quot;</span></code>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="time_integral">
<span class="sig-name descname"><span class="pre">time_integral</span></span><a class="headerlink" href="#time_integral" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the output is integrated over time. As this option forces field interpolation
at every timestep, it is recommended to use few probe points.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id44">
<span class="sig-name descname"><span class="pre">datatype</span></span><a class="headerlink" href="#id44" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;double&quot;</span></code></p>
</dd>
</dl>
<p>The data type when written to the HDF5 file. Accepts <code class="docutils literal notranslate"><span class="pre">&quot;double&quot;</span></code> (8 bytes) or <code class="docutils literal notranslate"><span class="pre">&quot;float&quot;</span></code> (4 bytes).</p>
</dd></dl>

<p><strong>Examples of probe diagnostics</strong></p>
<ul>
<li><p>0-D probe in 1-D simulation</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagProbe</span><span class="p">(</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">origin</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>1-D probe in 1-D simulation</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagProbe</span><span class="p">(</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">origin</span>  <span class="o">=</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">],</span>
    <span class="n">corners</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">5.6</span><span class="p">]],</span>
    <span class="n">number</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>1-D probe in 2-D simulation</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagProbe</span><span class="p">(</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">origin</span>  <span class="o">=</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">4.</span><span class="p">],</span>
    <span class="n">corners</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">5.6</span><span class="p">,</span> <span class="mf">4.</span><span class="p">]],</span>
    <span class="n">number</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>2-D probe in 2-D simulation</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagProbe</span><span class="p">(</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">origin</span>   <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
    <span class="n">corners</span>  <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="mf">10.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">10.</span><span class="p">]</span> <span class="p">],</span>
    <span class="n">number</span>   <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<hr class="docutils" />
</section>
<section id="particlebinning-diagnostics">
<span id="diagparticlebinning"></span><h2><em>ParticleBinning</em> diagnostics<a class="headerlink" href="#particlebinning-diagnostics" title="Link to this heading">¶</a></h2>
<p>A <em>particle binning diagnostic</em> collects data from the macro-particles and processes them during runtime.
It does not provide information on individual particles: instead, it produces
<strong>averaged quantities</strong> like the particle density, currents, etc.
The raw data and how it is post-processed by happi is described <a class="reference internal" href="binning_units.html"><span class="doc">here</span></a>.</p>
<p>The data is discretized inside a “grid” chosen by the user. This grid may be of any dimension.</p>
<p>Examples:</p>
<ul class="simple">
<li><p>1-dimensional grid along the position <span class="math notranslate nohighlight">\(x\)</span> (gives density variation along <span class="math notranslate nohighlight">\(x\)</span>)</p></li>
<li><p>2-dimensional grid along positions <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> (gives density map)</p></li>
<li><p>1-dimensional grid along the velocity <span class="math notranslate nohighlight">\(v_x\)</span> (gives the velocity distribution)</p></li>
<li><p>2-dimensional grid along position <span class="math notranslate nohighlight">\(x\)</span> and momentum <span class="math notranslate nohighlight">\(p_x\)</span> (gives the phase-space)</p></li>
<li><p>1-dimensional grid along the kinetic energy <span class="math notranslate nohighlight">\(E_\mathrm{kin}\)</span> (gives the energy distribution)</p></li>
<li><p>3-dimensional grid along <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(E_\mathrm{kin}\)</span> (gives the density map for several energies)</p></li>
<li><p>1-dimensional grid along the charge <span class="math notranslate nohighlight">\(Z^\star\)</span> (gives the charge distribution)</p></li>
<li><p>0-dimensional grid (simply gives the total integrated particle density)</p></li>
</ul>
<p>Each dimension of the grid is called “axis”.</p>
<p>You can add a particle binning diagnostic by including a block <code class="docutils literal notranslate"><span class="pre">DiagParticleBinning()</span></code> in the namelist,
for instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagParticleBinning</span><span class="p">(</span>
    <span class="c1">#name = &quot;my binning&quot;,</span>
    <span class="n">deposited_quantity</span> <span class="o">=</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">time_average</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;electrons1&quot;</span><span class="p">,</span> <span class="s2">&quot;electrons2&quot;</span><span class="p">],</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;ekin&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="s2">&quot;logscale&quot;</span><span class="p">,</span> <span class="s2">&quot;edge_inclusive&quot;</span><span class="p">]</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="id45">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#id45" title="Link to this definition">¶</a></dt>
<dd><p>Optional name of the diagnostic. Used only for post-processing purposes.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="deposited_quantity">
<span class="sig-name descname"><span class="pre">deposited_quantity</span></span><a class="headerlink" href="#deposited_quantity" title="Link to this definition">¶</a></dt>
<dd><p>The type of data that is summed in each cell of the grid.
Consider reading <a class="reference internal" href="../Understand/units.html#weights"><span class="std std-ref">this</span></a> to understand the meaning of the <code class="docutils literal notranslate"><span class="pre">weight</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;weight&quot;</span></code> results in a number density.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;weight_charge&quot;</span></code> results in a charge density.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;weight_charge_vx&quot;</span></code> results in the <span class="math notranslate nohighlight">\(j_x\)</span> current density (same with <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(z\)</span>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;weight_p&quot;</span></code> results in the momentum density (same with <span class="math notranslate nohighlight">\(p_x\)</span>, <span class="math notranslate nohighlight">\(p_y\)</span> and <span class="math notranslate nohighlight">\(p_z\)</span>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;weight_ekin&quot;</span></code> results in the energy density.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;weight_vx_px&quot;</span></code> results in the <code class="docutils literal notranslate"><span class="pre">xx</span></code> pressure (same with yy, zz, xy, yz and xz).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;weight_chi&quot;</span></code> results in the quantum parameter density (only for species with radiation losses).</p></li>
<li><p>with a user-defined python function, an arbitrary quantity can be calculated (the <em>numpy</em>
module is necessary). This function should take one argument, for instance
<code class="docutils literal notranslate"><span class="pre">particles</span></code>, which contains the attributes <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, <code class="docutils literal notranslate"><span class="pre">z</span></code>, <code class="docutils literal notranslate"><span class="pre">px</span></code>, <code class="docutils literal notranslate"><span class="pre">py</span></code>,
<code class="docutils literal notranslate"><span class="pre">pz</span></code>, <code class="docutils literal notranslate"><span class="pre">charge</span></code>, <code class="docutils literal notranslate"><span class="pre">weight</span></code>, <code class="docutils literal notranslate"><span class="pre">chi</span></code> and <code class="docutils literal notranslate"><span class="pre">id</span></code> (additionally, it may also have the
attributes <code class="docutils literal notranslate"><span class="pre">Ex</span></code>, <code class="docutils literal notranslate"><span class="pre">Bx</span></code>, <code class="docutils literal notranslate"><span class="pre">Ey</span></code>, and so on, depending on <a class="reference internal" href="#keep_interpolated_fields" title="keep_interpolated_fields"><code class="xref py py-data docutils literal notranslate"><span class="pre">keep_interpolated_fields</span></code></a>).
Each of these attributes is a <em>numpy</em> array
containing the data of all particles in one patch. The function must return a <em>numpy</em>
array of the same shape, containing the desired deposition of each particle. For example,
defining the following function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">stuff</span><span class="p">(</span><span class="n">particles</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">particles</span><span class="o">.</span><span class="n">weight</span> <span class="o">*</span> <span class="n">particles</span><span class="o">.</span><span class="n">px</span>
</pre></div>
</div>
<p>passed as <code class="docutils literal notranslate"><span class="pre">deposited_quantity=stuff</span></code>, the diagnostic will sum the weights
<span class="math notranslate nohighlight">\(\times\; p_x\)</span>.</p>
<p>You may also pass directly an implicit (<em>lambda</em>) function using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">deposited_quantity</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">p</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">weight</span> <span class="o">*</span> <span class="n">p</span><span class="o">.</span><span class="n">px</span>
</pre></div>
</div>
</li>
</ul>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id46">
<span class="sig-name descname"><span class="pre">every</span></span><a class="headerlink" href="#id46" title="Link to this definition">¶</a></dt>
<dd><p>The number of time-steps between each output, <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id47">
<span class="sig-name descname"><span class="pre">flush_every</span></span><a class="headerlink" href="#id47" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>1</p>
</dd>
</dl>
<p>Number of timesteps <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">flush_every</span></code> coincides with <code class="docutils literal notranslate"><span class="pre">every</span></code>, the output
file is actually written (“flushed” from the buffer). Flushing
too often can <em>dramatically</em> slow down the simulation.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id48">
<span class="sig-name descname"><span class="pre">time_average</span></span><a class="headerlink" href="#id48" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>1</p>
</dd>
</dl>
<p>The number of time-steps during which the data is averaged. The data is averaged over <cite>time_average</cite> consecutive iterations after the selected time.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id49">
<span class="sig-name descname"><span class="pre">species</span></span><a class="headerlink" href="#id49" title="Link to this definition">¶</a></dt>
<dd><p>A list of one or several species’ <a class="reference internal" href="#id56" title="name"><code class="xref py py-data docutils literal notranslate"><span class="pre">name</span></code></a>.
All these species are combined into the same diagnostic.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="axes">
<span class="sig-name descname"><span class="pre">axes</span></span><a class="headerlink" href="#axes" title="Link to this definition">¶</a></dt>
<dd><p>A list of <em>axes</em> that define the grid.
There may be as many axes as wanted (there may be zero axes).</p>
<p>Syntax of one axis: <code class="docutils literal notranslate"><span class="pre">[type,</span> <span class="pre">min,</span> <span class="pre">max,</span> <span class="pre">nsteps,</span> <span class="pre">&quot;logscale&quot;,</span> <span class="pre">&quot;edge_inclusive&quot;]</span></code></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">type</span></code> is one of:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;x&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;y&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;z&quot;</span></code>: spatial coordinates (<code class="docutils literal notranslate"><span class="pre">&quot;moving_x&quot;</span></code> with a <a class="reference internal" href="#movingwindow"><span class="std std-ref">moving window</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;px&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;py&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;pz&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;p&quot;</span></code>: momenta</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;vx&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;vy&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;vz&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;v&quot;</span></code>: velocities</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;gamma&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;ekin&quot;</span></code>: energies</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;chi&quot;</span></code>: quantum parameter</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;charge&quot;</span></code>: the particles’ electric charge</p></li>
<li><p>or a <em>python function</em> with the same syntax as the <code class="docutils literal notranslate"><span class="pre">deposited_quantity</span></code>.
Namely, this function must accept one argument only, for instance <code class="docutils literal notranslate"><span class="pre">particles</span></code>,
which holds the attributes <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, <code class="docutils literal notranslate"><span class="pre">z</span></code>, <code class="docutils literal notranslate"><span class="pre">px</span></code>, <code class="docutils literal notranslate"><span class="pre">py</span></code>, <code class="docutils literal notranslate"><span class="pre">pz</span></code>, <code class="docutils literal notranslate"><span class="pre">charge</span></code>,
<code class="docutils literal notranslate"><span class="pre">weight</span></code> and <code class="docutils literal notranslate"><span class="pre">id</span></code>. Each of these attributes is a <em>numpy</em> array containing the
data of all particles in one patch. The function must return a <em>numpy</em> array of
the same shape, containing the desired quantity of each particle that will decide
its location in the histogram binning.</p></li>
</ul>
</li>
<li><p>The axis is discretized for <code class="docutils literal notranslate"><span class="pre">type</span></code> from <code class="docutils literal notranslate"><span class="pre">min</span></code> to <code class="docutils literal notranslate"><span class="pre">max</span></code> in <code class="docutils literal notranslate"><span class="pre">nsteps</span></code> bins.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">min</span></code> and <code class="docutils literal notranslate"><span class="pre">max</span></code> may be set to <code class="docutils literal notranslate"><span class="pre">&quot;auto&quot;</span></code> so that they are automatically
computed from all the particles in the simulation. This option can be bad for performances.</p></li>
<li><p>The optional keyword <code class="docutils literal notranslate"><span class="pre">logscale</span></code> sets the axis scale to logarithmic instead of linear
(bins become uneven).</p></li>
<li><p>The optional keyword <code class="docutils literal notranslate"><span class="pre">edge_inclusive</span></code> includes the particles outside the range
[<code class="docutils literal notranslate"><span class="pre">min</span></code>, <code class="docutils literal notranslate"><span class="pre">max</span></code>] into the extrema bins.</p></li>
</ul>
</dd></dl>

<p><strong>Examples of particle binning diagnostics</strong></p>
<ul>
<li><p>Variation of the density of species <code class="docutils literal notranslate"><span class="pre">electron1</span></code>
from <span class="math notranslate nohighlight">\(x=0\)</span> to 1, every 5 time-steps, without time-averaging</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagParticleBinning</span><span class="p">(</span>
    <span class="n">deposited_quantity</span> <span class="o">=</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">time_average</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;electron1&quot;</span><span class="p">],</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>    <span class="mf">0.</span><span class="p">,</span>    <span class="mf">1.</span><span class="p">,</span>    <span class="mi">30</span><span class="p">]</span> <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Density map from <span class="math notranslate nohighlight">\(x=0\)</span> to 1, <span class="math notranslate nohighlight">\(y=0\)</span> to 1</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagParticleBinning</span><span class="p">(</span>
    <span class="n">deposited_quantity</span> <span class="o">=</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">time_average</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;electron1&quot;</span><span class="p">],</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>    <span class="mf">0.</span><span class="p">,</span>    <span class="mf">1.</span><span class="p">,</span>    <span class="mi">30</span><span class="p">],</span>
             <span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>    <span class="mf">0.</span><span class="p">,</span>    <span class="mf">1.</span><span class="p">,</span>    <span class="mi">30</span><span class="p">]</span> <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Velocity distribution from <span class="math notranslate nohighlight">\(v_x = -0.1\)</span> to <span class="math notranslate nohighlight">\(0.1\)</span></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagParticleBinning</span><span class="p">(</span>
    <span class="n">deposited_quantity</span> <span class="o">=</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">time_average</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;electron1&quot;</span><span class="p">],</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="s2">&quot;vx&quot;</span><span class="p">,</span>   <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span>    <span class="mf">0.1</span><span class="p">,</span>    <span class="mi">100</span><span class="p">]</span> <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Phase space from <span class="math notranslate nohighlight">\(x=0\)</span> to 1 and from <span class="math notranslate nohighlight">\(px=-1\)</span> to 1</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagParticleBinning</span><span class="p">(</span>
    <span class="n">deposited_quantity</span> <span class="o">=</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">time_average</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;electron1&quot;</span><span class="p">],</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>    <span class="mf">0.</span><span class="p">,</span>    <span class="mf">1.</span><span class="p">,</span>    <span class="mi">30</span><span class="p">],</span>
             <span class="p">[</span><span class="s2">&quot;px&quot;</span><span class="p">,</span>   <span class="o">-</span><span class="mf">1.</span><span class="p">,</span>   <span class="mf">1.</span><span class="p">,</span>    <span class="mi">100</span><span class="p">]</span> <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Energy distribution from 0.01 to 1 MeV in logarithmic scale.
Note that the input units are <span class="math notranslate nohighlight">\(m_ec^2 \sim 0.5\)</span> MeV</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagParticleBinning</span><span class="p">(</span>
    <span class="n">deposited_quantity</span> <span class="o">=</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">time_average</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;electron1&quot;</span><span class="p">],</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="s2">&quot;ekin&quot;</span><span class="p">,</span>    <span class="mf">0.02</span><span class="p">,</span>    <span class="mf">2.</span><span class="p">,</span>   <span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;logscale&quot;</span><span class="p">]</span> <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><span class="math notranslate nohighlight">\(x\)</span>-<span class="math notranslate nohighlight">\(y\)</span> density maps for three bands of energy: <span class="math notranslate nohighlight">\([0,1]\)</span>, <span class="math notranslate nohighlight">\([1,2]\)</span>, <span class="math notranslate nohighlight">\([2,\infty]\)</span>.
Note the use of <code class="docutils literal notranslate"><span class="pre">edge_inclusive</span></code> to reach energies up to <span class="math notranslate nohighlight">\(\infty\)</span></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagParticleBinning</span><span class="p">(</span>
    <span class="n">deposited_quantity</span> <span class="o">=</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">time_average</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;electron1&quot;</span><span class="p">],</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>    <span class="mf">0.</span><span class="p">,</span>    <span class="mf">1.</span><span class="p">,</span>    <span class="mi">30</span><span class="p">],</span>
             <span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>    <span class="mf">0.</span><span class="p">,</span>    <span class="mf">1.</span><span class="p">,</span>    <span class="mi">30</span><span class="p">],</span>
             <span class="p">[</span><span class="s2">&quot;ekin&quot;</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span>    <span class="mf">6.</span><span class="p">,</span>    <span class="mi">3</span><span class="p">,</span>  <span class="s2">&quot;edge_inclusive&quot;</span><span class="p">]</span> <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Charge distribution from <span class="math notranslate nohighlight">\(Z^\star =0\)</span> to 10</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagParticleBinning</span><span class="p">(</span>
    <span class="n">deposited_quantity</span> <span class="o">=</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">time_average</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;electron1&quot;</span><span class="p">],</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="s2">&quot;charge&quot;</span><span class="p">,</span>    <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>   <span class="mf">10.5</span><span class="p">,</span>   <span class="mi">11</span><span class="p">]</span> <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<hr class="docutils" />
</section>
<section id="screen-diagnostics">
<span id="diagscreen"></span><h2><em>Screen</em> diagnostics<a class="headerlink" href="#screen-diagnostics" title="Link to this heading">¶</a></h2>
<p>A <em>screen</em> collects data from the macro-particles when they cross a surface.
It processes this data similarly to the <a class="reference internal" href="#diagparticlebinning"><span class="std std-ref">particle binning diagnostics</span></a>
as it makes a histogram of the macro-particle properties. There are two differences:</p>
<ul class="simple">
<li><p>the histogram is made only by the particles that cross the surface</p></li>
<li><p>the data is accumulated for all timesteps.</p></li>
</ul>
<p>You can add a screen by including a block <code class="docutils literal notranslate"><span class="pre">DiagScreen()</span></code> in the namelist,
for instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagScreen</span><span class="p">(</span>
    <span class="c1">#name = &quot;my screen&quot;,</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="s2">&quot;plane&quot;</span><span class="p">,</span>
    <span class="n">point</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">],</span>
    <span class="n">vector</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
    <span class="n">direction</span> <span class="o">=</span> <span class="s2">&quot;canceling&quot;</span><span class="p">,</span>
    <span class="n">deposited_quantity</span> <span class="o">=</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span>
    <span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;electron&quot;</span><span class="p">],</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.</span><span class="o">*</span><span class="n">l0</span><span class="p">,</span> <span class="mf">10.</span><span class="o">*</span><span class="n">l0</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;px&quot;</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mi">30</span><span class="p">]],</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">10</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="id50">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#id50" title="Link to this definition">¶</a></dt>
<dd><p>Optional name of the diagnostic. Used only for post-processing purposes.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="shape">
<span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#shape" title="Link to this definition">¶</a></dt>
<dd><p>The shape of the screen surface: <code class="docutils literal notranslate"><span class="pre">&quot;plane&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;sphere&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">&quot;cylinder&quot;</span></code>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="point">
<span class="sig-name descname"><span class="pre">point</span></span><a class="headerlink" href="#point" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of floats <code class="docutils literal notranslate"><span class="pre">[X]</span></code> in 1D,  <code class="docutils literal notranslate"><span class="pre">[X,Y]</span></code> in 2D,  <code class="docutils literal notranslate"><span class="pre">[X,Y,Z]</span></code> in 3D</p>
</dd>
</dl>
<p>The coordinates of a point that defines the screen surface:
a point of the <code class="docutils literal notranslate"><span class="pre">&quot;plane&quot;</span></code>, the center of the <code class="docutils literal notranslate"><span class="pre">&quot;sphere&quot;</span></code>,
or a point on the <code class="docutils literal notranslate"><span class="pre">&quot;cylinder&quot;</span></code> axis.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="vector">
<span class="sig-name descname"><span class="pre">vector</span></span><a class="headerlink" href="#vector" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of floats <code class="docutils literal notranslate"><span class="pre">[X]</span></code> in 1D,  <code class="docutils literal notranslate"><span class="pre">[X,Y]</span></code> in 2D,  <code class="docutils literal notranslate"><span class="pre">[X,Y,Z]</span></code> in 3D</p>
</dd>
</dl>
<p>The coordinates of a vector that defines the screen surface:
the normal to the <code class="docutils literal notranslate"><span class="pre">&quot;plane&quot;</span></code>, a radius of the <code class="docutils literal notranslate"><span class="pre">&quot;sphere&quot;</span></code>.
or the axis of the <code class="docutils literal notranslate"><span class="pre">&quot;cylinder&quot;</span></code> (in the latter case, the vector
norm defines the cylinder radius).</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="direction">
<span class="sig-name descname"><span class="pre">direction</span></span><a class="headerlink" href="#direction" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">&quot;both&quot;</span></code></p>
</dd>
</dl>
<p>Determines how particles are counted depending on which side of the screen they come from.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;both&quot;</span></code> to account for both sides.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;forward&quot;</span></code> for only the ones in the direction of the <code class="docutils literal notranslate"><span class="pre">vector</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;backward&quot;</span></code> for only the ones in the opposite direction.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;canceling&quot;</span></code> to count negatively the ones in the opposite direction.</p></li>
</ul>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id51">
<span class="sig-name descname"><span class="pre">deposited_quantity</span></span><a class="headerlink" href="#id51" title="Link to this definition">¶</a></dt>
<dd><p>Identical to the <code class="docutils literal notranslate"><span class="pre">deposited_quantity</span></code> of <a class="reference internal" href="#diagparticlebinning"><span class="std std-ref">particle binning diagnostics</span></a>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id52">
<span class="sig-name descname"><span class="pre">every</span></span><a class="headerlink" href="#id52" title="Link to this definition">¶</a></dt>
<dd><p>The number of time-steps between each output, <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id53">
<span class="sig-name descname"><span class="pre">flush_every</span></span><a class="headerlink" href="#id53" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>1</p>
</dd>
</dl>
<p>Number of timesteps <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">flush_every</span></code> coincides with <code class="docutils literal notranslate"><span class="pre">every</span></code>, the output
file is actually written (“flushed” from the buffer). Flushing
too often can <em>dramatically</em> slow down the simulation.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id54">
<span class="sig-name descname"><span class="pre">species</span></span><a class="headerlink" href="#id54" title="Link to this definition">¶</a></dt>
<dd><p>A list of one or several species’ <a class="reference internal" href="#id56" title="name"><code class="xref py py-data docutils literal notranslate"><span class="pre">name</span></code></a>.
All these species are combined into the same diagnostic.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id55">
<span class="sig-name descname"><span class="pre">axes</span></span><a class="headerlink" href="#id55" title="Link to this definition">¶</a></dt>
<dd><p>A list of “axes” that define the grid of the histogram.
It is identical to that of <a class="reference internal" href="#diagparticlebinning"><span class="std std-ref">particle binning diagnostics</span></a>, with the
addition of four types of axes:</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">shape=&quot;plane&quot;</span></code>, then <code class="docutils literal notranslate"><span class="pre">&quot;a&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;b&quot;</span></code> are the axes perpendicular to the <code class="docutils literal notranslate"><span class="pre">vector</span></code>.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">shape=&quot;sphere&quot;</span></code>, then <code class="docutils literal notranslate"><span class="pre">&quot;theta&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;phi&quot;</span></code> are the angles with respect to the <code class="docutils literal notranslate"><span class="pre">vector</span></code>.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">shape=&quot;cylinder&quot;</span></code>, then <code class="docutils literal notranslate"><span class="pre">&quot;a&quot;</span></code> is along the cylinder axis and <code class="docutils literal notranslate"><span class="pre">&quot;phi&quot;</span></code> is the angle around it.</p></li>
</ul>
</dd></dl>

<hr class="docutils" />
</section>
<section id="radiationspectrum-diagnostics">
<span id="diagradiationspectrum"></span><h2><em>RadiationSpectrum</em> diagnostics<a class="headerlink" href="#radiationspectrum-diagnostics" title="Link to this heading">¶</a></h2>
<p>A <em>radiation spectrum diagnostic</em> computes (at a given time) the instantaneous
power spectrum following from the incoherent emission of high-energy
photons by accelerated charge (see <a class="reference internal" href="../Understand/radiation_loss.html"><span class="doc">High-energy photon emission &amp; radiation reaction</span></a> for more details
on the emission process and its implementation in <strong class="program">Smilei</strong>).</p>
<p>It is similar to the <a class="reference internal" href="#diagparticlebinning"><span class="std std-ref">particle binning diagnostics</span></a>,
with an extra axis of binning: the emitted photon energy.
The other axes remain available to the user.</p>
<p>A radiation spectrum diagnostic is defined by a block <code class="docutils literal notranslate"><span class="pre">RadiationSpectrum()</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagRadiationSpectrum</span><span class="p">(</span>
    <span class="c1">#name = &quot;my radiation spectrum&quot;,</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">flush_every</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">time_average</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;electrons1&quot;</span><span class="p">,</span> <span class="s2">&quot;electrons2&quot;</span><span class="p">],</span>
    <span class="n">photon_energy_axis</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1000.</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;logscale&#39;</span><span class="p">],</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[]</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="id56">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#id56" title="Link to this definition">¶</a></dt>
<dd><p>Optional name of the diagnostic. Used only for post-processing purposes.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id57">
<span class="sig-name descname"><span class="pre">every</span></span><a class="headerlink" href="#id57" title="Link to this definition">¶</a></dt>
<dd><p>The number of time-steps between each output, <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id58">
<span class="sig-name descname"><span class="pre">flush_every</span></span><a class="headerlink" href="#id58" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>1</p>
</dd>
</dl>
<p>Number of timesteps <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">flush_every</span></code> coincides with <code class="docutils literal notranslate"><span class="pre">every</span></code>, the output
file is actually written (“flushed” from the buffer). Flushing
too often can <em>dramatically</em> slow down the simulation.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id59">
<span class="sig-name descname"><span class="pre">time_average</span></span><a class="headerlink" href="#id59" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>1</p>
</dd>
</dl>
<p>The number of time-steps during which the data is averaged before output.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id60">
<span class="sig-name descname"><span class="pre">species</span></span><a class="headerlink" href="#id60" title="Link to this definition">¶</a></dt>
<dd><p>A list of one or several species’ <a class="reference internal" href="#id56" title="name"><code class="xref py py-data docutils literal notranslate"><span class="pre">name</span></code></a> that emit the radiation.
All these species are combined into the same diagnostic.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="photon_energy_axis">
<span class="sig-name descname"><span class="pre">photon_energy_axis</span></span><a class="headerlink" href="#photon_energy_axis" title="Link to this definition">¶</a></dt>
<dd><p>The axis of photon energies (in units of <span class="math notranslate nohighlight">\(m_e c^2\)</span>).
The syntax is similar to that of
<a class="reference internal" href="#diagparticlebinning"><span class="std std-ref">particle binning diagnostics</span></a>.</p>
<p>Syntax: <code class="docutils literal notranslate"><span class="pre">[min,</span> <span class="pre">max,</span> <span class="pre">nsteps,</span> <span class="pre">&quot;logscale&quot;]</span></code></p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id61">
<span class="sig-name descname"><span class="pre">axes</span></span><a class="headerlink" href="#id61" title="Link to this definition">¶</a></dt>
<dd><p>An additional list of “axes” that define the grid.
There may be as many axes as wanted (there may be zero axes).
Their syntax is the same that for “axes” of a
<a class="reference internal" href="#diagparticlebinning"><span class="std std-ref">particle binning diagnostics</span></a>.</p>
</dd></dl>

<p><strong>Examples of radiation spectrum diagnostics</strong></p>
<ul>
<li><p>Time-integrated over the full duration of the simulation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagRadiationSpectrum</span><span class="p">(</span>
    <span class="n">every</span> <span class="o">=</span> <span class="n">Nt</span><span class="p">,</span>
    <span class="n">time_average</span> <span class="o">=</span> <span class="n">Nt</span><span class="p">,</span>
    <span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;electrons&quot;</span><span class="p">],</span>
    <span class="n">photon_energy_axis</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1000.</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;logscale&#39;</span><span class="p">],</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[]</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Angularly-resolved instantaneous radiation spectrum.
The diagnostic considers that all electrons emit radiation in
the direction of their velocity:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">arctan2</span><span class="p">,</span> <span class="n">pi</span>

<span class="k">def</span> <span class="nf">angle</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">arctan2</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">py</span><span class="p">,</span><span class="n">p</span><span class="o">.</span><span class="n">px</span><span class="p">)</span>

<span class="n">DiagRadiationSpectrum</span><span class="p">(</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">species</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;electrons&quot;</span><span class="p">],</span>
    <span class="n">photon_energy_axis</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1000.</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;logscale&#39;</span><span class="p">],</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="n">angle</span><span class="p">,</span><span class="o">-</span><span class="n">pi</span><span class="p">,</span><span class="n">pi</span><span class="p">,</span><span class="mi">90</span><span class="p">]</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<hr class="docutils" />
</section>
<section id="trackparticles-diagnostics">
<span id="diagtrackparticles"></span><h2><em>TrackParticles</em> diagnostics<a class="headerlink" href="#trackparticles-diagnostics" title="Link to this heading">¶</a></h2>
<p>A <em>particle tracking diagnostic</em> records the macro-particle positions and momenta at various timesteps.
Typically, this is used for plotting trajectories.</p>
<p>You can add a tracking diagnostic by including a block <code class="docutils literal notranslate"><span class="pre">DiagTrackParticles()</span></code> in the namelist,
for instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagTrackParticles</span><span class="p">(</span>
    <span class="n">species</span> <span class="o">=</span> <span class="s2">&quot;electron&quot;</span><span class="p">,</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<span class="c1">#    flush_every = 100,</span>
<span class="c1">#    filter = my_filter,</span>
<span class="c1">#    attributes = [&quot;x&quot;, &quot;px&quot;, &quot;py&quot;, &quot;Ex&quot;, &quot;Ey&quot;, &quot;Bz&quot;]</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="id62">
<span class="sig-name descname"><span class="pre">species</span></span><a class="headerlink" href="#id62" title="Link to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#id56" title="name"><code class="xref py py-data docutils literal notranslate"><span class="pre">name</span></code></a> of the species to be tracked.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id63">
<span class="sig-name descname"><span class="pre">every</span></span><a class="headerlink" href="#id63" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>0</p>
</dd>
</dl>
<p>Number of timesteps between each output of particles trajectories, <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.
If non-zero, the particles positions will be tracked and written in a file named <code class="docutils literal notranslate"><span class="pre">TrackParticlesDisordered_abc.h5</span></code>
(where <code class="docutils literal notranslate"><span class="pre">abc</span></code> is the species’ <a class="reference internal" href="#id56" title="name"><code class="xref py py-data docutils literal notranslate"><span class="pre">name</span></code></a>).</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id64">
<span class="sig-name descname"><span class="pre">flush_every</span></span><a class="headerlink" href="#id64" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>1</p>
</dd>
</dl>
<p>Number of timesteps <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">flush_every</span></code> coincides with <code class="docutils literal notranslate"><span class="pre">every</span></code>, the output
file for tracked particles is actually written (“flushed” from the buffer). Flushing
too often can <em>dramatically</em> slow down the simulation.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="filter">
<span class="sig-name descname"><span class="pre">filter</span></span><a class="headerlink" href="#filter" title="Link to this definition">¶</a></dt>
<dd><p>A python function giving some condition on which particles are tracked.
If none provided, all particles are tracked.
To use this option, the <a class="reference external" href="http://www.numpy.org/">numpy package</a> must
be available in your python installation.</p>
<p>The function must have one argument, that you may call, for instance, <code class="docutils literal notranslate"><span class="pre">particles</span></code>.
This object has several attributes <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">y</span></code>, <code class="docutils literal notranslate"><span class="pre">z</span></code>, <code class="docutils literal notranslate"><span class="pre">px</span></code>, <code class="docutils literal notranslate"><span class="pre">py</span></code>, <code class="docutils literal notranslate"><span class="pre">pz</span></code>, <code class="docutils literal notranslate"><span class="pre">charge</span></code>,
<code class="docutils literal notranslate"><span class="pre">weight</span></code> and <code class="docutils literal notranslate"><span class="pre">id</span></code> (additionally, it may also have the
attributes <code class="docutils literal notranslate"><span class="pre">Ex</span></code>, <code class="docutils literal notranslate"><span class="pre">Bx</span></code>, <code class="docutils literal notranslate"><span class="pre">Ey</span></code>, and so on, depending on <a class="reference internal" href="#keep_interpolated_fields" title="keep_interpolated_fields"><code class="xref py py-data docutils literal notranslate"><span class="pre">keep_interpolated_fields</span></code></a>).
Each of these attributes
are provided as <strong>numpy</strong> arrays where each cell corresponds to one particle.
The function must return a boolean <strong>numpy</strong> array of the same shape, containing <code class="docutils literal notranslate"><span class="pre">True</span></code>
for particles that should be tracked, and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>The following example selects all the particles that verify <span class="math notranslate nohighlight">\(-1&lt;p_x&lt;1\)</span>
or <span class="math notranslate nohighlight">\(p_z&gt;3\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_filter</span><span class="p">(</span><span class="n">particles</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">particles</span><span class="o">.</span><span class="n">px</span><span class="o">&gt;-</span><span class="mf">1.</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">particles</span><span class="o">.</span><span class="n">px</span><span class="o">&lt;</span><span class="mf">1.</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">particles</span><span class="o">.</span><span class="n">pz</span><span class="o">&gt;</span><span class="mf">3.</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>In the <code class="docutils literal notranslate"><span class="pre">filter</span></code> function only, the <code class="docutils literal notranslate"><span class="pre">px</span></code>, <code class="docutils literal notranslate"><span class="pre">py</span></code> and <code class="docutils literal notranslate"><span class="pre">pz</span></code> quantities
are not exactly the momenta.
They are actually the velocities multiplied by the lorentz factor, i.e.,
<span class="math notranslate nohighlight">\(\gamma v_x\)</span>, <span class="math notranslate nohighlight">\(\gamma v_y\)</span> and <span class="math notranslate nohighlight">\(\gamma v_z\)</span>.
This is <em>not</em> true for the output of the diagnostic.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">id</span></code> attribute contains the <a class="reference internal" href="ids.html"><span class="doc">particles identification number</span></a>.
This number is set to 0 at the beginning of the simulation. <strong>Only after particles have
passed the filter</strong>, they acquire a positive <code class="docutils literal notranslate"><span class="pre">id</span></code>.</p></li>
<li><p>For advanced filtration, Smilei provides the quantity <code class="docutils literal notranslate"><span class="pre">Main.iteration</span></code>,
accessible within the <code class="docutils literal notranslate"><span class="pre">filter</span></code> function. Its value is always equal to the current
iteration number of the PIC loop. The current time of the simulation is thus
<code class="docutils literal notranslate"><span class="pre">Main.iteration</span> <span class="pre">*</span> <span class="pre">Main.timestep</span></code>.</p></li>
</ul>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="attributes">
<span class="sig-name descname"><span class="pre">attributes</span></span><a class="headerlink" href="#attributes" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">[&quot;x&quot;,&quot;y&quot;,&quot;z&quot;,&quot;px&quot;,&quot;py&quot;,&quot;pz&quot;,&quot;w&quot;]</span></code></p>
</dd>
</dl>
<p>A list of strings indicating the particle attributes to be written in the output.
The attributes may be the particles’ spatial coordinates (<code class="docutils literal notranslate"><span class="pre">&quot;x&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;y&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;z&quot;</span></code>),
their momenta (<code class="docutils literal notranslate"><span class="pre">&quot;px&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;py&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;pz&quot;</span></code>), their electrical charge (<code class="docutils literal notranslate"><span class="pre">&quot;q&quot;</span></code>),
their statistical weight (<code class="docutils literal notranslate"><span class="pre">&quot;w&quot;</span></code>), their quantum parameter
(<code class="docutils literal notranslate"><span class="pre">&quot;chi&quot;</span></code>, only for species with radiation losses) or the fields interpolated
at their  positions (<code class="docutils literal notranslate"><span class="pre">&quot;Ex&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Ey&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Ez&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Bx&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;By&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Bz&quot;</span></code>).</p>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Here, interpolated fields are normally computed after the Maxwell solver.
They may thus differ by half a timestep from those computed at the middle of the
timestep to push particles. When exact values are needed, use the option
<a class="reference internal" href="#keep_interpolated_fields" title="keep_interpolated_fields"><code class="xref py py-data docutils literal notranslate"><span class="pre">keep_interpolated_fields</span></code></a>.</p>
</div>
<hr class="docutils" />
</section>
<section class="experimental" id="newparticles-diagnostics">
<span id="diagnewparticles"></span><h2><em>NewParticles</em> diagnostics<a class="headerlink" href="#newparticles-diagnostics" title="Link to this heading">¶</a></h2>
<p>A <em>new-particle diagnostic</em> records the macro-particle information only at the time when
they are generated by <a class="reference internal" href="../Understand/ionization.html"><span class="doc">Ionization</span></a> or other <a class="reference internal" href="../Understand/physics_modules.html"><span class="doc">Physics modules</span></a>.</p>
<p>You can add a new-particle diagnostic by including a block <code class="docutils literal notranslate"><span class="pre">DiagNewParticles()</span></code> in the namelist,
for instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagNewParticles</span><span class="p">(</span>
    <span class="n">species</span> <span class="o">=</span> <span class="s2">&quot;electron&quot;</span><span class="p">,</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<span class="c1">#    attributes = [&quot;x&quot;, &quot;px&quot;, &quot;py&quot;, &quot;Ex&quot;, &quot;Ey&quot;, &quot;Bz&quot;]</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>All the arguments are identical to those of TrackParticles.</strong>
However, there are particular considerations:</p>
<ul class="simple">
<li><p>Although the creation of particles is recorded at every timestep, the argument <code class="docutils literal notranslate"><span class="pre">every</span></code>
only indicates how often the data is written to the file. It is recommended to avoid
small values of <code class="docutils literal notranslate"><span class="pre">every</span></code> for better performance.</p></li>
<li><p>In the case of <a class="reference internal" href="../Understand/ionization.html"><span class="doc">Ionization</span></a>, if the chosen <code class="docutils literal notranslate"><span class="pre">species</span></code> is that of the ionized electrons,
then the attribute “<code class="docutils literal notranslate"><span class="pre">q</span></code>” is not the charge of the electron, but the charge of the
ion, <em>before ionization occurred</em>.</p></li>
</ul>
<hr class="docutils" />
</section>
<section id="performances-diagnostics">
<span id="diagperformances"></span><h2><em>Performances</em> diagnostics<a class="headerlink" href="#performances-diagnostics" title="Link to this heading">¶</a></h2>
<p>The <em>performances</em> diagnostic records information on the computational load and timers
for each MPI process  or for each patch in the simulation.</p>
<p>Only one block <code class="docutils literal notranslate"><span class="pre">DiagPerformances()</span></code> may be added in the namelist, for instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DiagPerformances</span><span class="p">(</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
<span class="c1">#    flush_every = 100,</span>
<span class="c1">#    patch_information = True,</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py data">
<dt class="sig sig-object py" id="id66">
<span class="sig-name descname"><span class="pre">every</span></span><a class="headerlink" href="#id66" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>0</p>
</dd>
</dl>
<p>Number of timesteps between each output, <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="id67">
<span class="sig-name descname"><span class="pre">flush_every</span></span><a class="headerlink" href="#id67" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p>1</p>
</dd>
</dl>
<p>Number of timesteps <strong>or</strong> a <a class="reference internal" href="#timeselections"><span class="std std-ref">time selection</span></a>.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">flush_every</span></code> coincides with <code class="docutils literal notranslate"><span class="pre">every</span></code>, the output file is actually written
(“flushed” from the buffer). Flushing too often might <em>dramatically</em> slow down the simulation.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="patch_information">
<span class="sig-name descname"><span class="pre">patch_information</span></span><a class="headerlink" href="#patch_information" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, some information is calculated at the patch level (see <a class="reference internal" href="post-processing.html#Performances" title="Performances"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Performances()</span></code></a>)
but this may impact the code performances.</p>
</dd></dl>

<hr class="docutils" />
</section>
<section id="time-selections">
<span id="timeselections"></span><h2>Time selections<a class="headerlink" href="#time-selections" title="Link to this heading">¶</a></h2>
<p>Several components (mainly diagnostics) may require a selection of timesteps to
be chosen by the user. When one of these timesteps is reached, the diagnostics will
output data. A time selection is given through the parameter <code class="docutils literal notranslate"><span class="pre">every</span></code> and is a list
of several numbers.</p>
<p>You may chose between five different syntaxes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">every</span> <span class="o">=</span> <span class="p">[</span>               <span class="n">period</span>                    <span class="p">]</span> <span class="c1"># Syntax 1</span>
<span class="n">every</span> <span class="o">=</span> <span class="p">[</span>       <span class="n">start</span><span class="p">,</span>  <span class="n">period</span>                    <span class="p">]</span> <span class="c1"># Syntax 2</span>
<span class="n">every</span> <span class="o">=</span> <span class="p">[</span> <span class="n">start</span><span class="p">,</span>  <span class="n">end</span><span class="p">,</span>  <span class="n">period</span>                    <span class="p">]</span> <span class="c1"># Syntax 3</span>
<span class="n">every</span> <span class="o">=</span> <span class="p">[</span> <span class="n">start</span><span class="p">,</span>  <span class="n">end</span><span class="p">,</span>  <span class="n">period</span><span class="p">,</span>  <span class="n">repeat</span>           <span class="p">]</span> <span class="c1"># Syntax 4</span>
<span class="n">every</span> <span class="o">=</span> <span class="p">[</span> <span class="n">start</span><span class="p">,</span>  <span class="n">end</span><span class="p">,</span>  <span class="n">period</span><span class="p">,</span>  <span class="n">repeat</span><span class="p">,</span>  <span class="n">spacing</span> <span class="p">]</span> <span class="c1"># Syntax 5</span>
</pre></div>
</div>
<p>where</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">start</span></code> is the first timestep of the selection (defaults to 0);</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">end</span></code> is the last timestep of the selection (defaults to ∞);</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">period</span></code> is the separation between outputs (defaults to 1);</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">repeat</span></code> indicates how many outputs to do at each period (defaults to 1);</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spacing</span></code> is the separation between each repeat (defaults to 1).</p></li>
</ul>
<p>For more clarity, this graph illustrates the five syntaxes for time selections:</p>
<a class="reference internal image-reference" href="../_images/TimeSelections.png"><img alt="../_images/TimeSelections.png" class="align-center" src="../_images/TimeSelections.png" style="width: 33em;" /></a>
<div class="admonition-tips admonition">
<p class="admonition-title">Tips</p>
<ul class="simple">
<li><p>The syntax <code class="docutils literal notranslate"><span class="pre">every</span> <span class="pre">=</span> <span class="pre">period</span></code> is also accepted.</p></li>
<li><p>Any value set to <code class="docutils literal notranslate"><span class="pre">0</span></code> will be replaced by the default value.</p></li>
<li><p>Special case: <code class="docutils literal notranslate"><span class="pre">every=0</span></code> means no output.</p></li>
<li><p>The numbers may be non-integers (apart from <code class="docutils literal notranslate"><span class="pre">repeat</span></code>). The closest timesteps are chosen.</p></li>
</ul>
</div>
</section>
<hr class="docutils" />
<section id="profiles">
<h2>Profiles<a class="headerlink" href="#profiles" title="Link to this heading">¶</a></h2>
<p>Some of the quantities described in the previous sections can be profiles that depend on
space and/or time. See the <a class="reference internal" href="profiles.html"><span class="doc">documentation on profiles</span></a> for detailed
instructions.</p>
<hr class="docutils" />
</section>
<section id="checkpoints">
<span id="id68"></span><h2>Checkpoints<a class="headerlink" href="#checkpoints" title="Link to this heading">¶</a></h2>
<p>The simulation state can be saved (<em>dumped</em>) at given times (<em>checkpoints</em>)
in order to be later <em>restarted</em> at that point.</p>
<p>A few things are important to know when you need dumps and restarts.</p>
<ul class="simple">
<li><p>Do not restart the simulation in the same directory as the previous one. Files will be
overwritten, and errors may occur. Create a new directory for your restarted simulation.</p></li>
<li><p>Manage your disk space: each MPI process dumps one file, and the total can be significant.</p></li>
<li><p>The restarted runs must have the same namelist as the initial simulation, except the
<a class="reference internal" href="#checkpoints"><span class="std std-ref">Checkpoints</span></a> block, which can be modified.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Checkpoints</span><span class="p">(</span>
    <span class="c1"># restart_dir = &quot;dump1&quot;,</span>
    <span class="n">dump_step</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span>
    <span class="n">dump_minutes</span> <span class="o">=</span> <span class="mf">240.</span><span class="p">,</span>
    <span class="n">exit_after_dump</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">keep_n_dumps</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>Parameters to save the state of the current simulation</strong></p>
<blockquote>
<div><dl class="py data">
<dt class="sig sig-object py" id="dump_step">
<span class="sig-name descname"><span class="pre">dump_step</span></span><a class="headerlink" href="#dump_step" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p>The number of timesteps between each dump.
If <code class="docutils literal notranslate"><span class="pre">0</span></code>, no dump is done.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="dump_minutes">
<span class="sig-name descname"><span class="pre">dump_minutes</span></span><a class="headerlink" href="#dump_minutes" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">0.</span></code></p>
</dd>
</dl>
<p>The number of minutes between each dump.
If <code class="docutils literal notranslate"><span class="pre">0.</span></code>, no dump is done.</p>
<p>May be used in combination with <a class="reference internal" href="#dump_step" title="dump_step"><code class="xref py py-data docutils literal notranslate"><span class="pre">dump_step</span></code></a>.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="exit_after_dump">
<span class="sig-name descname"><span class="pre">exit_after_dump</span></span><a class="headerlink" href="#exit_after_dump" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</dd>
</dl>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the code stops after the first dump. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, the simulation continues.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="keep_n_dumps">
<span class="sig-name descname"><span class="pre">keep_n_dumps</span></span><a class="headerlink" href="#keep_n_dumps" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p>
</dd>
</dl>
<p>This tells <strong class="program">Smilei</strong> to keep, in the current run,  only the last <code class="docutils literal notranslate"><span class="pre">n</span></code> dumps.
Older dumps will be overwritten.</p>
<p>The default value, <code class="docutils literal notranslate"><span class="pre">2</span></code>, saves one extra dump in case of a crash during the next dump.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="file_grouping">
<span class="sig-name descname"><span class="pre">file_grouping</span></span><a class="headerlink" href="#file_grouping" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">0</span></code> (no grouping)</p>
</dd>
</dl>
<p>The maximum number of checkpoint files that can be stored in one directory.
Subdirectories are created to accomodate for all files.
This is useful on filesystem with a limited number of files per directory.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="dump_deflate">
<span class="sig-name descname"><span class="pre">dump_deflate</span></span><a class="headerlink" href="#dump_deflate" title="Link to this definition">¶</a></dt>
<dd><p><span class="red">to do</span></p>
</dd></dl>

</div></blockquote>
<p><strong>Parameters to restart from a previous simulation</strong></p>
<blockquote>
<div><dl class="py data">
<dt class="sig sig-object py" id="restart_dir">
<span class="sig-name descname"><span class="pre">restart_dir</span></span><a class="headerlink" href="#restart_dir" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
<p>The directory of a previous run from which <strong class="program">Smilei</strong> should restart.
For the first run, do not specify this parameter.</p>
<p><strong>This path must either absolute or be relative to the current directory.</strong></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In many situations, the restarted runs will have the exact same namelist as the initial
simulation, except this <code class="docutils literal notranslate"><span class="pre">restart_dir</span></code> parameter, which points to the previous simulation
folder.
You can use the same namelist file, and simply add an extra argument when you launch the
restart:</p>
<p><code class="docutils literal notranslate"><span class="pre">mpirun</span> <span class="pre">...</span> <span class="pre">./smilei</span> <span class="pre">mynamelist.py</span> <span class="pre">&quot;Checkpoints.restart_dir='/path/to/previous/run'&quot;</span></code></p>
</div>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="restart_number">
<span class="sig-name descname"><span class="pre">restart_number</span></span><a class="headerlink" href="#restart_number" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Default<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
<p>The number of the dump (in the previous run) that should be used for the restart.
For the first run, do not specify this parameter.</p>
<p>In a previous run, the simulation state may have been dumped several times.
These dumps are numbered 0, 1, 2, etc. until the number <a class="reference internal" href="#keep_n_dumps" title="keep_n_dumps"><code class="xref py py-data docutils literal notranslate"><span class="pre">keep_n_dumps</span></code></a>.
In case multiple dumps are kept, the newest one will overwrite the oldest one.
To restart the simulation from the most advanced point, specify the dump number
corresponding to the newest that was created.</p>
</dd></dl>

</div></blockquote>
</section>
<hr class="docutils" />
<section id="variables-defined-by-smilei">
<h2>Variables defined by Smilei<a class="headerlink" href="#variables-defined-by-smilei" title="Link to this heading">¶</a></h2>
<p><strong class="program">Smilei</strong> passes the following variables to the python interpreter for use in the
namelist. They should not be re-defined by the user!</p>
<dl class="py data">
<dt class="sig sig-object py" id="smilei_mpi_rank">
<span class="sig-name descname"><span class="pre">smilei_mpi_rank</span></span><a class="headerlink" href="#smilei_mpi_rank" title="Link to this definition">¶</a></dt>
<dd><p>The MPI rank of the current process.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="smilei_mpi_size">
<span class="sig-name descname"><span class="pre">smilei_mpi_size</span></span><a class="headerlink" href="#smilei_mpi_size" title="Link to this definition">¶</a></dt>
<dd><p>The total number of MPI processes.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="smilei_omp_threads">
<span class="sig-name descname"><span class="pre">smilei_omp_threads</span></span><a class="headerlink" href="#smilei_omp_threads" title="Link to this definition">¶</a></dt>
<dd><p>The number of OpenMP threads per MPI.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="smilei_total_cores">
<span class="sig-name descname"><span class="pre">smilei_total_cores</span></span><a class="headerlink" href="#smilei_total_cores" title="Link to this definition">¶</a></dt>
<dd><p>The total number of cores.</p>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These variables can be access during <code class="docutils literal notranslate"><span class="pre">happi</span></code> post-processing, e.g.
<code class="docutils literal notranslate"><span class="pre">S.namelist.smilei_mpi_size</span></code>.</p>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      <div>
        <input type="button" id="themebutton"  value="" onclick="switchTheme('')" />
      </div>
      <div>
      <a href="site.html">Site index</a>
      </div>
      <div>
        Last updated on May 26, 2025
      </div>
      
      <div>
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      </div>
      
    </div>
    
    <script type="text/javascript">
        
        var nav = document.getElementById("nav");
        var nav_list = document.getElementById("nav_list");
        var nav_button = document.getElementById("nav_button");
        var smallScreenMenu = document.getElementById("smallScreenMenu");
        var smallScreenMenuButton = document.getElementById("smallScreenMenuButton");
        var searchicon = document.getElementById("searchicon");
        var searchbox  = document.getElementById("searchbox");
        var searchinput= document.getElementById("searchinput");
        var menus = document.getElementsByClassName("menu");
        for( var i=0; i<menus.length; i++ )
            menus[i].active = false;
        
        // Manage theme
        var theme="light";
        function switchTheme(type) {
            if( type == "dark" || ( ! type && theme == "light" ) ) {
                theme = "dark";
                document.documentElement.setAttribute('theme', 'dark');
                window.name = "dark_theme"
                localStorage.setItem("_theme","dark")
            } else {
                theme = "light";
                document.documentElement.setAttribute('theme', 'light');
                window.name = "light_theme"
                localStorage.setItem("_theme","light")
            }
        }
        if( window.name && window.name == "light_theme" ) {
            switchTheme("light");
        } else if ( window.name && window.name == "dark_theme" ) {
            switchTheme("dark");
        } else if( stored_theme = localStorage.getItem("_theme") ) {
            switchTheme(stored_theme);
        } else if( window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches) {
            switchTheme("dark");
        }
        
        var ul = nav_list.getElementsByTagName("ul")[0], li;
        var keep_nav = false;
        if( ul ) {
            li = ul.firstElementChild;
            if( li ) {
                if( li.getElementsByTagName("ul").length > 0 ) keep_nav = true;
            }
        }
        if( keep_nav ) {
            li.removeChild( li.firstElementChild );
        } else {
            document.getElementById("nav_positioner").removeChild( document.getElementById("nav") );
        }
        
        function navOff() {
            nav_list.style.display = "none";
            nav_button.className = "";
            nav.style.overflowY = "visible";
        }
        
        function toggleNav() {
            for( var i=0; i<menus.length; i++ )
                menuOff( menus[i] );
            if( nav_list.style.display != "inline-block" ) {
                nav_list.style.display = "inline-block";
                nav_button.className = "pushed";
                nav.style.overflowY = "auto";
            } else {
                navOff();
            }
        }
        
        function toggleSmallScreenMenu(e) {
            if( smallScreenMenu.className != "on" ) {
                smallScreenMenu.className = "on";
                smallScreenMenuButton.className = "pushed";
                document.documentElement.style.overflow = "hidden";
            } else {
                smallScreenMenu.className = "off";
                smallScreenMenuButton.className = "";
                document.documentElement.style.overflow = "";
            }
        }
        
        if (smallScreenMenuAfterTOC = document.getElementById("smallScreenMenuAfterTOC")) {
            var smallScreenMenuTOC = smallScreenMenuAfterTOC.previousElementSibling
                .getElementsByTagName("li")[0].getElementsByTagName("ul")[0].getElementsByTagName("li");
            for (var i = 0; i < smallScreenMenuTOC.length; i++) {
                if (smallScreenMenuTOC[i].tagName = "a") {
                    smallScreenMenuTOC[i].addEventListener("click", function(event){ toggleSmallScreenMenu(event); } );
                }
            }
        }
        
        function prepareMenu(menu_id) {
            var menu = document.getElementById(menu_id);
            menu.timer1 = setTimeout(function(a){ return function(){thisMenuOnly(a)};}(menu_id), 100);
            menu.addEventListener("mouseleave", function(a){ return function(){clearTimeout(a.timer1)};}(menu) );
        }
        
        function leaveMenu(menu_id, source) {
            var menu = document.getElementById(menu_id);
            menu.timer2 = setTimeout(function(a){ return function(){menuOff(a)};}(menu), 1000);
            source.addEventListener("mouseenter", function(a){ return function(){clearTimeout(a.timer2)};}(menu) );
        }
        
        function menuOn( menu ) {
            var divs = menu.getElementsByTagName("div");
            if(nav_list) navOff();
            divs[1].className = "on";
            divs[0].className = "menuButton pushed";
            menu.active = true;
        }
        function menuOff( menu ) {
            var divs = menu.getElementsByTagName("div");
            divs[1].className = "off";
            divs[0].className = "menuButton";
            menu.active = false;
        }
        
        function thisMenuOnly(menu_id) {
            var menu = document.getElementById(menu_id);
            for( var i=0; i<menus.length; i++ )
                if( i!=menu_id )
                    menuOff( menus[i] );
            menuOn( menu );
        }
        
        function toggleMenu(menu_id) {
            var menu = document.getElementById(menu_id);
            if( menu.active ) {
                menuOff( menu );
            } else {
                for( var i=0; i<menus.length; i++ )
                    if( i!=menu_id )
                        menuOff( menus[i] );
                menuOn( menu );
            }
        }
        
        function openSearch() {
            for( var i=0; i<menus.length; i++ ) {
                menuOff( menus[i] );
                menus[i].style.zIndex = "-1";
            }
            searchicon.style.display = "none";
            closesearchicon.style.display = "block";
            searchbox.style.display = "block";
            searchinput.focus();
        }
        
        function closeSearch() {
            searchicon.style.display = "block";
            closesearchicon.style.display = "none";
            searchbox .style.display = "none";
            for( var i=0; i<menus.length; i++ )
                menus[i].style.zIndex = "0";
        }
        
        
        var documentDiv = document.getElementsByClassName("document")[0];
        documentDiv.addEventListener('click', function (event) {
            if(nav_list) navOff();
            for( var i=0; i<menus.length; i++ )
                menuOff( menus[i] );
        });
    </script>
  </body>
</html>